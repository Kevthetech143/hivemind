-- Add Stack Overflow solutions batch 12: Laravel, Redux, GraphQL, Sass
-- Source: Stack Overflow accepted answers with community verification

-- Laravel: Class not found
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Laravel class not found error',
    'laravel',
    'VERY_HIGH',
    '[
        {"solution": "Run composer dump-autoload to regenerate autoload files", "percentage": 95, "command": "composer dump-autoload", "note": "Rebuilds class map"},
        {"solution": "Check namespace matches folder structure: App\\Models\\Post in app/Models/Post.php", "percentage": 90, "note": "PSR-4 autoloading"},
        {"solution": "Verify filename matches class name: Post class must be in Post.php file", "percentage": 85, "note": "Case-sensitive matching"}
    ]'::jsonb,
    'Laravel project, Composer installed, PSR-4 autoloading',
    'Classes load without errors, composer dump-autoload completes',
    'Laravel uses PSR-4 autoloading. Namespace must match directory structure. Filenames are case-sensitive. Laravel 8+ uses App\\Models namespace.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/28350232/'
);

-- Laravel: Class not found on production
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Laravel class not found only on production server',
    'laravel',
    'MEDIUM',
    '[
        {"solution": "Clear OPcache: php artisan cache:clear or restart PHP-FPM service", "percentage": 90, "note": "OPcache caches old class map"},
        {"solution": "Run composer dump-autoload --optimize on production", "percentage": 85, "command": "composer dump-autoload --optimize", "note": "Optimized autoloader for production"},
        {"solution": "Clear all caches: php artisan optimize:clear", "percentage": 80, "command": "php artisan optimize:clear"}
    ]'::jsonb,
    'Laravel production deployment, OPcache enabled, New classes deployed',
    'Classes load on production, Application runs without class not found errors',
    'OPcache caches PHP files including autoload maps. Clear cache after deploying new classes. Use optimize:clear for all caches.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/68268983/'
);

-- Laravel: Namespace capitalization
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Laravel class not found - namespace case mismatch',
    'laravel',
    'HIGH',
    '[
        {"solution": "Match folder and namespace capitalization: App\\Models not app\\models", "percentage": 95, "note": "PSR-4 requires exact case match"},
        {"solution": "Rename folder to match namespace: mv app/models app/Models", "percentage": 90, "note": "Directory structure must match"},
        {"solution": "Update namespace in all affected files: namespace App\\Models;", "percentage": 85, "note": "Consistent capitalization"}
    ]'::jsonb,
    'Laravel with custom namespaces, File system case sensitivity',
    'Namespaces resolve correctly, composer dump-autoload succeeds',
    'PSR-4 autoloading is case-sensitive. App\\Models requires Models folder not models. Linux servers are case-sensitive.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/57574438/'
);

-- Redux: State not updating
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Redux state not updating component',
    'redux',
    'VERY_HIGH',
    '[
        {"solution": "Return new state object: return {...state, key: newValue} not state.key = newValue", "percentage": 95, "note": "Immutable state updates"},
        {"solution": "Connect component with mapStateToProps: export default connect(mapStateToProps)(Component)", "percentage": 90, "note": "Component must subscribe to store"},
        {"solution": "Ensure reducer is combined: combineReducers({ reducer1, reducer2 })", "percentage": 85, "note": "Reducer must be registered"}
    ]'::jsonb,
    'React with Redux, reducers and actions configured',
    'Component re-renders on state changes, UI reflects store updates',
    'Mutating state directly (state.key = value) breaks Redux. Must return new object. Component needs connect() or useSelector().',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/35917210/'
);

-- Redux: Component not re-rendering
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'React component not updating when Redux store changes',
    'redux',
    'HIGH',
    '[
        {"solution": "Use mapStateToProps to map store to props: const mapStateToProps = state => ({ data: state.data })", "percentage": 95, "note": "Connect component to store"},
        {"solution": "Avoid mutation in reducers: Use spread operator {...state, updated: value}", "percentage": 90, "note": "Immutability required"},
        {"solution": "Use React-Redux hooks: const data = useSelector(state => state.data)", "percentage": 85, "note": "Modern Redux approach"}
    ]'::jsonb,
    'React-Redux application, Connected components',
    'Components re-render when relevant state changes, UI stays in sync',
    'Component must be connected to Redux store with connect() or useSelector(). Mutating state prevents re-renders.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/49064590/'
);

-- Redux: Action not triggering update
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Redux action dispatched but state not updating',
    'redux',
    'MEDIUM',
    '[
        {"solution": "Check action.type matches reducer case: case ADD_ITEM: not case add_item", "percentage": 90, "note": "Case-sensitive matching"},
        {"solution": "Return state in default case: default: return state", "percentage": 85, "note": "Prevent undefined state"},
        {"solution": "Verify reducer returns new object: return {...state, ...} not state", "percentage": 95, "note": "Immutable updates"}
    ]'::jsonb,
    'Redux actions and reducers, Dispatch configured',
    'Actions update state, Store reflects dispatched changes',
    'Action type must match reducer case exactly. Always return state in default case. Must return new object for updates.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/41475441/'
);

-- GraphQL: Required argument not provided
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'GraphQL error: argument is required but not provided',
    'graphql',
    'VERY_HIGH',
    '[
        {"solution": "Provide required argument in query: product(id: \"123\") { name }", "percentage": 95, "note": "Required arguments shown with !"},
        {"solution": "Use variables for arguments: query($id: String!) { product(id: $id) }", "percentage": 90, "note": "Pass variables separately"},
        {"solution": "Check schema for required fields: Type ending with ! is required", "percentage": 85, "note": "Schema documentation"}
    ]'::jsonb,
    'GraphQL API, Schema with required arguments',
    'Queries execute successfully, All required arguments provided',
    'Required arguments in schema have ! (non-null). Must provide value in query. Cannot be null or omitted.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/69465830/'
);

-- GraphQL: Query validation failed - scalar field
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'GraphQL query failed to validate - scalar type selection',
    'graphql',
    'HIGH',
    '[
        {"solution": "Remove field selection from scalar: getStatus not getStatus { field }", "percentage": 95, "note": "Scalars have no subfields"},
        {"solution": "Check return type in schema: String/Int/Boolean are scalars", "percentage": 90, "note": "Scalars vs object types"},
        {"solution": "Only select fields on object types: user { name email } valid for object", "percentage": 85, "note": "Field selection syntax"}
    ]'::jsonb,
    'GraphQL API, Queries with field selections',
    'Queries validate and execute, Proper field selection syntax',
    'Scalar types (String, Int, Boolean) cannot have field selections. Only object types can. Check schema return type.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/69575598/'
);

-- GraphQL: Passing query parameters
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'GraphQL error passing parameters to query',
    'graphql',
    'MEDIUM',
    '[
        {"solution": "Use variables object: useQuery(QUERY, { variables: { id: 123 } })", "percentage": 95, "note": "Apollo Client syntax"},
        {"solution": "Define variables in query: query($id: Int!) { user(id: $id) }", "percentage": 90, "note": "Variable declaration"},
        {"solution": "Pass variables in URL: /graphql?query={user(id:1){name}}", "percentage": 75, "note": "GET request format"}
    ]'::jsonb,
    'GraphQL client (Apollo/Relay), Parameterized queries',
    'Parameters passed correctly, Queries return expected data',
    'Variables defined with $ in query. Passed separately in variables object. Type must match schema definition.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/59274527/'
);

-- Sass: Compilation error with @use
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Sass Live Compiler @use causes compilation error',
    'sass',
    'HIGH',
    '[
        {"solution": "Use sass CLI instead: npm install -g sass && sass --watch style.scss:style.css", "percentage": 90, "command": "sass --watch style.scss:style.css", "note": "Official compiler supports @use"},
        {"solution": "Switch to updated VS Code extension: Live Sass Compiler (Glenn Marks fork)", "percentage": 85, "note": "Supports modern Sass syntax"},
        {"solution": "Replace @use with @import for old compiler: @import ''file'';", "percentage": 70, "note": "Compatibility workaround"}
    ]'::jsonb,
    'Sass files with @use directive, VS Code with Live Sass Compiler',
    'Sass compiles successfully, @use directives work correctly',
    'Old Live Sass Compiler does not support @use (Dart Sass feature). Use official sass CLI or updated extension.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/66193156/'
);

-- Sass: File not found import error
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Sass compilation error: file to import not found',
    'sass',
    'VERY_HIGH',
    '[
        {"solution": "Check file path is correct: @import ''./folder/file'' or @import ''folder/file''", "percentage": 95, "note": "Verify path and typos"},
        {"solution": "Add .scss extension if needed: @import ''file.scss''", "percentage": 85, "note": "Extension may be required"},
        {"solution": "Verify file exists in location: Check file system for imported file", "percentage": 90, "note": "File must exist"}
    ]'::jsonb,
    'Sass project with imports, File system access',
    'All imports resolve, Sass compiles without errors',
    'Import paths are relative to importing file. Check spelling and case. File must exist at specified path.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/46625610/'
);

-- Sass: Node-sass resolve URL error
INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Sass failed to compile: cannot resolve relative URL',
    'sass',
    'MEDIUM',
    '[
        {"solution": "Add resolve-url-loader: npm install resolve-url-loader --save-dev", "percentage": 90, "note": "Webpack loader for URL resolution"},
        {"solution": "Configure in webpack.config.js: Add resolve-url-loader before sass-loader", "percentage": 85, "note": "Loader order matters"},
        {"solution": "Use absolute paths in Sass: url(''/assets/fonts/file.woff'')", "percentage": 75, "note": "Bypass relative resolution"}
    ]'::jsonb,
    'Webpack with sass-loader, Sass files with url() for fonts/images',
    'Sass compiles successfully, URLs resolve correctly',
    'Sass cannot resolve relative URLs to assets. resolve-url-loader fixes this. Must come before sass-loader in config.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/66967582/'
);

