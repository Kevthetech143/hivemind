-- Add Astro error reference solutions batch 1

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'Astro: GetStaticPathsRequired',
    'astro-build',
    'HIGH',
    '[
        {"solution": "Add getStaticPaths() function to your dynamic route file that returns an array of path objects with params property", "percentage": 95, "note": "Required for all dynamic routes at build time"},
        {"solution": "Ensure each object in the returned array has a params property matching your route segments", "percentage": 90, "command": "export async function getStaticPaths() { return [{params: {id: ''1''}}]; }"},
        {"solution": "Verify route filename uses bracket notation like [param].astro for dynamic segments", "percentage": 85, "note": "Routes without this function will fail during build"}
    ]'::jsonb,
    'Dynamic route file created with bracket notation, Build command executed',
    'Build completes successfully, Dynamic pages generated in dist folder, No 404 errors for generated routes',
    'Forgetting getStaticPaths on dynamic routes. Returning incorrect params structure. Using getStaticPaths in static routes unnecessarily.',
    0.92,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: InvalidDynamicRoute',
    'astro-routing',
    'MEDIUM',
    '[
        {"solution": "Use proper bracket syntax for route parameters: [param].astro not {param}.astro", "percentage": 95, "note": "Brackets are required for dynamic segments"},
        {"solution": "Ensure parameter names contain only alphanumeric characters and underscores", "percentage": 90, "command": "Correct: /pages/[slug].astro, Incorrect: /pages/{slug}.astro"},
        {"solution": "For spread parameters use triple dots: [...slug].astro for catch-all routes", "percentage": 85, "note": "Spread parameters must be last in the path"}
    ]'::jsonb,
    'Route file with bracket notation, Valid parameter names',
    'Route file parses without syntax errors, Astro dev server starts successfully, Routes appear in browser correctly',
    'Using curly braces instead of square brackets. Invalid characters in parameter names. Incorrect spread operator placement.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: PrerenderRouteConflict',
    'astro-build',
    'MEDIUM',
    '[
        {"solution": "Rename one of the conflicting routes to produce unique output paths", "percentage": 95, "note": "Conflicts occur when different routes generate identical filenames"},
        {"solution": "Modify getStaticPaths() to ensure each route generates a unique slug or parameter combination", "percentage": 90, "command": "Use unique identifiers in params that produce different file paths"},
        {"solution": "Use prerender=false on one route to exclude it from static generation", "percentage": 80, "note": "Marks route as dynamic instead of static"}
    ]'::jsonb,
    'Multiple routes configured, Build with prerender enabled',
    'Build completes without path collision warnings, Each route generates unique HTML file, No overwritten outputs',
    'Having multiple routes that generate identical paths. Not checking build output for name collisions. Using identical slugs in different collections.',
    0.85,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: NoMatchingStaticPathFound',
    'astro-routing',
    'HIGH',
    '[
        {"solution": "Verify the requested path exists in your getStaticPaths() return array by checking returned params", "percentage": 95, "note": "Request path must exactly match a generated path"},
        {"solution": "Add missing paths to getStaticPaths() return value if they are valid pages", "percentage": 92, "command": "Inspect browser request and add corresponding entry to getStaticPaths array"},
        {"solution": "Check for typos in route parameters and slugs between getStaticPaths() output and actual requests", "percentage": 85, "note": "Case sensitivity matters in path matching"}
    ]'::jsonb,
    'getStaticPaths() implemented, Dynamic route file exists',
    'Requested page loads without 404 error, Page matches path in getStaticPaths output, Build shows no unhandled routes',
    'Forgetting to include all needed paths in getStaticPaths(). Typos in path parameters. Case sensitivity issues in slugs.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: InvalidContentEntryFrontmatterError',
    'astro-content-collections',
    'HIGH',
    '[
        {"solution": "Compare your frontmatter fields against the schema defined in src/content/config.ts to match required types", "percentage": 96, "note": "Every field must match schema type exactly"},
        {"solution": "Update frontmatter values to correct types: dates as ISO strings, numbers without quotes, booleans as true/false", "percentage": 92, "command": "date: 2025-11-25T00:00:00Z, published: true, views: 100"},
        {"solution": "Add missing required fields from schema if entry is incomplete", "percentage": 90, "note": "Check for required: true fields in your schema definition"}
    ]'::jsonb,
    'Content collection configured with schema.ts, Frontmatter in markdown/yaml files',
    'Content builds without schema validation errors, Collections load in templates, Type checking passes',
    'Mismatched data types in frontmatter (string vs number). Missing required fields. Using wrong date format. Quote-wrapped booleans.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: DuplicateContentEntrySlugError',
    'astro-content-collections',
    'MEDIUM',
    '[
        {"solution": "Rename duplicate files to have unique filenames (slugs are derived from filenames)", "percentage": 95, "note": "Each file in a collection must have unique name"},
        {"solution": "If using explicit slug field in frontmatter, ensure each entry has a unique slug value", "percentage": 92, "command": "slug: unique-identifier-per-entry"},
        {"solution": "Check subdirectories: duplicates can exist across folders if filenames match", "percentage": 85, "note": "Slug includes relative path from collection folder"}
    ]'::jsonb,
    'Content collection directory created, Multiple markdown files present',
    'Build completes without slug duplication warnings, Each entry loads uniquely, Collection queries return correct entries',
    'Having same filename in different subdirectories. Same explicit slug value in multiple files. Not checking across subdirectories for duplication.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: NoAdapterInstalled',
    'astro-build',
    'VERY_HIGH',
    '[
        {"solution": "Install an adapter package: npm install @astrojs/netlify or @astrojs/vercel or @astrojs/node", "percentage": 96, "note": "Choose adapter matching your deployment target"},
        {"solution": "Configure adapter in astro.config.mjs: import netlify from @astrojs/netlify; export default defineConfig({adapter: netlify()})", "percentage": 95, "command": "Add to astro.config.mjs: import adapter from @astrojs/[platform]; export default defineConfig({adapter: adapter()})"},
        {"solution": "Set output: server in astro.config.mjs to enable SSR if not already configured", "percentage": 85, "note": "output: hybrid allows mixing static and dynamic routes"}
    ]'::jsonb,
    'SSR or dynamic rendering routes configured, Deployment target identified',
    'Build completes successfully with adapter installed, Server routes render without adapter errors, Dev server runs on-demand routes',
    'Attempting server-side features without adapter. Using wrong adapter for platform. Forgetting to import adapter in config.',
    0.94,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: ImageMissingAlt',
    'astro-components',
    'HIGH',
    '[
        {"solution": "Add descriptive alt attribute to all Image components: <Image src={img} alt=\"Description of image content\" />", "percentage": 97, "note": "Alt text improves accessibility for screen readers"},
        {"solution": "For decorative images use empty alt: alt=\"\" but ensure only truly decorative images use this", "percentage": 85, "note": "Empty alt is valid only for purely decorative images"},
        {"solution": "Run build to catch missing alt attributes during compilation", "percentage": 90, "command": "npm run build will report all images missing alt attributes"}
    ]'::jsonb,
    'Image component in template, Image src attribute defined',
    'Build completes without alt attribute warnings, Image renders with accessibility metadata, Screen readers can interpret content',
    'Forgetting alt text entirely. Using generic alt text that doesn''t describe image. Using empty alt on meaningful images.',
    0.96,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: MissingImageDimension',
    'astro-components',
    'MEDIUM',
    '[
        {"solution": "Add explicit width and height attributes to Image components for local images", "percentage": 95, "note": "Dimensions prevent layout shift and improve performance"},
        {"solution": "For remote images, provide width and height or use densities option for auto-generation", "percentage": 90, "command": "<Image src={remoteUrl} width={800} height={600} alt=\"\" />"},
        {"solution": "Use Image getImage() to extract dimensions from image metadata before rendering", "percentage": 80, "note": "getImage() processes images and returns dimension info"}
    ]'::jsonb,
    'Image files present, Image component implemented',
    'Image renders without dimension errors, No layout shift during image load, Dev server shows no dimension warnings',
    'Omitting dimensions for local images. Not specifying remote image dimensions. Using only one dimension without other.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: UnsupportedImageFormat',
    'astro-components',
    'MEDIUM',
    '[
        {"solution": "Convert images to supported formats: JPEG, PNG, WebP, AVIF, GIF, or SVG using tools like ImageMagick or online converters", "percentage": 96, "note": "Astro image service supports these formats only"},
        {"solution": "For unsupported formats, use raw image tag or store as static assets outside image optimization", "percentage": 85, "command": "<img src=\"/image.bmp\" alt=\"\" /> or use public/ folder"},
        {"solution": "Configure custom image service if specialized format support needed", "percentage": 70, "note": "Advanced option for specific use cases"}
    ]'::jsonb,
    'Image file in unsupported format, Image component attempted',
    'Images convert and display correctly, Build completes without format errors, Optimized versions generate successfully',
    'Using unsupported formats like BMP, TIFF, ICO. Not checking format support before using Image component. Assuming all formats work.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: MiddlewareNoDataOrNextCalled',
    'astro-middleware',
    'HIGH',
    '[
        {"solution": "Ensure middleware returns either a Response object or calls next() to continue request processing", "percentage": 96, "note": "Every code path must return something"},
        {"solution": "Use next() to pass control to next middleware or route handler: return next()", "percentage": 95, "command": "export const onRequest = (context, next) => { return next(); }"},
        {"solution": "Return a Response object from middleware if blocking the request: return new Response(...)", "percentage": 90, "note": "Can also use context.rewrite() to change request destination"}
    ]'::jsonb,
    'Middleware file created in src/middleware.ts, Request routing configured',
    'Requests process without middleware errors, Page loads successfully, Middleware passes control correctly',
    'Middleware without return statement. Returning undefined. Forgetting next() in successful flow. Incomplete if/else branches.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
),
(
    'Astro: ContentEntryDataError',
    'astro-content-collections',
    'HIGH',
    '[
        {"solution": "Verify all frontmatter field names match exactly with schema definition in src/content/config.ts", "percentage": 96, "note": "Field name typos cause data validation failures"},
        {"solution": "Check data types match schema: strings, numbers, dates, booleans must be correct type in YAML/JSON", "percentage": 94, "command": "Use correct syntax: author: John (string), views: 100 (number), active: true (boolean)"},
        {"solution": "Ensure required fields are present and optional fields have correct structure when provided", "percentage": 90, "note": "Review schema.ts for required field definitions"}
    ]'::jsonb,
    'Content collection with schema validation, Markdown/data files created',
    'Content loads without data validation errors, Collections query returns all entries, Type checking passes in templates',
    'Typos in frontmatter field names. Wrong data types in YAML. Missing required fields. Nested objects with wrong structure.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://docs.astro.build/en/reference/error-reference/'
)
ON CONFLICT DO NOTHING;
