INSERT INTO knowledge_entries (query, category, hit_frequency, solutions, prerequisites, success_indicators, common_pitfalls, success_rate, claude_version, last_verified, source_url, contributor_email) VALUES
('Error: permission denied for schema public (42501)', 'backend', 'HIGH', '[{"solution": "Grant usage on schema public to anon and authenticated roles: GRANT USAGE ON SCHEMA public TO authenticated; GRANT USAGE ON SCHEMA public TO anon;", "percentage": 85}, {"solution": "Grant table permissions: GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO authenticated; GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO anon;", "percentage": 90}, {"solution": "Fix Prisma migration by resetting database and restoring default grants", "percentage": 80}]'::jsonb, 'Supabase PostgreSQL database with RLS enabled', 'Queries execute without 42501 error', 'Running prisma migrate reset on remote database without restoring grants, forgetting to grant permissions to anon role', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/67551593/supabase-client-permission-denied-for-schema-public', 'admin:1764223930'),
('Error: 42501 permission denied for schema public in Next.js', 'frontend', 'MEDIUM', '[{"solution": "Run GRANT USAGE ON SCHEMA public TO authenticated; GRANT USAGE ON SCHEMA public TO anon; in SQL editor", "percentage": 88}, {"solution": "Grant table permissions on all tables: GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO authenticated; GRANT SELECT, INSERT, UPDATE, DELETE ON ALL TABLES IN SCHEMA public TO anon;", "percentage": 92}]'::jsonb, 'Next.js app with Supabase client initialized', 'getStaticProps can fetch data without 42501 error', 'Not granting permissions to both authenticated and anon roles', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/74087068/error-42501-permission-denied-for-schema-public-in-nextjs', 'admin:1764223930'),
('Error: permission denied despite correct RLS policies (42501)', 'backend', 'MEDIUM', '[{"solution": "Check database role permissions: table-level permissions are separate from RLS. Grant permissions with: grant select,insert,update,delete,references,trigger on table_name to role_name", "percentage": 85}, {"solution": "Verify the database connection user has necessary object-level permissions on tables and schemas", "percentage": 80}]'::jsonb, 'Next.js with Clerk auth and Supabase, RLS policies configured', 'Queries execute on table data matching RLS policy', 'Confusing RLS row-level permissions with table-level object permissions in PostgreSQL', 0.82, 'haiku', NOW(), 'https://stackoverflow.com/questions/79747396/next-js-supabase-clerk-permission-denied-despite-correct-rls-as-supabase-a', 'admin:1764223930'),
('JWT expired (PGRST301)', 'auth', 'HIGH', '[{"solution": "Increase JWT expiry time in Supabase Dashboard > Settings > Authentication > Advanced Settings > JWT expiry duration", "percentage": 90}, {"solution": "Use token refresh mechanism: configure autoRefreshToken to true in Supabase client initialization", "percentage": 85}]'::jsonb, 'Supabase Flutter or JavaScript app with JWT authentication', 'No PGRST301 errors after token refresh, queries continue to work', 'JWT expiry time set too short (default 1 hour), not implementing auto-refresh for long-running sessions', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/77763828/supabase-postgrestexceptionmessage-jwt-expired-code-pgrst301-details-unaut', 'admin:1764223930'),
('Access token not refreshed after week of inactivity', 'auth', 'MEDIUM', '[{"solution": "Use expo-secure-store instead of AsyncStorage for token persistence: configure with ExpoSecureStoreAdapter", "percentage": 92}, {"solution": "Ensure autoRefreshToken and persistSession are both set to true in Supabase client config", "percentage": 85}]'::jsonb, 'React Native/Expo app with 1 week+ inactivity', 'User can continue using app after week without logging out again', 'Using AsyncStorage for secure token storage in React Native, not using proper secure storage mechanism', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/76591834/supabase-react-native-access-token-not-refreshed-after-a-week-of-inactivity', 'admin:1764223930'),
('Too many idle database connections in Supabase', 'backend', 'MEDIUM', '[{"solution": "Release pool connections immediately after use: call pool.end() or ensure connections go back to pool", "percentage": 85}, {"solution": "Configure connection pool limits in Prisma: do not use connection_limit=1 with external pooler PgBouncer", "percentage": 80}, {"solution": "Use direct port 5432 for migrations and 6543 for application queries with PgBouncer", "percentage": 82}]'::jsonb, 'Edge Functions or Node.js using postgres library with Supabase', 'Connection count stays below 60 max limit, no idle connection accumulation', 'Not closing pool after use, using connection_limit=1 with external pooler, creating new pools per request', 0.83, 'haiku', NOW(), 'https://stackoverflow.com/questions/79156717/too-many-idle-database-connections-in-supabase', 'admin:1764223930'),
('Prisma connection pool timeout with PgBouncer', 'backend', 'MEDIUM', '[{"solution": "Remove connection_limit=1 from connection string when using PgBouncer", "percentage": 88}, {"solution": "Increase Prisma connection pool timeout beyond 10 seconds default", "percentage": 75}, {"solution": "Use separate DATABASE_URL (6543 pooler) and DIRECT_URL (5432 direct) in schema.prisma", "percentage": 90}]'::jsonb, 'Prisma ORM with Supabase and PgBouncer enabled', 'Prisma queries complete without timeout errors, connection pool stable', 'Misconfiguring connection limits for external pooler, confusing pooler and direct connection URLs', 0.85, 'haiku', NOW(), 'https://stackoverflow.com/questions/76000319/prisma-orm-pgbouncer-supabase-stack-what-is-causing-these-database-connectio', 'admin:1764223930'),
('Prisma P1001: Can''t reach database server', 'backend', 'HIGH', '[{"solution": "Check IPv4/IPv6 network settings: use Session Spooler connection mode or IPv4-specific settings from Supabase Connect options", "percentage": 80}, {"solution": "Add connect_timeout to connection string: connection_string?connect_timeout=300", "percentage": 82}, {"solution": "Verify password has no special characters or escape them properly in connection URL", "percentage": 85}]'::jsonb, 'Prisma with Supabase PostgreSQL database', 'Prisma migrations and queries work without P1001 error', 'Using incorrect IPv6 address format, missing connect_timeout parameter, improper password encoding in URL', 0.80, 'haiku', NOW(), 'https://stackoverflow.com/questions/73866587/prisma-error-p1001-cant-reach-database-server-at-db-xocheossqzkirwnhzxxm-sup', 'admin:1764223930'),
('Prisma cannot connect to Supabase with PgBouncer', 'backend', 'MEDIUM', '[{"solution": "Use correct pooler address: aws-0-region.pooler.supabase.com:6543 for queries, not db.*.supabase.co", "percentage": 92}, {"solution": "Configure directUrl for migrations on direct port 5432: postgresql://user:pass@aws-region.pooler.supabase.com:5432/postgres", "percentage": 88}, {"solution": "Check connection_limit parameter: adjust beyond 2 if encountering frequent timeouts", "percentage": 75}]'::jsonb, 'Prisma 6.x with Supabase DATABASE_URL and DIRECT_URL', 'Prisma client connects and queries execute successfully', 'Using db.*.supabase.co instead of aws-*.pooler.supabase.com, incorrect port numbers (6543 vs 5432)', 0.86, 'haiku', NOW(), 'https://stackoverflow.com/questions/79267484/prisma-cannot-connect-to-supabase', 'admin:1764223930'),
('Email address cannot be used as it is not authorized', 'auth', 'MEDIUM', '[{"solution": "Set up custom SMTP provider (Resend, AWS SES, Mailgun) in Supabase Authentication settings", "percentage": 90}, {"solution": "Or disable email confirmation requirement: Authentication > Providers > Email > Confirm Email toggle OFF", "percentage": 85}]'::jsonb, 'Supabase Edge Function creating users with admin SDK', 'Users can be created with email signup without authorization errors', 'Missing SMTP configuration for email signups, email confirmation requirement conflicting with provider setup', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/79047884/supabase-error-email-address-cannot-be-used-as-it-is-not-authorized', 'admin:1764223930'),
('ECONNRESET error during file upload to storage', 'storage', 'LOW', '[{"solution": "Move file uploads to client-side instead of server-side in serverless/remix environments", "percentage": 88}, {"solution": "Implement retry logic with exponential backoff for failed upload attempts", "percentage": 75}, {"solution": "Use direct client authentication for storage uploads to avoid backend routing issues", "percentage": 82}]'::jsonb, 'Remix action with multipart form data file uploads to Supabase storage', 'File uploads complete without connection reset errors', 'Doing large file uploads through serverless backend instead of client, not handling network interruptions', 0.78, 'haiku', NOW(), 'https://stackoverflow.com/questions/70920703/how-to-deal-with-econnreset-error-in-supabase', 'admin:1764223930'),
('Supabase Realtime channel type errors in TypeScript', 'frontend', 'MEDIUM', '[{"solution": "Explicitly type the payload parameter: (payload: RealtimePostgresChangesPayload<Tables<\"table_name\">>) => onTableChange(payload)", "percentage": 90}, {"solution": "Use generic type fallback: payload: RealtimePostgresChangesPayload<Record<string, any>>", "percentage": 85}]'::jsonb, 'Supabase Realtime subscriptions in TypeScript with strict type checking', 'Realtime subscriptions work without type errors in IDE or compiler', 'Not providing proper type generics for RealtimePostgresChangesPayload, mixing string literal types incorrectly', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/74897912/supabase-types-errors', 'admin:1764223930'),
('Error sending confirmation email SMTP timeout', 'auth', 'MEDIUM', '[{"solution": "Use port 587 (TLS) instead of port 25 or 465 for SMTP in Supabase settings", "percentage": 90}, {"solution": "Verify SMTP admin email and SMTP user fields are not swapped in Supabase Authentication settings", "percentage": 88}, {"solution": "Switch email service provider to production mode (not sandbox) for unrestricted email delivery", "percentage": 85}]'::jsonb, 'Supabase with custom SMTP (Mailgun, AWS SES)', 'Confirmation emails send successfully without timeout or auth errors', 'Wrong SMTP port configuration, swapped SMTP credentials, email service in sandbox mode', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/72790991/supabase-returns-multiple-errors-from-custom-smtp-settings', 'admin:1764223930'),
('OAuth: Multiple accounts with same email detected', 'auth', 'LOW', '[{"solution": "Catch error parameter in callback URL: check for error and error_description query parameters", "percentage": 82}, {"solution": "Display error message on frontend: if (error) { show_error(error_description) }", "percentage": 80}]'::jsonb, 'Supabase OAuth with multiple providers (Google, GitHub)', 'OAuth callback errors are caught and displayed to users', 'Not checking query parameters in OAuth callback for error codes', 0.75, 'haiku', NOW(), 'https://stackoverflow.com/questions/76861476/how-to-catch-handle-error-on-the-supabase-callback-url-oauth', 'admin:1764223930'),
('Signups not allowed for this instance', 'auth', 'MEDIUM', '[{"solution": "Enable signups in Supabase Dashboard: Settings > Authentication > Enable Signups toggle ON", "percentage": 95}, {"solution": "Visit https://app.supabase.com/project/[PROJECT_ID]/settings/auth to enable user registration", "percentage": 95}]'::jsonb, 'Supabase Flutter or JavaScript app attempting user signup', 'Users can successfully sign up with email/password', 'Signups disabled in Supabase project settings, forgetting to enable registration provider', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/75854447/supabase-signup-fails-signup-not-allowed', 'admin:1764223930'),
('Auth signup data destructuring returns null', 'auth', 'MEDIUM', '[{"solution": "Destructure user and session from data object: const { user, session } = data instead of destructuring data directly", "percentage": 90}, {"solution": "Check data.user and data.session properties instead of standalone user/session", "percentage": 88}]'::jsonb, 'Supabase Vue 3 signup with Pinia store', 'Successfully access user and session data after signup', 'Incorrectly destructuring signUp response, expecting data.user but accessing data as user', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/74924142/supabase-auth-signup-doesnt-return-data-only-shows-error-in-response', 'admin:1764223930'),
('AuthRetryableFetchError 504 on signup', 'auth', 'MEDIUM', '[{"solution": "Verify SMTP provider (Resend, AWS SES) is operational and not having outages", "percentage": 85}, {"solution": "Disable email confirmation temporarily: Authentication > Providers > Confirm Email toggle OFF if provider is down", "percentage": 80}]'::jsonb, 'Supabase signup via Edge Function with custom SMTP', 'Signup completes without 504 errors when provider is operational', 'SMTP provider (Resend) experiencing downtime, email confirmation requiring unavailable service', 0.82, 'haiku', NOW(), 'https://stackoverflow.com/questions/78982087/supabase-signup-returning-authretryablefetcherror-504', 'admin:1764223930'),
('Realtime subscriptions timeout after multiple joins', 'frontend', 'LOW', '[{"solution": "Restart browser to clear WebSocket connections and socket pool", "percentage": 85}, {"solution": "Unsubscribe from previous subscriptions before creating new ones: await subscription.unsubscribe()", "percentage": 88}]'::jsonb, 'Supabase Realtime with React or Native subscriptions', 'Realtime subscriptions receive data without TIMED_OUT errors', 'Not properly cleaning up subscription connections, hitting browser socket limits', 0.81, 'haiku', NOW(), 'https://stackoverflow.com/questions/75037366/supabase-realtime-subscriptions-times-out', 'admin:1764223930'),
('Error joining realtime channel (phx_reply error)', 'frontend', 'MEDIUM', '[{"solution": "Use remote Supabase development instead of local Docker setup which may be outdated", "percentage": 85}, {"solution": "Enable realtime on target table: go to Table Settings > Realtime Replication and enable postgres_changes", "percentage": 90}]'::jsonb, 'Supabase Realtime v2 with postgres_changes', 'Successfully join realtime channels and receive updates without phx_reply errors', 'Using outdated local Docker Supabase image, not enabling realtime replication on tables', 0.83, 'haiku', NOW(), 'https://stackoverflow.com/questions/74175531/supabase-realtime-error-occurred-when-joining-realtimepublicchannel', 'admin:1764223930'),
('Storage: Foreign key constraint violation on upload', 'storage', 'MEDIUM', '[{"solution": "Use bucket_id (not bucket name with prefix) in storage policies: bucket_id = ''training-data''", "percentage": 88}, {"solution": "Remove ''public/'' prefix from bucket name in from() method: .from(''training-data'').upload() not .from(''public/training-data'')", "percentage": 92}, {"solution": "Create proper storage policies: CREATE POLICY ... ON storage.objects FOR INSERT TO public WITH CHECK (bucket_id = ''training-data'')", "percentage": 85}]'::jsonb, 'Supabase storage with Python SDK or JavaScript', 'Files upload successfully without foreign key constraint errors', 'Using incorrect bucket naming convention with prefixes, missing storage policies, mismatched bucket_id values', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/73070429/supabase-not-allowing-upload-of-files-into-storage-bucket', 'admin:1764223930'),
('TUS upload error: filesystem does not support extended attributes', 'storage', 'LOW', '[{"solution": "Add TUS_URL_PATH environment variable to docker-compose.yml for self-hosted Supabase: TUS_URL_PATH: ''/storage/v1/upload/resumable''", "percentage": 80}, {"solution": "Clear browser local storage and restart containers after configuration change", "percentage": 75}]'::jsonb, 'Self-hosted Supabase with local file storage', 'TUS resumable uploads work without extended attribute errors', 'MacOS with osxfs + Docker not supporting extended attributes, missing TUS_URL_PATH environment configuration', 0.72, 'haiku', NOW(), 'https://stackoverflow.com/questions/79057613/supabase-error-when-trying-to-upload-my-file', 'admin:1764223930'),
('Edge Function timeout at 400 seconds', 'backend', 'MEDIUM', '[{"solution": "Break large generation tasks into smaller requests using queue/batch processing", "percentage": 75}, {"solution": "Implement pagination for sequential generation: process 10 items per request, make 5 requests total", "percentage": 80}, {"solution": "Consider background jobs or scheduled functions for long-running tasks", "percentage": 70}]'::jsonb, 'Supabase Edge Function with OpenAI text/image generation', 'Large generation tasks complete without 400 second timeout', 'Attempting too much work in single function call, not implementing pagination or batch processing', 0.72, 'haiku', NOW(), 'https://stackoverflow.com/questions/77608995/supabase-edge-functions-timeout', 'admin:1764223930'),
('Edge Function 504 Gateway Timeout with null headers', 'backend', 'MEDIUM', '[{"solution": "Check billing quota limits: Settings > Subscription > Billing Breakdown to ensure no limits exceeded", "percentage": 75}, {"solution": "Deploy new version of function and redeploy using supabase functions deploy", "percentage": 80}, {"solution": "Create minimal test function to verify deployment: supabase functions deploy test-fn", "percentage": 85}]'::jsonb, 'Supabase Edge Functions with no invocation logs', 'Edge functions execute and return 200 status with proper headers', 'Unknown infrastructure issue, billing quota limits, function deployment issues', 0.73, 'haiku', NOW(), 'https://stackoverflow.com/questions/76928623/supabase-edge-function-code-504-with-no-logs', 'admin:1764223930'),
('RPC function not found (404 error)', 'backend', 'MEDIUM', '[{"solution": "Ensure parameter names in rpc() call match database function signature exactly: rpc(''func_name'', {param1: val1, param2: val2})", "percentage": 92}, {"solution": "Verify function schema and existence: check if function is in public schema or needs explicit schema reference", "percentage": 88}]'::jsonb, 'Supabase RPC function calls from JavaScript/React', 'RPC function executes successfully with proper response', 'Parameter name mismatch between rpc call and database function definition, function not in public schema', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/75881541/404-error-with-supabase-when-trying-to-use-rpc', 'admin:1764223930'),
('Bucket not found error when uploading files', 'storage', 'MEDIUM', '[{"solution": "Create storage policy for bucket access: CREATE POLICY ''Allow authenticated users to view bucket'' ON storage.buckets FOR SELECT TO authenticated USING (true);", "percentage": 88}, {"solution": "Verify bucket name matches exactly and is accessible by authenticated user", "percentage": 85}, {"solution": "Check storage permissions in Supabase documentation on permissions for buckets and objects", "percentage": 82}]'::jsonb, 'Supabase storage with public bucket and Python backend', 'Successfully upload files to bucket without bucket not found errors', 'Missing bucket-level view permissions, incorrect bucket name, missing storage policies', 0.85, 'haiku', NOW(), 'https://stackoverflow.com/questions/79410486/supabase-unable-to-find-the-bucket-even-though-its-present', 'admin:1764223930');
