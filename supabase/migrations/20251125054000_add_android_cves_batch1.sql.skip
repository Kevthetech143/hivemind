-- Android Security Bulletins CVE extraction batch 1
-- Source: https://source.android.com/security/bulletin
-- Extracted: 2025-11-25
-- Contains: 11 Android CVE entries with exploit → patch → prevention patterns

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'CVE-2025-48593: Bluetooth Remote Code Execution vulnerability',
    'cve',
    'HIGH',
    '[
        {"solution": "Identify affected device: Check Settings > About > Security patch level - affects devices with patch level before 2025-11-01", "percentage": 95, "note": "First step to determine if device is vulnerable"},
        {"solution": "Apply security patch: Install security update for patch level 2025-11-01 or later through device Settings > System > System update or manufacturer update service", "percentage": 95, "note": "Official remediation from Android Security Bulletin"},
        {"solution": "Verify patch applied: Confirm Settings > About > Security patch level shows 2025-11-01 or later date", "percentage": 90, "command": "Check device settings after update"},
        {"solution": "As workaround before update: Disable Bluetooth in Settings if not immediately needed to reduce exploitation surface", "percentage": 75, "note": "Temporary mitigation only"}
    ]'::jsonb,
    'Android device with Bluetooth enabled, Internet access for system update, Sufficient storage space',
    'Security patch level updated to 2025-11-01 or later, No exploitation attempts detected in system logs, Bluetooth continues functioning normally',
    'Bluetooth RCE requires no user interaction - do not delay patching. Patch level dates are critical: 2025-11-01 is minimum required. Disabling Bluetooth is workaround only, not permanent solution.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-11-01'
),
(
    'CVE-2025-48581: System component elevation of privilege vulnerability',
    'cve',
    'HIGH',
    '[
        {"solution": "Verify vulnerability exposure: Check Settings > About > Security patch level - vulnerability affects Android 16 devices with patch level before 2025-11-01", "percentage": 95, "note": "Android 13-15 users not affected by this specific CVE"},
        {"solution": "Apply security patch level 2025-11-01 or later via Settings > System > System update", "percentage": 95, "note": "Mandatory for Android 16 users"},
        {"solution": "Verify patch by checking APEX module versions: Settings > System > System update history shows timestamp after 2025-11-01", "percentage": 85, "note": "APEX modules (Android Pony EXpress) are updated separately"},
        {"solution": "Monitor for unauthorized privilege escalation: Review system logs for unexpected permission grants or privilege elevation attempts", "percentage": 70, "note": "Post-patch verification"}
    ]'::jsonb,
    'Android 16 device, System update access, Storage space for update download',
    'Security patch level shows 2025-11-01 or later, APEX modules updated, No privilege escalation detected in system logs, Device functions normally',
    'This CVE affects Android 16 specifically - does not apply to Android 13-15. Do not assume patch level without verification. APEX updates are separate from system updates.',
    0.94,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-11-01'
),
(
    'CVE-2025-48539: Bluetooth proximal remote code execution',
    'cve',
    'VERY_HIGH',
    '[
        {"solution": "Check affected versions: CVE-2025-48539 affects Android 15 and 16 only. Verify device version in Settings > About > Android version", "percentage": 95, "note": "Android 13-14 users not affected"},
        {"solution": "Apply critical patch level 2025-09-05 or later via Settings > System > System update", "percentage": 95, "note": "Proximal RCE requires adjacent network access but no user interaction"},
        {"solution": "As temporary mitigation: Disable Bluetooth (Settings > Connected devices > Bluetooth toggle off) until patch is installed", "percentage": 80, "note": "Reduces attack surface - attacker must be in Bluetooth range"},
        {"solution": "Verify successful patch: Confirm patch level 2025-09-05 or later in Settings > About > Security patch level", "percentage": 90, "command": "Settings > About > Security patch level"}
    ]'::jsonb,
    'Android 15 or 16 device, System update capability, Bluetooth functionality available',
    'Security patch level updated to 2025-09-05 or later, No unexpected Bluetooth connections in Settings > Connected devices, Device continues normal Bluetooth operation',
    'Proximal RCE means attacker must be nearby (Bluetooth range ~10-100m). This is critical - do not delay update. Android 13-14 are unaffected.',
    0.96,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-09-01'
),
(
    'CVE-2025-48543: Android Runtime elevation of privilege',
    'cve',
    'HIGH',
    '[
        {"solution": "Identify affected devices: Affects Android 13, 14, 15, 16. Check Settings > About > Android version", "percentage": 95, "note": "Wide version range affected"},
        {"solution": "Apply security patch level 2025-09-01 or later through Settings > System > System update", "percentage": 95, "note": "ART (Android Runtime) is included in Project Mainline updates"},
        {"solution": "Verify ART patch applied: After update, check for any app runtime errors in Settings > Apps > See all apps > App management", "percentage": 85, "note": "ART updates may require app cache clearing in rare cases"},
        {"solution": "If apps misbehave after update: Clear app cache via Settings > Apps > [App name] > Storage > Clear cache", "percentage": 75, "note": "Resolves most ART-related issues after patching"}
    ]'::jsonb,
    'Android device 13-16, Active system update mechanism, Sufficient storage for patch download',
    'Security patch level 2025-09-01 or later installed, Apps run without unexpected privilege elevation errors, No app crashes or permission denials',
    'ART is the Android Runtime - all apps depend on it. Do not defer this patch. Some apps may need cache clearing after ART updates. This is normal behavior.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-09-01'
),
(
    'CVE-2025-0089: Framework elevation of privilege affecting multiple Android versions',
    'cve',
    'HIGH',
    '[
        {"solution": "Check device version: Vulnerability affects Android 13, 14, 15 (Android 16 not affected). Verify in Settings > About > Android version", "percentage": 95, "note": "Affects framework layer across multiple versions"},
        {"solution": "Requires user interaction for exploitation. Apply patch level 2025-09-01 or later via Settings > System > System update", "percentage": 94, "note": "Framework patches are core OS updates"},
        {"solution": "Verify patch installed: Check Settings > About > Security patch level shows 2025-09-01 or later", "percentage": 90, "command": "Settings > About > Security patch level"},
        {"solution": "Monitor app permissions: Review Settings > Apps > Permissions > [Permission type] for unexpected privilege grants after patching", "percentage": 80, "note": "Post-patch verification step"}
    ]'::jsonb,
    'Android 13, 14, or 15 device, Internet connectivity for updates, Storage space available',
    'Security patch level updated to 2025-09-01 or later, App permissions remain as expected, No unauthorized framework behavior observed',
    'Framework vulnerabilities affect system-wide behavior. User interaction is required for exploitation (attacker cannot exploit without user action). Android 16 is unaffected.',
    0.92,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-09-01'
),
(
    'CVE-2025-38352: Kernel time subsystem elevation of privilege - all Android versions',
    'cve',
    'HIGH',
    '[
        {"solution": "Critical: Affects ALL Android versions (13, 14, 15, 16). No version is exempt. Check Settings > About > Android version to confirm device status", "percentage": 95, "note": "Universal vulnerability across all supported versions"},
        {"solution": "Bulletin notes: This CVE may be under limited, targeted exploitation. Apply security patch level 2025-09-05 or later immediately", "percentage": 95, "note": "Active exploitation reported - highest priority"},
        {"solution": "Kernel patches are delivered through security updates: Go to Settings > System > System update > Check for updates", "percentage": 93, "command": "Settings > System > System update"},
        {"solution": "Verify patch applied: Check that Security patch level in Settings > About shows 2025-09-05 or later date", "percentage": 90, "note": "Kernel fixes come via security patch levels, not version numbers"}
    ]'::jsonb,
    'Any Android device (all versions 13+), System update access, Device connectivity for patch download',
    'Security patch level 2025-09-05 or later confirmed, Kernel time subsystem functions normally, No unexpected system clock or timing anomalies',
    'This affects ALL Android versions - no device is immune. Limited exploitation is already occurring (as of Sept 2025 bulletin date). Priority patch. Do not confuse security patch level with Android version number.',
    0.96,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-09-01'
),
(
    'CVE-2025-48530: Critical system component RCE with crabbyavif parser',
    'cve',
    'VERY_HIGH',
    '[
        {"solution": "Identify vulnerability scope: CVE-2025-48530 affects Android 16 and requires no execution privileges or user interaction for RCE", "percentage": 95, "note": "Critical severity - requires immediate action"},
        {"solution": "Apply security patch level 2025-08-05 or later via Settings > System > System update", "percentage": 95, "note": "Patch includes two separate fixes to crabbyavif component"},
        {"solution": "Verify both crabbyavif patches applied: Check system logs for component version after patch (Settings > About > System status)", "percentage": 85, "note": "Two separate AOSP patch commits were released"},
        {"solution": "As immediate mitigation: Disable image downloading from untrusted sources until patch is applied. Restrict web browsing to HTTPS sites only", "percentage": 75, "note": "RCE exploits typically via malicious image files"}
    ]'::jsonb,
    'Android 16 device, Full system update capability, Storage space for patch files',
    'Security patch level 2025-08-05 or later installed, crabbyavif decoder functions normally, No image processing errors or system crashes',
    'RCE requires NO user interaction - attacker can trigger via image in web page, message, or email. Do not delay patching. crabbyavif is image parser library. Two patches were required.',
    0.97,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-08-01'
),
(
    'CVE-2025-22441: Framework elevation of privilege requiring user interaction',
    'cve',
    'HIGH',
    '[
        {"solution": "Check affected versions: CVE-2025-22441 targets Android 13, 14, 15. Verify device version in Settings > About > Android version", "percentage": 95, "note": "Android 16 not affected by this specific CVE"},
        {"solution": "Exploitation requires user interaction (user must take action). Apply patch level 2025-08-05 or later via Settings > System > System update", "percentage": 94, "note": "Framework components updated through security patches"},
        {"solution": "Verify patch: Confirm Settings > About > Security patch level shows 2025-08-05 or later", "percentage": 90, "command": "Settings > About > Security patch level"},
        {"solution": "Be cautious with app interactions: Do not grant unusual permissions to apps or click suspicious links/attachments until patched", "percentage": 80, "note": "User action requirement means phishing/social engineering vector"}
    ]'::jsonb,
    'Android 13, 14, or 15 device, System update enabled, Storage for patch download, User awareness of suspicious content',
    'Security patch level 2025-08-05 or later installed, Apps request expected permissions only, No unexpected privilege escalation',
    'Requires user interaction for exploitation - this is a social engineering/phishing vector. Do not click suspicious links while unpatched. Android 16 is unaffected.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-08-01'
),
(
    'CVE-2025-48533: Framework elevation of privilege in all recent Android versions',
    'cve',
    'HIGH',
    '[
        {"solution": "Vulnerability scope: Affects Android 13, 14, 15, 16 - verify device version in Settings > About > Android version", "percentage": 95, "note": "Wide version coverage requires universal patching"},
        {"solution": "Requires user interaction for exploitation. Apply security patch level 2025-08-05 or later through Settings > System > System update", "percentage": 95, "note": "AOSP fix has direct patch link available in bulletin"},
        {"solution": "After patching verify: Check Settings > About > Security patch level shows 2025-08-05 or later and reboot device", "percentage": 90, "command": "Reboot device after system update"},
        {"solution": "Review recent app installs: Check Settings > Apps > Install history for any unexpected apps installed before patch was applied", "percentage": 75, "note": "Post-patch verification of system integrity"}
    ]'::jsonb,
    'Android 13-16 device, System update access, Device reboot capability, Storage space for updates',
    'Security patch level 2025-08-05 or later confirmed, App installation history shows no unauthorized apps, Framework functions normally',
    'Affects all recent Android versions. User interaction required for exploitation (app install, permission grant, etc.). Reboot recommended after framework updates.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-08-01'
),
(
    'CVE-2025-21479: Critical Qualcomm closed-source component vulnerability',
    'cve',
    'VERY_HIGH',
    '[
        {"solution": "Determine device manufacturer: CVE-2025-21479 is Qualcomm closed-source component. Check Settings > About > Device name and Manufacturer", "percentage": 95, "note": "Only Qualcomm SoC devices affected - check processor type"},
        {"solution": "Apply security patch level 2025-08-05 or later. For Qualcomm devices: Go to Settings > System > System update", "percentage": 94, "note": "Patch must come from device manufacturer as Qualcomm component"},
        {"solution": "Verify patch from manufacturer: Check with device manufacturer (Samsung, Google Pixel, etc.) for specific Qualcomm security update status", "percentage": 85, "note": "Qualcomm patches often lag behind AOSP patches by days/weeks"},
        {"solution": "If manufacturer delay: Check manufacturer security bulletin website (e.g., Samsung Security Updates, Google Pixel Security) for ETA on Qualcomm patches", "percentage": 75, "note": "Qualcomm components require manufacturer release process"}
    ]'::jsonb,
    'Qualcomm SoC device (Samsung, Google Pixel, OnePlus, etc.), Device manufacturer OTA access, Internet connectivity',
    'Device manufacturer confirms patch level 2025-08-05 or later installed for Qualcomm component, Qualcomm security bulletin lists device as patched, No boot failures or driver errors',
    'Only Qualcomm SoC devices affected. Qualcomm patches arrive through device manufacturers, not directly from Google. Check manufacturer bulletin specifically. Do not assume standard Android update covers this.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-08-01'
),
(
    'CVE-2025-0932: Arm Mali GPU component elevation of privilege',
    'cve',
    'HIGH',
    '[
        {"solution": "Determine device GPU: CVE-2025-0932 affects Arm Mali GPUs. Check Settings > About > Device name and search manufacturer specs for GPU type", "percentage": 90, "note": "Only devices with Arm Mali GPU (not Qualcomm Adreno) affected"},
        {"solution": "Details available from Arm directly: Visit https://www.arm.com/security-center for Arm Mali GPU security updates and CVE details", "percentage": 95, "note": "Arm publishes separate security bulletins for Mali components"},
        {"solution": "Apply patch via device manufacturer update: Go to Settings > System > System update - Arm Mali patches come through OEM releases", "percentage": 88, "note": "Arm components patched through device manufacturer"},
        {"solution": "Verify GPU patch: After update, run GPU benchmarks in Settings > Apps > Play Store > GPU-intensive app to confirm normal operation", "percentage": 75, "note": "Verify GPU driver stability after patching"}
    ]'::jsonb,
    'Arm Mali GPU device (check device specs), Arm security bulletin access, Device manufacturer update mechanism',
    'Device manufacturer confirms patch applied, Arm security bulletin lists CVE as resolved for device SoC, GPU applications run without errors',
    'Only affects Arm Mali GPU devices - not Qualcomm Adreno. CVE details are from Arm, not Android bulletin. Check device specs to determine if Mali GPU is present.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://source.android.com/docs/security/bulletin/2025-08-01'
);
