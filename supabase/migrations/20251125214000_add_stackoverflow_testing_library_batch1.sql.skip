-- Stack Overflow React Testing Library Solutions Batch 1
-- Extracted: 12 highest-voted questions with accepted answers
-- Category: stackoverflow-testing-library

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'How do you test for the non-existence of an element using jest and react-testing-library?',
    'stackoverflow-testing-library',
    'VERY_HIGH',
    '[
        {"solution": "Use queryBy* methods instead of getBy* methods. The query variants return null when elements are not found, rather than throwing errors. Example: const submitButton = screen.queryByText(''submit''); expect(submitButton).toBeNull();", "percentage": 95, "note": "Most reliable approach - aligns with RTL best practices"},
        {"solution": "Use not.toBeInTheDocument() matcher with jest-dom. Example: expect(screen.queryByText(''submit'')).not.toBeInTheDocument();", "percentage": 92, "note": "Requires @testing-library/jest-dom import"},
        {"solution": "Use queryAllBy for multiple elements and check length. Example: const submitButtons = screen.queryAllByText(''submit''); expect(submitButtons).toHaveLength(0);", "percentage": 88, "note": "Useful for verifying all instances do not exist"}
    ]'::jsonb,
    'Jest testing framework installed, React Testing Library installed, Optional: @testing-library/jest-dom for toBeInTheDocument()',
    'queryBy* returns null or queryAllBy has length 0, Test passes without throwing errors, Element does not appear in DOM output',
    'Using getByText/getByTestId which throw errors instead of returning null, Forgetting to wrap getBy* calls in an arrow function when using .toThrow(), Not importing jest-dom when using toBeInTheDocument() matcher',
    0.93,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/52783144/how-do-you-test-for-the-non-existence-of-an-element-using-jest-and-react-testing'
),
(
    'react-testing-library why is toBeInTheDocument() not a function',
    'stackoverflow-testing-library',
    'HIGH',
    '[
        {"solution": "Install @testing-library/jest-dom package: npm install --save-dev @testing-library/jest-dom", "percentage": 98, "note": "The toBeInTheDocument matcher is provided by this package, not RTL itself"},
        {"solution": "For Create React App projects: add import ''@testing-library/jest-dom'' to src/setupTests.js (exact filename required). File must be in src/ directory.", "percentage": 96, "note": "CRA automatically loads src/setupTests.js before tests"},
        {"solution": "For custom Jest setups: configure setupFilesAfterEnv in jest.config.js to load the package", "percentage": 94, "note": "Alternative to CRA''s auto-loading mechanism"}
    ]'::jsonb,
    'Jest as test runner, React Testing Library installed, Node/npm environment',
    'toBeInTheDocument() is recognized as a Jest matcher, Tests run without ''not a function'' error, Custom matchers available in all test files',
    'Using setupTests.js filename (wrong - must be setupTests.js exactly), Placing setup file in root instead of src/ directory, Typo in matcher name: toBeInDocument() instead of toBeInTheDocument(), Missing @types/testing-library__jest-dom TypeScript definitions',
    0.97,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/56547215/react-testing-library-why-is-tobeinthedocument-not-a-function'
),
(
    'react-testing-library: some portion of debug''s output is not visible',
    'stackoverflow-testing-library',
    'MEDIUM',
    '[
        {"solution": "Use environment variable to increase character limit: DEBUG_PRINT_LIMIT=100000 yarn test", "percentage": 92, "note": "Global solution affects all debug() calls in test suite"},
        {"solution": "Pass limit directly to debug function: screen.debug(undefined, 300000) or debug(element, Infinity)", "percentage": 90, "note": "Per-call configuration, useful for specific large components"},
        {"solution": "Use screen.debug(element, 100000) to debug specific elements with higher limit", "percentage": 85, "note": "More targeted approach than debugging entire DOM"}
    ]'::jsonb,
    'react-testing-library installed, Jest test runner configured, Terminal with adequate scrollback buffer',
    'Full DOM structure visible in debug output without truncation, Closing tags properly displayed, Complete element tree rendered',
    'Setting limit value too low (7000 is default), Using --silent flag in Jest which suppresses debug output entirely, Terminal buffer limitations preventing output visibility, Confusing character limit with line limit',
    0.88,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/59763739/react-testing-library-some-portion-of-debugs-output-is-not-visible'
),
(
    'How to test a className with the Jest and React testing library',
    'stackoverflow-testing-library',
    'HIGH',
    '[
        {"solution": "Use @testing-library/jest-dom toHaveClass matcher (recommended): expect(container.firstChild).toHaveClass(''className'')", "percentage": 94, "note": "Cleaner and more readable than classList API"},
        {"solution": "Use classList API: expect(container.firstChild.classList.contains(''foo'')).toBe(true)", "percentage": 88, "note": "Works without jest-dom but less readable"},
        {"solution": "For multiple classes, call contains() separately for each: expect(element.classList.contains(''class1'')).toBe(true) && expect(element.classList.contains(''class2'')).toBe(true)", "percentage": 75, "note": "Verbose for multiple class testing"}
    ]'::jsonb,
    'Jest configured in React project, React Testing Library installed, Optional: @testing-library/jest-dom for toHaveClass matcher, render() function available',
    'toHaveClass assertion passes, classList.contains returns expected boolean, Test verifies user-visible behavior not implementation',
    'Avoiding getByClassName pattern (RTL intentionally omits this), Not destructuring container from render result, Testing CSS implementation details instead of user behavior, Attempting to use non-existent getByClassName query',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/53389956/how-to-test-a-classname-with-the-jest-and-react-testing-library'
),
(
    'How to solve the "update was not wrapped in act()" warning in testing-library-react?',
    'stackoverflow-testing-library',
    'VERY_HIGH',
    '[
        {"solution": "Use findBy* selectors which return promises and automatically handle act() wrapping: const listNode = await screen.findByTestId(''list''); expect(listNode.children).toHaveLength(2);", "percentage": 94, "note": "Recommended approach - handles async state updates automatically"},
        {"solution": "Use waitFor() callback wrapper: await waitFor(() => { expect(getByTestId(''list'')).toBeDefined() })", "percentage": 90, "note": "Explicitly wraps assertions that depend on async updates"},
        {"solution": "Wrap state-changing operations in act(): await act(async () => { /* state-changing code */ })", "percentage": 85, "note": "Direct approach but requires more boilerplate"},
        {"solution": "Call cleanup() in afterEach hook to ensure proper test isolation", "percentage": 80, "note": "Prevents cleanup warnings in subsequent tests"}
    ]'::jsonb,
    'React Testing Library installed, Mocked API calls using jest.mock or MSW, Understanding of async/await patterns, Imported render and findByTestId/waitFor from RTL',
    'No ''update was not wrapped in act()'' warnings in test output, Async state updates complete before test ends, All assertions pass with proper timing',
    'Not awaiting async operations like findBy* or waitFor(), Forgetting cleanup() in afterEach block, Using getBy* without waiting for async data, Not properly mocking API calls, Missing await keyword on async functions, Starting assertions before async operations complete',
    0.92,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/60115885/how-to-solve-the-update-was-not-wrapped-in-act-warning-in-testing-library-react'
),
(
    'How to test anchor''s href with react-testing-library',
    'stackoverflow-testing-library',
    'HIGH',
    '[
        {"solution": "Use getByRole to query semantically, then test the href attribute: expect(screen.getByRole(''link'', { name: ''Click Me'' })).toHaveAttribute(''href'', ''https://www.test.com/'')", "percentage": 96, "note": "Most accessible approach aligns with RTL philosophy"},
        {"solution": "Use getAttribute() method on queried element: const link = screen.getByRole(''link'', { name: ''Click Me'' }); expect(link.getAttribute(''href'')).toBe(''https://test.com'')", "percentage": 90, "note": "Lower-level approach without jest-dom matchers"},
        {"solution": "Query by testid if semantic query not applicable: expect(getByTestId(''link'')).toHaveAttribute(''href'', ''https://test.com'')", "percentage": 85, "note": "Fallback when link lacks accessible name"}
    ]'::jsonb,
    'React Testing Library installed, Jest DOM matchers imported (import "@testing-library/jest-dom"), jsdom test environment configured, href attribute present on anchor element',
    'toHaveAttribute assertion passes, getAttribute returns correct URL, Test validates attribute not navigation (jsdom cannot navigate)',
    'Attempting to test window.location.href after clicking (jsdom prevents navigation), Using closest(''a'') which violates RTL semantic principles, Not using getByRole for semantic queries, Expecting navigation to actually occur in jsdom environment, Forgetting jsdom cannot simulate browser navigation',
    0.94,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/57827126/how-to-test-anchors-href-with-react-testing-library'
),
(
    'Check that button is disabled in react-testing-library',
    'stackoverflow-testing-library',
    'HIGH',
    '[
        {"solution": "Use closest() to traverse from nested content to button, then toBeDisabled(): expect(getByText(/Click me/i).closest(''button'')).toBeDisabled()", "percentage": 94, "note": "Works when button text is wrapped in nested elements"},
        {"solution": "Use toHaveAttribute() for disabled attribute: expect(getByText(/Click me/i).closest(''button'')).toHaveAttribute(''disabled'')", "percentage": 88, "note": "Alternative when toBeDisabled matcher unavailable"},
        {"solution": "Check disabled property directly: expect(getByText(''Click me'').closest(''button'').disabled).toBeTruthy()", "percentage": 82, "note": "Lower-level approach without matchers"},
        {"solution": "Query button element directly: expect(screen.getByRole(''button'', { name: /Click me/i })).toBeDisabled()", "percentage": 90, "note": "Most accessible approach"}
    ]'::jsonb,
    '@testing-library/react installed, @testing-library/jest-dom package for toBeDisabled() matcher, Jest configured, Rendered component with button element',
    'toBeDisabled() assertion passes, Button cannot be clicked by user, Attribute disabled or property disabled === true, Test validates user-facing disabled state',
    'Not using closest() to navigate from nested content to button element, Forgetting to install jest-dom when using toBeDisabled() matcher, Testing implementation details (onclick handlers) instead of disabled state, Using disabled as a class instead of HTML attribute, Attempting to test innerHTML or className for disabled state',
    0.92,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/56593840/check-that-button-is-disabled-in-react-testing-library'
),
(
    'How to mock react custom hook returned value?',
    'stackoverflow-testing-library',
    'HIGH',
    '[
        {"solution": "Use jest.mock() at file level with jest.spyOn() per test: jest.mock(''module_path/module_name'', () => ({ useCustomHook: () => [300, 200, jest.fn()] })); In test: jest.spyOn(hooks, ''useCustomHook'').mockImplementation(() => ([100, 200, jest.fn()]))", "percentage": 93, "note": "Allows both global mocks and test-specific overrides"},
        {"solution": "For TypeScript (Jest 27+), use jest.mocked() helper: const mockUseCustomHook = jest.mocked(useCustomHook); mockUseCustomHook.mockReturnValue([300, 200, () => {}])", "percentage": 90, "note": "Type-safe approach with full IDE support"},
        {"solution": "Place jest.mock() at top of test file outside test functions, use namespace import: import * as hooks from ''module_path''; jest.mock(''module_path'');", "percentage": 88, "note": "Critical placement rule - mocks must be hoisted"}
    ]'::jsonb,
    'Jest testing framework, Custom hook module that can be mocked, Understanding of module imports (named or namespace), Return value type matches actual hook',
    'Hook returns mocked values in test, Component receives mocked data, No module resolution errors, Hook implementation can be swapped per test',
    'Calling jest.mock() inside test functions instead of file level, Return type mismatch between mock and actual hook, Using default imports when namespace import required for spying, Not importing jest-dom for assertions on hook values, Forgetting to reset mocks between tests, Mocking at wrong module path',
    0.90,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/60270013/how-to-mock-react-custom-hook-returned-value'
),
(
    'Find element by id in react-testing-library',
    'stackoverflow-testing-library',
    'MEDIUM',
    '[
        {"solution": "Use container.querySelector() method: const result = render(<SomeComponent />); const someElement = result.container.querySelector(''#some-id'')", "percentage": 92, "note": "Most straightforward approach using native DOM API"},
        {"solution": "Create custom queryByAttribute helper: const getById = queryByAttribute.bind(null, ''id''); const dom = render(<App />); const table = getById(dom.container, ''directory-table'')", "percentage": 85, "note": "Reusable helper for multiple ID queries"},
        {"solution": "Use document.getElementById() on rendered container: document.getElementById(''firstinput'')", "percentage": 80, "note": "Native browser API, works but less RTL-idiomatic"}
    ]'::jsonb,
    'React Testing Library installed, Component rendered via render() function, Element must have id attribute, DOM container accessible',
    'querySelector returns element reference not null, Document.getElementById finds element, Element is accessible in DOM tree, getById custom query works consistently',
    'Using container.getElementById() - this method does not exist on HTMLElement, Attempting getById query - RTL does not provide this, Using ID queries for multiple elements when IDs must be unique, Relying on implementation detail (ID) instead of user-facing attributes (role, label, text), Forgetting that RTL philosophy discourages ID-based queries',
    0.88,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/53003594/find-element-by-id-in-react-testing-library'
),
(
    'How to query by text string which contains html tags using React Testing Library?',
    'stackoverflow-testing-library',
    'MEDIUM',
    '[
        {"solution": "Use custom matcher function with getByText that checks textContent: getByText((content, node) => { const hasText = (node) => node.textContent === ''Name: Bob (special guest)''; const childrenDontHaveText = Array.from(node.children).every(child => !hasText(child)); return hasText(node) && childrenDontHaveText; })", "percentage": 93, "note": "Most reliable for complex text with HTML tags"},
        {"solution": "Create reusable helper: const withMarkup = (query) => (text) => query((content, node) => { const hasText = node => node.textContent === text; const childrenDontHaveText = Array.from(node.children).every(child => !hasText(child)); return hasText(node) && childrenDontHaveText })", "percentage": 90, "note": "DRY approach for multiple tests"},
        {"solution": "Use substring matching with exact: false for partial text: getByText(''Name:'', { exact: false })", "percentage": 82, "note": "Simpler but matches broader than intended"},
        {"solution": "Use jest assertion on rendered text: expect(element).toHaveTextContent(''Name: Bob (special guest)'')", "percentage": 78, "note": "Works but searches entire element and children"}
    ]'::jsonb,
    'React Testing Library installed, Understanding of custom matcher functions, getByText/queryByText method available, Knowledge that getByText uses textContent not HTML parsing',
    'Custom matcher returns expected element, Assertion finds text correctly without false positives, Child elements with same text not incorrectly matched, No HTML parsing errors',
    'Forgetting to check that child elements don''t contain the same text (causes false matches on parent), Using exact string matching when text split across multiple elements, Not understanding getByText matches textContent at specific nodes not across all children, Attempting to match HTML structure instead of rendered text content, Confusion between textContent (what getByText uses) and innerHTML',
    0.86,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/55509875/how-to-query-by-text-string-which-contains-html-tags-using-react-testing-library'
),
(
    'When testing, code that causes React state updates should be wrapped into act',
    'stackoverflow-testing-library',
    'VERY_HIGH',
    '[
        {"solution": "Explicitly unmount components after test: const { getByTestId, unmount } = render(<MyApp/>); expect(getByTestId(''loading'')).toBeDefined(); unmount();", "percentage": 91, "note": "Prevents lingering state updates from triggering warning"},
        {"solution": "Use async queries with findByText which automatically wrap in act(): render(<TestApp/>); await screen.findByText(/expectedText/i);", "percentage": 92, "note": "Recommended for RTL - handles act() implicitly"},
        {"solution": "Wrap assertions in waitFor callback: await waitFor(() => { expect(getByTestId(''loading'')).toBeDefined(); });", "percentage": 88, "note": "Explicit act() wrapping for async operations"},
        {"solution": "Always await async operations and use findBy* instead of getBy* for data fetching", "percentage": 90, "note": "Fundamental pattern for async state updates"}
    ]'::jsonb,
    'React Testing Library installed, Jest or similar test runner, Components with async state updates, Understanding of async/await syntax',
    'No act() warnings in test output, All async operations complete before assertions, Test passes consistently, No cleanup warnings in logs',
    'Forgetting await when using async queries like findByText, Not unmounting components with unresolved async operations, Using getBy* instead of findBy* for elements that appear asynchronously, Not properly waiting for state updates, Mixing sync and async queries without proper awaiting, Ignoring cleanup() in afterEach hooks',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/56722139/when-testing-code-that-causes-react-state-updates-should-be-wrapped-into-act'
),
(
    'Best way to test input value in dom-testing-library or react-testing-library',
    'stackoverflow-testing-library',
    'HIGH',
    '[
        {"solution": "Use getByDisplayValue() to query by displayed value: expect(screen.getByDisplayValue(''test'')).toBeInTheDocument()", "percentage": 94, "note": "Queries input/textarea/select by what user sees displayed"},
        {"solution": "Use getByLabelText with toHaveValue() matcher: expect(screen.getByLabelText(''Name'')).toHaveValue(''hello'')", "percentage": 92, "note": "Most accessible - requires proper label association"},
        {"solution": "Use getByRole with accessible name and toHaveValue: expect(screen.getByRole(''textbox'', { name: ''label-text'' })).toHaveValue(''expected-value'')", "percentage": 90, "note": "Recommended for accessibility compliance"},
        {"solution": "Query by display value then verify attributes: expect(screen.getByDisplayValue(''test'')).toHaveAttribute(''id'', ''input-id'')", "percentage": 85, "note": "Combines display value with attribute verification"}
    ]'::jsonb,
    'jest-dom library installed for toHaveValue() matcher, React Testing Library installed, Input element properly associated with labels or accessible names, Rendered component with form inputs',
    'getByDisplayValue returns input element, toHaveValue assertion passes, Input value matches expected text, No DOM access errors or TypeScript failures',
    'Directly accessing .value property on HTMLElement (causes errors), Using closest() to manually navigate to input element, Relying on test IDs instead of semantic queries, Not using labels or accessible names for inputs, Confusing display value (rendered) with HTML value attribute, Testing implementation details instead of user-visible values',
    0.92,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/62473970/best-way-to-test-input-value-in-dom-testing-library-or-react-testing-library'
);
