-- Add ESLint documentation batch 1
-- DOC-MINER-36: ESLint config errors, rule violations, and plugin issues
-- Source: https://eslint.org/docs/latest/
-- Entries: 12

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'ESLint couldn''t find the config to extend from',
    'eslint',
    'HIGH',
    '[
        {"solution": "Run npm install or yarn install to install all dependencies including config packages", "percentage": 95, "note": "Most common cause - missing node_modules", "command": "npm install"},
        {"solution": "Verify the config package name is spelled correctly with correct casing (case-sensitive)", "percentage": 90, "note": "Common typo in extends array"},
        {"solution": "Add the config package as devDependency in package.json", "percentage": 85, "note": "For scoped packages use @org/eslint-config-name format", "command": "npm install --save-dev eslint-config-yourconfig"},
        {"solution": "Update all ESLint packages to latest versions", "percentage": 80, "command": "npm update eslint eslint-config-*"}
    ]'::jsonb,
    'Node.js and npm installed, Valid package.json in project root, Network access for package installation',
    'npm install completes without errors, ESLint runs without config extension errors, Config package appears in node_modules',
    'Config package names are case-sensitive. Shortened names like "airbnb" resolve to "eslint-config-airbnb". Scoped packages like "@org/name" resolve to "@org/eslint-config-name". Always run npm install after adding new extends.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/troubleshooting/couldnt-find-the-config'
),
(
    'ESLint couldn''t find the plugin',
    'eslint',
    'HIGH',
    '[
        {"solution": "Install the missing plugin package locally as devDependency", "percentage": 95, "note": "Plugins must be installed locally, not globally", "command": "npm install --save-dev eslint-plugin-name"},
        {"solution": "Run npm install to install all dependencies from package.json", "percentage": 90, "command": "npm install"},
        {"solution": "Verify plugin name spelling and casing in configuration - names are case-sensitive", "percentage": 85, "note": "eslint-plugin-name can be shortened to name in config"},
        {"solution": "Check that plugin is listed in devDependencies section of package.json", "percentage": 80},
        {"solution": "Update all ESLint packages to ensure compatibility", "percentage": 75, "command": "npm update eslint eslint-plugin-*"}
    ]'::jsonb,
    'Node.js and npm installed, Valid package.json, ESLint configuration file exists',
    'Plugin appears in node_modules/eslint-plugin-*, ESLint runs without plugin errors, Plugin rules are recognized',
    'Never install plugins globally - always use local devDependencies. Plugin shorthand "name" expands to "eslint-plugin-name". Scoped plugins "@org/name" expand to "@org/eslint-plugin-name". Must run npm install before running ESLint.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/troubleshooting/couldnt-find-the-plugin'
),
(
    'ESLint Definition for rule was not found',
    'eslint',
    'HIGH',
    '[
        {"solution": "Add the plugin to the plugins array in your ESLint config before using its rules", "percentage": 90, "note": "Plugin rules require plugin declaration", "command": "In config: plugins: [\"plugin-name\"]"},
        {"solution": "Verify the rule name is spelled correctly - check plugin documentation for exact name", "percentage": 85, "note": "Rule names are case-sensitive"},
        {"solution": "Prefix plugin rules with plugin name: plugin-name/rule-name", "percentage": 85, "note": "Built-in rules have no prefix, plugin rules need prefix"},
        {"solution": "Install the plugin package if not already installed", "percentage": 80, "command": "npm install --save-dev eslint-plugin-name"},
        {"solution": "Restart your IDE/editor to reload ESLint configuration", "percentage": 75, "note": "VSCode and other editors cache ESLint state"}
    ]'::jsonb,
    'ESLint installed, Configuration file exists, Plugin package installed if using plugin rules',
    'ESLint runs without rule not found errors, Rule violations appear correctly, No red underlines for rule definition',
    'Plugin rules must be prefixed with plugin name (e.g., react/jsx-uses-react). Built-in ESLint rules have no prefix. Must add plugin to plugins array before using its rules. Check plugin docs for correct rule names.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://github.com/eslint/eslint/issues/12146'
),
(
    'ESLint exit code 2 configuration problem or internal error',
    'eslint',
    'MEDIUM',
    '[
        {"solution": "Check ESLint config file syntax - look for JSON/YAML/JS syntax errors", "percentage": 90, "note": "Invalid config format causes exit code 2"},
        {"solution": "Verify all extends and plugins are installed and spelled correctly", "percentage": 85, "note": "Missing packages cause configuration failures"},
        {"solution": "Check for circular dependencies in extends chain", "percentage": 80, "note": "Config A extends B which extends A"},
        {"solution": "Validate globals configuration uses only readonly, writable, or off", "percentage": 75, "note": "Invalid global values cause config validation errors"},
        {"solution": "Use --exit-on-fatal-error flag to distinguish parsing errors from config errors", "percentage": 70, "command": "eslint --exit-on-fatal-error"}
    ]'::jsonb,
    'ESLint installed, Configuration file exists, Node.js installed',
    'ESLint exits with code 0 or 1 (not 2), No configuration error messages in output, Config file passes validation',
    'Exit code 2 means configuration/internal error, not linting errors. Exit code 1 means linting errors found. Exit code 0 means success. Check config file syntax carefully - even small typos cause exit code 2.',
    0.85,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/command-line-interface'
),
(
    'ESLint flat config migration parserOptions error eslintrc format',
    'eslint',
    'HIGH',
    '[
        {"solution": "Move parserOptions under languageOptions.parserOptions in flat config", "percentage": 95, "note": "Flat config requires nested structure", "command": "languageOptions: { parserOptions: {...} }"},
        {"solution": "Use npx @eslint/migrate-config to auto-migrate .eslintrc to flat config", "percentage": 90, "note": "Official migration tool", "command": "npx @eslint/migrate-config .eslintrc.json"},
        {"solution": "Update VSCode settings to enable flat config support", "percentage": 85, "note": "Add to settings.json", "command": "\"eslint.experimental.useFlatConfig\": true"},
        {"solution": "Move .eslintignore patterns to ignores property in eslint.config.js", "percentage": 85, "note": ".eslintignore deprecated in v9"},
        {"solution": "Check that plugins are updated for ESLint v9.x compatibility", "percentage": 80, "note": "Old plugins may cause TypeError: context.getScope is not a function"}
    ]'::jsonb,
    'ESLint v8.x or v9.x installed, Existing .eslintrc config file, Node.js with ES modules support or .mjs extension',
    'eslint.config.js file created, ESLint runs without format errors, No parserOptions nesting errors, VSCode shows ESLint errors',
    'Flat config is default since ESLint v9.0.0. parserOptions must be nested under languageOptions. .eslintignore file no longer supported - use ignores array. package.json config no longer supported. Must use eslint.config.js or .mjs.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/configure/migration-guide'
),
(
    'ESLint plugin TypeError context.getScope is not a function',
    'eslint',
    'MEDIUM',
    '[
        {"solution": "Update the plugin to latest version compatible with ESLint v9.x", "percentage": 90, "note": "Plugin needs ESLint v9 API updates", "command": "npm update eslint-plugin-name"},
        {"solution": "Check plugin GitHub for ESLint v9 compatibility status and upgrade path", "percentage": 85, "note": "Some plugins may not yet support v9"},
        {"solution": "Downgrade to ESLint v8.x if plugin is critical and not yet updated", "percentage": 75, "note": "Temporary workaround", "command": "npm install --save-dev eslint@8"},
        {"solution": "Remove the incompatible plugin from config until updated version available", "percentage": 70, "note": "If not critical to linting"}
    ]'::jsonb,
    'ESLint v9.x installed, Plugin from ESLint v8 era, Plugin using old rule API',
    'Plugin loads without TypeError, ESLint runs successfully, Plugin rules work correctly',
    'This error indicates plugin has not been updated for ESLint v9.x rule API changes. The rule API changed significantly in v9. Check plugin repository for update timeline. Not a configuration error - requires plugin update.',
    0.85,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/troubleshooting/'
),
(
    'ESLint peer dependency version mismatch ERESOLVE',
    'eslint',
    'MEDIUM',
    '[
        {"solution": "Use --legacy-peer-deps flag during npm install to bypass strict peer dependency checks", "percentage": 85, "note": "Works with npm 7.x and later", "command": "npm install --legacy-peer-deps"},
        {"solution": "Check peer dependencies of eslint-config package and install compatible versions", "percentage": 90, "note": "Use npm info to check", "command": "npm info eslint-config-standard peerDependencies"},
        {"solution": "Update all ESLint related packages to latest compatible versions", "percentage": 85, "command": "npm update eslint eslint-config-* eslint-plugin-*"},
        {"solution": "Remove node_modules and package-lock.json, then reinstall", "percentage": 80, "note": "Clean slate installation", "command": "rm -rf node_modules package-lock.json && npm install"},
        {"solution": "Use npm overrides in package.json to force specific peer dependency versions", "percentage": 75, "note": "npm 8.3.0+ feature"}
    ]'::jsonb,
    'npm 7.x or later, package.json with ESLint dependencies, Node.js installed',
    'npm install completes successfully, No peer dependency warnings, ESLint runs without errors',
    'npm 7.x is stricter about peer dependencies than npm 6.x. --legacy-peer-deps may cause compatibility issues in theory but widely used in practice. Always check peer dependency requirements before installing configs. eslint-config-standard requires specific versions of eslint, eslint-plugin-import, etc.',
    0.85,
    'sonnet-4',
    NOW(),
    'https://github.com/vuejs/eslint-plugin-vue/issues/1931'
),
(
    'ESLint globals configuration validation error invalid value',
    'eslint',
    'MEDIUM',
    '[
        {"solution": "Use only readonly, writable, or off as global variable values", "percentage": 95, "note": "ESLint 6.0+ strictly validates globals", "command": "globals: { myVar: \"readonly\" }"},
        {"solution": "Replace deprecated readable with readonly in globals config", "percentage": 90, "note": "readable is deprecated but still works"},
        {"solution": "Replace deprecated writeable with writable (correct spelling)", "percentage": 90, "note": "writeable was misspelled, use writable"},
        {"solution": "Replace boolean true with writable and false with readonly", "percentage": 85, "note": "Boolean values deprecated but still work for compatibility"}
    ]'::jsonb,
    'ESLint 6.0 or later, Configuration file with globals property',
    'ESLint config validates successfully, No globals validation errors, ESLint runs without errors',
    'ESLint 6.0+ strictly validates globals configuration - unknown values cause config errors. Only valid values: readonly, writable, off. For compatibility: false = readonly, true = writable, readable = readonly, writeable = writable. Use current naming.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/configure/language-options'
),
(
    'ESLint file ignored by default warning no files to lint',
    'eslint',
    'MEDIUM',
    '[
        {"solution": "Add --no-warn-ignored flag to suppress file ignored warnings", "percentage": 85, "note": "Warnings are informational", "command": "eslint . --no-warn-ignored"},
        {"solution": "Specify file patterns explicitly instead of using .", "percentage": 90, "note": "Target specific files", "command": "eslint \"src/**/*.js\""},
        {"solution": "Check .eslintignore or ignores property to ensure wanted files are not ignored", "percentage": 85, "note": "Files in node_modules, .git ignored by default"},
        {"solution": "Use --no-error-on-unmatched-pattern to prevent errors when no files match", "percentage": 80, "command": "eslint . --no-error-on-unmatched-pattern"}
    ]'::jsonb,
    'ESLint installed, Files exist in target directory',
    'ESLint processes target files, No file ignored warnings if desired, Linting results appear',
    'Files ignored by default include: node_modules/**, .git/**, files starting with dot (.), and files in ignored directories. Warnings are informational and do not affect exit code. Use --no-warn-ignored to suppress.',
    0.85,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/command-line-interface'
),
(
    'ESLint --fix command failed with exit code 2 configuration error',
    'eslint',
    'MEDIUM',
    '[
        {"solution": "Do not use --fix with stdin input - write to file first", "percentage": 90, "note": "--fix requires file system access", "command": "Write code to file, then: eslint --fix file.js"},
        {"solution": "Check if processor is blocking auto-fixes - not all processors support --fix", "percentage": 85, "note": "Processors must explicitly allow autofixes"},
        {"solution": "Verify no configuration errors exist - run eslint without --fix first", "percentage": 80, "command": "eslint file.js"},
        {"solution": "Check for circular fix errors - some rule combinations create infinite loops", "percentage": 75, "note": "ESLint detects and reports circular fixes"}
    ]'::jsonb,
    'ESLint installed with fixable rules enabled, Valid configuration file, Target files exist',
    'ESLint --fix completes successfully, Files are modified with fixes, Exit code 0 or 1 (not 2)',
    '--fix throws errors when code comes from stdin. --fix has no effect with processors unless processor explicitly allows autofixes. Exit code 2 indicates config/internal error, not linting errors. Check config first before using --fix.',
    0.85,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/command-line-interface'
),
(
    'ESLint --max-warnings exceeded exit code 1',
    'eslint',
    'LOW',
    '[
        {"solution": "Fix the warnings reported by ESLint to get under the threshold", "percentage": 95, "note": "Best practice - address actual warnings"},
        {"solution": "Increase --max-warnings value if current threshold is too strict", "percentage": 80, "note": "Temporary measure", "command": "eslint --max-warnings 20"},
        {"solution": "Change warning rules to off or error severity in config", "percentage": 75, "note": "Adjust rule severity as needed"},
        {"solution": "Use --quiet flag to suppress warnings and only show errors", "percentage": 70, "note": "Hides warnings from output but doesn''t fix them", "command": "eslint --quiet"}
    ]'::jsonb,
    'ESLint installed, --max-warnings flag set, Code with warnings',
    'Warning count is at or below --max-warnings threshold, Exit code is 0 when no errors and warnings under limit',
    '--max-warnings 0 treats any warning as failure. Useful for CI/CD strict enforcement. Exit code 1 when warnings exceed limit even if no errors. --quiet suppresses warning output but --max-warnings still counts them.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/command-line-interface'
),
(
    'ESLint parsing error unexpected token',
    'eslint',
    'HIGH',
    '[
        {"solution": "Install and configure appropriate parser for your syntax (Babel for JSX, TypeScript for TS)", "percentage": 90, "note": "Default Espree parser has limited syntax support", "command": "npm install --save-dev @babel/eslint-parser"},
        {"solution": "Add parser to config: parser: @babel/eslint-parser or @typescript-eslint/parser", "percentage": 90, "note": "In flat config use languageOptions.parser"},
        {"solution": "Set parserOptions.ecmaVersion to latest or specific version needed", "percentage": 85, "note": "Enables modern JavaScript features", "command": "parserOptions: { ecmaVersion: \"latest\" }"},
        {"solution": "Enable JSX parsing with parserOptions.ecmaFeatures.jsx: true", "percentage": 85, "note": "Required for React JSX syntax"},
        {"solution": "Use --exit-on-fatal-error to get exit code 2 for parsing errors", "percentage": 70, "note": "Distinguishes parse errors from lint errors", "command": "eslint --exit-on-fatal-error"}
    ]'::jsonb,
    'ESLint installed, Files with modern JavaScript/JSX/TypeScript syntax, Node.js installed',
    'No parsing errors reported, ESLint successfully analyzes files, Syntax is recognized correctly',
    'Default Espree parser does not support JSX or TypeScript. Parsing errors are fatal but return exit code 1 unless --exit-on-fatal-error is used. Must install parser package separately. For TypeScript use @typescript-eslint/parser, for JSX use @babel/eslint-parser.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://eslint.org/docs/latest/use/configure/parser'
);
