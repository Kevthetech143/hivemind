-- Add Vue 2->3 migration guide entries to knowledge base
-- Extracted from: https://v3-migration.vuejs.org/

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'Vue 2->3: v-model breaking changes - prop and event names changed',
    'migration-guide',
    'VERY_HIGH',
    '[
        {"solution": "Replace value prop with modelValue and input event with update:modelValue. Change prop from `value: String` to `modelValue: String` and emit from `this.$emit(''input'', value)` to `this.$emit(''update:modelValue'', value)`", "percentage": 95, "note": "Core breaking change affecting all components using v-model"},
        {"solution": "Update parent component syntax from `v-model` to `v-model:modelValue` or just `v-model` which defaults to modelValue", "percentage": 90, "note": "Shorthand still works if using default modelValue"},
        {"solution": "Remove .sync modifier and replace with v-model arguments: change `v-bind:title.sync` to `v-model:title`", "percentage": 95, "note": ".sync is completely removed in Vue 3"}
    ]'::jsonb,
    'Vue 2 component using v-model or .sync modifier',
    'Component accepts v-model binding without warnings, $emit updates parent state, devtools show proper model binding',
    'Forgetting to rename both the prop AND the emitted event. Mixing old .sync syntax with new v-model:prop syntax in same component. Not declaring emits option.',
    0.92,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/v-model.html'
),
(
    'Vue 2->3: Multiple v-model bindings now supported - new capability',
    'migration-guide',
    'HIGH',
    '[
        {"solution": "Define multiple props with modelValue pattern: `v-model:title` and `v-model:content` both on same component", "percentage": 95, "note": "Vue 3 enables pattern impossible in Vue 2 with .sync"},
        {"solution": "Declare all emits in emits option: emits: [''update:title'', ''update:content'']", "percentage": 90, "note": "Required for proper event handling"},
        {"solution": "In parent: <ChildComponent v-model:title=\"title\" v-model:content=\"content\" />", "percentage": 95, "note": "Clean, declarative syntax replaces multiple .sync modifiers"}
    ]'::jsonb,
    'Vue 3 app, component with multiple reactive values',
    'Multiple v-model bindings work independently without conflicts, parent state updates correctly for each binding',
    'Trying to use multiple v-models on same prop name. Forgetting to declare all modified events in emits. Confusion with custom modifiers vs multiple models.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/v-model.html'
),
(
    'Vue 2->3: Filters removed completely - use methods or computed properties',
    'migration-guide',
    'HIGH',
    '[
        {"solution": "Replace Vue 2 filters with computed properties: change {{ message | uppercase }} to computed method returning message.toUpperCase()", "percentage": 95, "note": "Computed properties offer reactivity and better performance"},
        {"solution": "For complex transformations use methods: change {{ date | formatDate }} to methods calling a format function", "percentage": 85, "note": "Methods work but lose reactivity benefits of computed"},
        {"solution": "Use global function utilities or helper libraries for shared transformations instead of global Vue.filter()", "percentage": 80, "note": "Encourages better code organization than global filters"}
    ]'::jsonb,
    'Vue 2 app using filters in templates',
    'Template renders correctly without filter syntax, computed properties reactively update when dependencies change, no console warnings',
    'Forgetting that filters were removed entirely (not just renamed). Using global Vue.filter() which no longer exists. Expecting filters to work like Vue 2 in computed properties.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/'
),
(
    'Vue 2->3: $listeners removed - merged into $attrs',
    'migration-guide',
    'HIGH',
    '[
        {"solution": "Replace `v-on=\"$listeners\"` with `v-on=\"$attrs\"` in component templates", "percentage": 95, "note": "Direct replacement as $listeners merged into $attrs"},
        {"solution": "Remove .native modifier from parent listeners - all listeners now automatically apply to root component: change `<component @click.native>` to `<component @click>`", "percentage": 90, "note": ".native modifier no longer needed or supported"},
        {"solution": "If forwarding listeners to child component, use $attrs: `<child-component v-on=\"$attrs\" :class=\"$attrs.class\" :style=\"$attrs.style\" />`", "percentage": 85, "note": "$attrs now includes class and style"}
    ]'::jsonb,
    'Vue 2 component using $listeners or .native modifier',
    'Event listeners properly forwarded without .native modifier, attributes and classes apply to intended elements, no console errors',
    'Trying to use $listeners which no longer exists. Forgetting .native modifier is removed. Not realizing $attrs now includes class/style (could cause conflicts).',
    0.88,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/'
),
(
    'Vue 2->3: Instance event methods $on, $off, $once removed - use external event emitter',
    'migration-guide',
    'HIGH',
    '[
        {"solution": "Replace Vue 2 event bus pattern with external library mitt: npm install mitt, then import mitt from ''mitt'', create event bus with mitt()", "percentage": 95, "note": "Recommended official approach, lightweight"},
        {"solution": "Use Provide/Inject pattern for long-distance component communication instead of global event bus", "percentage": 85, "note": "More idiomatic Vue 3, prevents prop drilling"},
        {"solution": "For parent-child communication, use props and emits instead of event bus: pass data via props, emit events back to parent", "percentage": 90, "note": "Cleaner than event bus for direct relationships"}
    ]'::jsonb,
    'Vue 2 app using event bus ($on/$off/$once) or component instances for events',
    'Events emit and listen correctly via mitt or alternative pattern, data syncs between components, no undefined method errors',
    'Expecting $on/$off to exist (they are removed). Using event bus as main communication pattern (discourages better Vue 3 patterns). Not realizing provide/inject is now preferred for deep component trees.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/events-api.html'
),
(
    'Vue 2->3: Functional components restructured - no functional attribute',
    'migration-guide',
    'MEDIUM',
    '[
        {"solution": "Remove `functional` attribute from <template> tag and { functional: true } from component config", "percentage": 95, "note": "Attribute and option no longer supported"},
        {"solution": "For function-based render, import h from Vue: `import { h } from ''vue''` (no longer implicit), accept (props, context) parameters, access context.attrs/slots/emit", "percentage": 90, "note": "Explicit h import required, context object replaces multiple params"},
        {"solution": "In SFC, remove functional attribute and use normal component lifecycle. Performance gains no longer apply (negligible in Vue 3)", "percentage": 85, "note": "Vue 3 optimized, stateful components have same perf"}
    ]'::jsonb,
    'Vue 2 functional components or SFCs with functional attribute',
    'Components render without errors, attributes properly forwarded, slots display correctly, no template compilation warnings',
    'Trying to use functional attribute which is completely removed. Forgetting h import in render functions. Not realizing functional components have no perf advantage in Vue 3. Confusing functional with stateless.',
    0.87,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/functional-components.html'
),
(
    'Vue 2->3: emits option required - declare emitted events',
    'migration-guide',
    'VERY_HIGH',
    '[
        {"solution": "Add emits option declaring all events: emits: [''accepted'', ''rejected''] or emits: { accepted: null, rejected: null } with validation", "percentage": 95, "note": "Critical to prevent event duplication and clarify component API"},
        {"solution": "For components without explicit emits, undeclared listeners fall into $attrs and bind to root element, potentially duplicating native events", "percentage": 90, "note": "Can cause events firing twice if not declared"},
        {"solution": "Use object format for event validation: emits: { accepted: (value) => typeof value === ''string'' } to validate emitted data", "percentage": 80, "note": "Optional but recommended for robustness"}
    ]'::jsonb,
    'Vue 3 component emitting events to parent',
    'emits option present in component definition, events emit only once, devtools show declared events, parent listeners work correctly',
    'Forgetting to declare emits (causes undeclared listeners to bind to root). Not realizing this prevents duplicate events. Using emits but inconsistent with actual $emit calls.',
    0.94,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/emits-option.html'
),
(
    'Vue 2->3: Global API restructured - use createApp instance instead of global Vue',
    'migration-guide',
    'VERY_HIGH',
    '[
        {"solution": "Replace global Vue object with createApp instance: change `Vue.component()` to `app.component()`, `Vue.use()` to `app.use()`, `Vue.mixin()` to `app.mixin()`", "percentage": 95, "note": "All global APIs moved to app instance"},
        {"solution": "Replace `Vue.prototype` with `app.config.globalProperties`: change `Vue.prototype.$myMethod` to `app.config.globalProperties.$myMethod = () => {}`", "percentage": 95, "note": "Direct replacement pattern"},
        {"solution": "Create app instance at entry point: `const app = createApp(App); app.use(router); app.mount(''#app'')`", "percentage": 90, "note": "Required structural change"}
    ]'::jsonb,
    'Vue 2 app with global Vue configuration and setup',
    'App initializes with createApp, components load without errors, global properties accessible, multiple app instances don''t conflict',
    'Using global Vue object which no longer exists. Forgetting to call app.mount(). Assuming global config affects all apps (each app instance is isolated). Not tree-shaking unused APIs.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/global-api.html'
),
(
    'Vue 2->3: Lifecycle hooks renamed - destroyed->beforeUnmount, beforeDestroy->unmounted',
    'migration-guide',
    'HIGH',
    '[
        {"solution": "Rename lifecycle hooks: `beforeDestroy` -> `beforeUnmount`, `destroyed` -> `unmounted`", "percentage": 95, "note": "Direct renames for component teardown"},
        {"solution": "Rename hook event prefix: `hook:destroyed` -> `vnode-unmounted` in parent listeners", "percentage": 85, "note": "Less common but important for hook-based communication"},
        {"solution": "All other lifecycle hooks remain similar: created->setup, mounted->mounted, updated->updated, beforeCreate removed (use setup instead)", "percentage": 90, "note": "Setup replaces beforeCreate/created, most hooks stay same"}
    ]'::jsonb,
    'Vue 2 component with destroyed/beforeDestroy hooks or hook:destroyed listeners',
    'Lifecycle hooks fire at correct times, component cleanup executes, parent hook listeners work, no undefined hook warnings',
    'Confusing beforeDestroy (parent cleanup) with beforeUnmount (component cleanup). Using old hook names. Forgetting about vnode- prefix change for hook events.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/'
),
(
    'Vue 2->3: Composition API - new option for organizing component logic',
    'migration-guide',
    'MEDIUM',
    '[
        {"solution": "Import Composition API functions (ref, reactive, computed, onMounted, etc.) and use in setup() function: `import { ref, computed } from ''vue''`", "percentage": 90, "note": "Replaces data/methods/computed options, better for large components"},
        {"solution": "Use <script setup> syntax sugar for cleaner code: declare refs/functions directly without wrapping in setup function", "percentage": 85, "note": "Modern recommended syntax, less boilerplate"},
        {"solution": "Composition API groups related logic together (vs Options API scattering), improves reusability via composable functions", "percentage": 80, "note": "Architectural benefit, not required"}
    ]'::jsonb,
    'Vue 3 app, component with complex logic scattered across options',
    'Setup function executes, refs and computed properties reactive, component renders correctly, logic properly scoped',
    'Mixing Composition API with Options API improperly. Using setup without understanding ref vs reactive. Forgetting that setup() is called once (not per instance). Not realizing <script setup> is syntax sugar.',
    0.82,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/'
),
(
    'Vue 2->3: Teleport component - render content to different DOM location',
    'migration-guide',
    'MEDIUM',
    '[
        {"solution": "Use <Teleport to=\"#portal-target\"> wrapper to render component contents to different DOM element: `<Teleport to=\"body\"><Modal /></Teleport>`", "percentage": 95, "note": "New Vue 3 feature, replaces manual portal patterns"},
        {"solution": "Teleport target can be any selector string or DOM element, typically used for modals/overlays/tooltips", "percentage": 90, "note": "Helps escape CSS stacking context issues"},
        {"solution": "Can have multiple teleports targeting same element, they render in order, can conditionally disable with disabled prop", "percentage": 80, "note": "Flexible but requires understanding CSS context"}
    ]'::jsonb,
    'Vue 3 app with modals or overlays nested in component tree',
    'Teleported content renders outside component tree at target location, z-index works correctly, styling independent from parent',
    'Trying to use Teleport in Vue 2 (not available). Teleporting to selector that doesn''t exist. Using Teleport without understanding CSS context problems it solves. Nested Teleports causing confusion.',
    0.85,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/'
),
(
    'Vue 2->3: Fragments support - components can have multiple root elements',
    'migration-guide',
    'MEDIUM',
    '[
        {"solution": "Remove wrapper <div> when component has multiple root elements - Vue 3 allows multiple roots in templates", "percentage": 95, "note": "No longer need artificial parent element"},
        {"solution": "When component has multiple roots, attributes distribute to all roots (can cause issues with class/style)", "percentage": 85, "note": "Be explicit about where attributes go if needed"},
        {"solution": "Multiple root elements common in templates: <template><div>item1</div><div>item2</div></template>", "percentage": 90, "note": "Clean, idiomatic Vue 3 pattern"}
    ]'::jsonb,
    'Vue 2 component or template with wrapper div around multiple elements',
    'Multiple root elements render correctly without wrapper, attributes apply appropriately, no compilation warnings',
    'Forgetting fragments are allowed and still wrapping unnecessarily. Not understanding attribute distribution to multiple roots. Assuming fragments work in Vue 2 (they don''t).',
    0.84,
    'sonnet-4',
    NOW(),
    'https://v3-migration.vuejs.org/breaking-changes/'
);
