INSERT INTO knowledge_entries (query, category, hit_frequency, solutions, prerequisites, success_indicators, common_pitfalls, success_rate, claude_version, last_verified, source_url, contributor_email) VALUES
('Custom exception handling with HTTPException and app.add_exception_handler', 'fastapi', 'HIGH', '[{"solution": "Define custom exception class inheriting from HTTPException, use @app.exception_handler decorator to create handler that accesses exc.detail and exc.status_code", "percentage": 92}, {"solution": "Pass custom attributes to exception class like MyException(status_code=404, detail=error_msg) for flexible error handling", "percentage": 88}]'::jsonb, 'FastAPI basics, exception handling concepts', 'Custom error responses returned with correct status codes', 'Forgetting to raise exception vs return it, not accessing correct exception attributes', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/72831952/how-do-i-integrate-custom-exception-handling-with-the-fastapi-exception-handling', 'admin:1764210320'),
('Format FastAPI validation errors into human-readable messages for forms', 'fastapi', 'HIGH', '[{"solution": "Override RequestValidationError handler with @app.exception_handler(RequestValidationError) to transform exc.errors() into readable field:message format", "percentage": 94}, {"solution": "Use defaultdict to group field errors by location, remove loc[0] (body/query/path), use dot-notation for nested fields", "percentage": 89}]'::jsonb, 'Pydantic ValidationError, JSON response handling', 'Validation errors displayed as readable field-specific messages', 'Not filtering location tuple properly, not handling nested fields with dots', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/58642528/displaying-of-fastapi-validation-errors-to-end-users', 'admin:1764210320'),
('Customize error response in FastAPI with RequestValidationError handler', 'fastapi', 'HIGH', '[{"solution": "Create @app.exception_handler(RequestValidationError) to catch 422 validation errors and return custom JSON structure like {error: {message: msg}}", "percentage": 93}, {"solution": "Use jsonable_encoder to safely serialize exception details, modify content dict before JSONResponse", "percentage": 87}]'::jsonb, 'JSON handling, exception handlers', 'Custom error JSON returned instead of default detail array', 'Returning HTTPException instead of raising it, not using jsonable_encoder for JSON serialization', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/70952692/how-to-customize-error-response-in-fastapi', 'admin:1764210320'),
('Use HTTPException in OpenAPI responses parameter with custom Pydantic model', 'fastapi', 'HIGH', '[{"solution": "Create custom Pydantic BaseModel like HTTPError(BaseModel) with detail: str, use as responses={409: {model: HTTPError}} in decorator", "percentage": 95}, {"solution": "Add schema_extra Config to model to show example in OpenAPI docs", "percentage": 91}]'::jsonb, 'Pydantic models, OpenAPI integration', 'OpenAPI docs show custom error response model and example', 'Using HTTPException directly in responses (not valid), forgetting to add Config.schema_extra', 0.93, 'haiku', NOW(), 'https://stackoverflow.com/questions/64501193/fastapi-how-to-use-httpexception-in-responses', 'admin:1764210320'),
('Handle Starlette HTTPException globally without middleware catching first', 'fastapi', 'HIGH', '[{"solution": "Import from starlette.exceptions import HTTPException as StarletteHTTPException and register handler with @app.exception_handler(StarletteHTTPException)", "percentage": 96}, {"solution": "Combine @app.exception_handler for Starlette exceptions + @app.middleware for generic Exception fallback handling", "percentage": 90}]'::jsonb, 'Starlette internals, exception hierarchy', 'All HTTPException types handled in single place without middleware interference', 'Confusing FastAPI HTTPException with Starlette HTTPException, middleware preventing handler execution', 0.92, 'haiku', NOW(), 'https://stackoverflow.com/questions/78297309/how-to-force-all-exceptions-to-go-through-a-fastapi-middleware', 'admin:1764210320'),
('Update OpenAPI documentation after customizing validation error handler', 'fastapi', 'HIGH', '[{"solution": "Define custom_openapi() function, call get_openapi() to get schema dict, delete responses[422] from path definitions, assign back to app.openapi_schema", "percentage": 91}, {"solution": "Assign custom_openapi function to app.openapi property to override default generation", "percentage": 88}]'::jsonb, 'OpenAPI schema manipulation, dict operations', 'OpenAPI docs reflect custom error codes and formats', 'Not returning app.openapi_schema at end of function, deleting wrong path level, using app.openapi_schema before assignment', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/61101878/fastapi-custom-error-handling-broke-automatic-documentation', 'admin:1764210320'),
('HTTPException detail not reaching frontend client in Vue/JavaScript', 'fastapi', 'HIGH', '[{"solution": "Access error detail through err.response.data.detail in axios/fetch response handler, not just err.response.data", "percentage": 94}, {"solution": "Log entire error object err to console to inspect response structure and locate detail field", "percentage": 92}]'::jsonb, 'HTTP client libraries, Vue.js/JavaScript', 'Frontend receives and displays HTTPException detail message properly', 'Not recognizing middle data layer in response object, logging wrong level of error object', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/62854314/fastapi-cannot-get-error-handling-to-work-as-expected', 'admin:1764210320'),
('Catch all unhandled exceptions globally in FastAPI', 'fastapi', 'HIGH', '[{"solution": "Use @app.exception_handler(Exception) to catch all exceptions, but set debug=False in FastAPI() to allow handler execution", "percentage": 89}, {"solution": "Use @app.middleware(http) with try-except around call_next() as fallback for exceptions not caught by handlers", "percentage": 85}]'::jsonb, 'Global exception handling, middleware, debug mode', 'All unhandled exceptions logged and converted to 500 responses', 'debug=True prevents exception handler execution, middleware running after handlers', 0.86, 'haiku', NOW(), 'https://stackoverflow.com/questions/61596911/catch-exception-globally-in-fastapi', 'admin:1764210320'),
('Raise ValueError in Pydantic validator without Internal Server Error', 'fastapi', 'HIGH', '[{"solution": "Validators can raise ValueError, TypeError, or AssertionError which Pydantic converts to ValidationError (422 response)", "percentage": 93}, {"solution": "Register @app.exception_handler(ValueError) to convert ValueError to 400 JSONResponse, or use constrained types like conint(ge=0, le=1000000)", "percentage": 91}]'::jsonb, 'Pydantic validators, error status codes', 'Validation errors return 422 with proper error details or custom 400 response', 'Raising generic Exception instead of ValueError, forgetting exception handler registration', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/68914523/fastapi-pydantic-value-error-raises-internal-server-error', 'admin:1764210320'),
('Change default Pydantic validation error messages in FastAPI', 'fastapi', 'HIGH', '[{"solution": "Override RequestValidationError handler to modify error dicts, use conint/constr constraints instead of custom validators when possible", "percentage": 87}, {"solution": "Use custom validator that raises ValueError with message, or modify error[msg] field in exception handler before JSONResponse", "percentage": 85}]'::jsonb, 'Pydantic constraints, validation error modification', 'Custom validation messages displayed in API responses and Swagger docs', 'Modifying wrong field (use msg not message), not re-raising exception handler', 0.83, 'haiku', NOW(), 'https://stackoverflow.com/questions/71895606/how-to-change-the-default-pydantic-error-message-using-fastapi', 'admin:1764210320');
