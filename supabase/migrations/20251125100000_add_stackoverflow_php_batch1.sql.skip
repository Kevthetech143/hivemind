-- Mine Stack Overflow top voted PHP questions and answers
-- Category: stackoverflow-php
-- Source: https://stackoverflow.com/questions/tagged/php?tab=votes

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'How can I prevent SQL injection in PHP?',
    'stackoverflow-php',
    'VERY_HIGH',
    '[
        {"solution": "Use prepared statements with PDO: $stmt = $pdo->prepare(''SELECT * FROM users WHERE name = :name''); $stmt->execute([''name'' => $name]);", "percentage": 95, "note": "Most secure and recommended approach"},
        {"solution": "Use MySQLi prepared statements: $stmt = $db->prepare(''SELECT * FROM users WHERE name = ?''); $stmt->bind_param(''s'', $name); $stmt->execute();", "percentage": 90, "note": "Alternative using MySQLi extension"},
        {"solution": "Disable PDO emulated prepared statements: $pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);", "percentage": 88, "note": "Critical configuration for PDO with MySQL"},
        {"solution": "Use whitelist validation for dynamic SQL structure (table/field names) since parameterization cannot be used for schema elements", "percentage": 75, "note": "Only for dynamic query parts"}
    ]'::jsonb,
    'PDO or MySQLi installed, Database connection established, Valid user input to parameterize',
    'Malicious input like: value''); DROP TABLE table;-- is safely treated as literal string data, not executable SQL',
    'Never trust user input. Manually escaping with mysql_real_escape_string() is insufficient. Always use prepared statements. Never try to parameterize table names or column names - use whitelist validation instead.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/60174/how-can-i-prevent-sql-injection-in-php'
),
(
    'Why shouldn''t I use mysql_* functions in PHP?',
    'stackoverflow-php',
    'VERY_HIGH',
    '[
        {"solution": "Migrate to PDO (PHP Data Objects) for modern database abstraction with prepared statements support", "percentage": 90, "note": "Recommended primary alternative"},
        {"solution": "Use MySQLi extension instead for MySQL-specific operations with procedural or OOP interface", "percentage": 85, "note": "Direct MySQL alternative"},
        {"solution": "Understand that mysql_* functions were deprecated in PHP 5.5 and completely removed in PHP 7.0", "percentage": 95, "note": "Already unavailable in all currently supported PHP versions"}
    ]'::jsonb,
    'PHP 7.0+ environment, Existing mysql_* code to migrate, Database server access',
    'Successfully execute database queries without deprecation warnings, Code works on PHP 7.0+, No "undefined function" errors',
    'mysql_* functions lack prepared statements making SQL injection prevention difficult. Manually escaping with mysql_real_escape_string() is error-prone. The extension receives no maintenance and has no OOP interface. PDO or MySQLi are required for modern PHP.',
    0.98,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/12859942/why-shouldnt-i-use-mysql-functions-in-php'
),
(
    'Deleting an element from an array in PHP',
    'stackoverflow-php',
    'HIGH',
    '[
        {"solution": "Use unset() for single element: unset($array[$key]); Then optionally reindex with array_values($array);", "percentage": 90, "note": "Standard approach, preserves keys unless reindexed"},
        {"solution": "Use array_splice() for automatic reindexing: array_splice($array, $offset, 1);", "percentage": 85, "note": "Requires offset position, not the key"},
        {"solution": "Use array_filter() to remove by value: $array = array_filter($array, fn($e) => $e !== \"value_to_remove\");", "percentage": 80, "note": "Best for removing multiple values by condition"},
        {"solution": "Use array_diff_key() to remove specific keys while preserving other keys", "percentage": 75, "note": "For removing multiple elements by key"}
    ]'::jsonb,
    'Valid PHP array, Key or offset value to remove, Understanding of desired key preservation behavior',
    'Element no longer exists in array when accessed, Desired indexing maintained (numeric or associative keys as needed)',
    'Setting element to null does not remove it - the key still exists. Use unset() or array_splice() for true deletion. Be aware that unset() preserves non-numeric keys but may create gaps in numeric keys.',
    0.92,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/369602/deleting-an-element-from-an-array-in-php'
),
(
    'How do I check if a string contains a specific word in PHP?',
    'stackoverflow-php',
    'HIGH',
    '[
        {"solution": "Use str_contains() for PHP 8+: if (str_contains($haystack, $needle)) { ... }", "percentage": 95, "note": "Modern, readable approach available in PHP 8.0+"},
        {"solution": "Use strpos() for earlier PHP versions: if (strpos($haystack, $needle) !== false) { ... }", "percentage": 90, "note": "Critical: must use !== false, not != false or === true"},
        {"solution": "For whole-word matching use regex with word boundaries: if (preg_match(''/\\b'' . preg_quote($needle, ''/'') . ''\\b/'', $haystack)) { ... }", "percentage": 75, "note": "Substring matching alone will match partial words"}
    ]'::jsonb,
    'PHP 8+ for str_contains(), or PHP 7.0+ for strpos() approach, Valid strings for both parameters',
    'Function returns true/false appropriately, Substring or whole word is located as intended, Edge case of empty substring handled (returns true)',
    'strpos() returns false (not true) when substring not found, and returns 0 (integer) when found at position 0. Using == or === true will produce incorrect results. str_contains() finds substrings, not whole words - use regex for word boundaries.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/4366730/how-do-i-check-if-a-string-contains-a-specific-word'
),
(
    'How do you parse and process HTML/XML in PHP?',
    'stackoverflow-php',
    'HIGH',
    '[
        {"solution": "Use the DOM extension (built-in native extension): $dom = new DOMDocument(); $dom->load($file);", "percentage": 92, "note": "W3C-compliant, built on libxml, handles both HTML and XML"},
        {"solution": "Use XMLReader for pull-based parsing of large files: $reader = new XMLReader(); $reader->open($file);", "percentage": 75, "note": "More memory-efficient for large documents"},
        {"solution": "Use SimpleXML for valid XHTML only: $xml = simplexml_load_file($file);", "percentage": 70, "note": "Simpler API but limited to well-formed XML"},
        {"solution": "For broken HTML, wrap with: libxml_use_internal_errors(true); before DOM parsing to suppress warnings", "percentage": 80, "note": "DOM can struggle with invalid HTML"}
    ]'::jsonb,
    'libxml2 library (usually included), HTML or XML file to parse, Understanding of desired query approach',
    'DOM structure successfully loaded, Elements and attributes accessible through standard DOM API, XPath queries execute without errors',
    'Never use regex to parse HTML/XML - the brittleness will cause maintenance headaches. DOM is preferred over third-party libraries for performance. For HTML5 specifically, dedicated HTML5 parsers may be needed. Always handle errors with libxml_use_internal_errors() when parsing user input.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/3577641/how-do-you-parse-and-process-html-xml-in-php'
),
(
    'How does PHP ''foreach'' actually work internally?',
    'stackoverflow-php',
    'MEDIUM',
    '[
        {"solution": "In PHP 7+: foreach() creates external hashtable iterators independent of the internal array pointer. Modifications during iteration work on original elements.", "percentage": 90, "note": "Modern behavior, very different from PHP 5"},
        {"solution": "In PHP 5: foreach() uses copy-on-write with backup HashPointer. Modifications trigger array duplication while iteration continues on originals.", "percentage": 75, "note": "Historical behavior for legacy code understanding"},
        {"solution": "foreach() by-value iterates on original array state when array is not already a reference. By-reference iteration maintains pointer position.", "percentage": 85, "note": "Reference vs value semantics critical for understanding"}
    ]'::jsonb,
    'Understanding of PHP version in use (5 vs 7+), Arrays to iterate, Knowledge of reference behavior desired',
    'Loop executes predictably across array modifications, Expected elements processed in correct order, Reference behavior matches expectations',
    'Avoid relying on the internal array pointer (IAP) behavior within foreach loops. In PHP 5, understanding copy-on-write is important for performance. reset(), current(), next() functions operate independently from foreach() iteration state in PHP 7+.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/10057671/how-does-php-foreach-actually-work'
),
(
    'When should I use ''self'' over ''$this'' in PHP?',
    'stackoverflow-php',
    'MEDIUM',
    '[
        {"solution": "Use $this to reference the current object instance for accessing instance properties and methods: $this->property and $this->method()", "percentage": 95, "note": "Enables polymorphism - child overrides are respected"},
        {"solution": "Use self to reference the current class itself for accessing static properties and methods: self::$staticProperty and self::staticMethod()", "percentage": 92, "note": "Bypasses virtual method table, always calls current class implementation"},
        {"solution": "Modern PHP: Use static:: instead of self:: for static method calls in inheritance to enable late static binding", "percentage": 85, "note": "PHP 5.3+ feature for more predictable inheritance behavior"}
    ]'::jsonb,
    'Object-oriented PHP code, Class definitions with inheritance, Understanding of instance vs class-level members',
    '$this accesses instance-specific data, self and static:: correctly resolve methods and properties, Polymorphism works as intended with $this, late static binding works with static::',
    'Confusing $this with self causes method resolution problems. self:: calls the class where it''s written, not the called class. Use $this-> by default for methods to enable proper polymorphism. Use self:: or static:: only for actual static members.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/151969/when-should-i-use-self-over-this'
),
(
    'How do I get PHP errors to display?',
    'stackoverflow-php',
    'HIGH',
    '[
        {"solution": "In code, add: ini_set(''display_errors'', ''1''); ini_set(''display_startup_errors'', ''1''); error_reporting(E_ALL);", "percentage": 85, "note": "Works for runtime errors but not parse errors in the same file"},
        {"solution": "In php.ini, set: display_errors = on error_reporting = E_ALL then restart web server", "percentage": 92, "note": "Catches parse errors that ini_set() in code cannot"},
        {"solution": "In .htaccess (if php.ini access unavailable): php_flag display_errors 1", "percentage": 75, "note": "Fallback option for shared hosting"},
        {"solution": "For debugging AJAX: use browser DevTools (F12) Network tab to inspect Response for server-side errors", "percentage": 80, "note": "Essential for async request troubleshooting"}
    ]'::jsonb,
    'PHP installation access, Web server restart capability (for php.ini changes), Development environment (not production)',
    'PHP errors display in browser output, Parse errors visible in error log or browser output, AJAX responses show full error details in DevTools',
    'Never display errors on production - it exposes sensitive information. Always use display_errors = off and log_errors = on in production. Runtime ini_set() cannot catch parse errors in the executing file itself - requires php.ini configuration.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/1053424/how-do-i-get-php-errors-to-display'
),
(
    'PHP: define() vs. const - when to use which',
    'stackoverflow-php',
    'MEDIUM',
    '[
        {"solution": "Use const for most cases - it offers better readability and enables static analysis by development tools", "percentage": 90, "note": "Default choice in modern PHP"},
        {"solution": "Use define() when you need conditional definition: if (!defined(''FOO'')) { define(''FOO'', ''BAR''); }", "percentage": 85, "note": "const cannot be conditionally defined"},
        {"solution": "Use define() when constant value comes from expressions or function calls: define(''SIZE'', max(10, 20));", "percentage": 82, "note": "const only accepts static scalar values or constant expressions"},
        {"solution": "Use const exclusively for class constants - define() cannot be used inside classes", "percentage": 95, "note": "Only option for class-level constants"}
    ]'::jsonb,
    'PHP 5.3+ for const in namespaces, PHP 5.6+ for const with constant expressions, Understanding of compile-time vs runtime needs',
    'Constants defined and accessible throughout code scope, Conditional logic works as expected, Type hints and IDEs properly recognize const definitions',
    'const is evaluated at compile-time while define() executes at runtime. const automatically respects namespaces but define() requires explicit namespace in the name. Class constants can only use const, never define(). For readability, prefer const unless conditional definition is needed.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/2447791/php-define-vs-const'
),
(
    'How to get YouTube video thumbnail from YouTube API in PHP',
    'stackoverflow-php',
    'MEDIUM',
    '[
        {"solution": "Use predictable thumbnail URL without API: https://img.youtube.com/vi/<VIDEO_ID>/hqdefault.jpg", "percentage": 95, "note": "No API key or authentication needed"},
        {"solution": "Available quality levels: default.jpg (120x90), mqdefault.jpg (320x180), hqdefault.jpg (480x360), sddefault.jpg (640x480), maxresdefault.jpg (1280x720)", "percentage": 90, "note": "hqdefault is most reliable"},
        {"solution": "Use YouTube Data API v3 for programmatic access with metadata: requires API key and has usage quotas", "percentage": 70, "note": "Use when metadata is needed alongside thumbnail"}
    ]'::jsonb,
    'YouTube video ID, Image display capability, (Optional) YouTube API credentials for data endpoint',
    'Thumbnail image loads and displays correctly, Image dimensions match selected quality, No authentication errors',
    'Not all videos have maxresdefault.jpg - use hqdefault as fallback. Alternative hosts (i.ytimg.com, i1.ytimg.com) work identically. Do not rely on unpublished/deleted videos having thumbnails.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/2068344/how-do-i-get-a-youtube-video-thumbnail-from-the-youtube-api'
),
(
    'PHP parse/syntax errors and how to solve them',
    'stackoverflow-php',
    'HIGH',
    '[
        {"solution": "Use IDE with syntax highlighting - instantly reveals string, variable, and operator color coding to spot errors", "percentage": 90, "note": "Most effective error prevention method"},
        {"solution": "Check preceding lines when error line is reported - the parser failed at that line but actual mistake is usually before it", "percentage": 88, "note": "Error line number indicates where parser gave up, not the source"},
        {"solution": "Look for missing semicolons (;), mismatched quotes, unbalanced parentheses, and missing operators", "percentage": 85, "note": "Most common syntax errors"},
        {"solution": "Enable error display in php.ini: error_reporting = E_ALL and display_errors = 1 to reveal White Screen of Death errors", "percentage": 92, "note": "Critical for diagnosis"}
    ]'::jsonb,
    'PHP IDE or editor with syntax highlighting, php.ini access (for comprehensive error reporting), Valid PHP file with syntax error',
    'Syntax highlighting reveals errors visually, Error messages display in browser or logs, Code passes PHP linter validation, No White Screen of Death',
    'Error line number in parse errors points to where the parser failed, not where the mistake was made - always examine previous lines. Comment out code blocks systematically to isolate problems. Use a hex editor to check for invisible Unicode characters in problematic files. Indentation and line breaks help prevent syntax errors.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/18050071/php-parse-syntax-errors-and-how-to-solve-them'
),
(
    'Reference guide: What does this symbol mean in PHP?',
    'stackoverflow-php',
    'HIGH',
    '[
        {"solution": "Spaceship operator <=> (PHP 7+): Performs three-way comparison returning negative, zero, or positive value", "percentage": 90, "note": "Modern comparison operator"},
        {"solution": "Null coalescing ?? (PHP 7+): Returns left operand if not null, otherwise right operand", "percentage": 92, "note": "Cleaner than isset() ternary"},
        {"solution": "Null-safe operator ?-> (PHP 8+): Safely accesses properties on potentially null objects without errors", "percentage": 88, "note": "Prevents null reference errors"},
        {"solution": "Bitwise operators &, |, ^, ~, <<, >>: Perform operations on individual bits of integers", "percentage": 75, "note": "Less common but essential for certain algorithms"},
        {"solution": "Logical operators &&, ||, !, and, or: Control program flow based on boolean conditions", "percentage": 85, "note": "Fundamental programming concept"}
    ]'::jsonb,
    'PHP 7+ for modern operators, Understanding of operator precedence, Basic programming knowledge',
    'Operators return expected values, Type casting behaves correctly, Comparison and logical results match anticipation',
    'Special characters were historically difficult to search for - this comprehensive reference exists to fill that gap. Not all syntax symbols are operators - some are language constructs. Operator precedence matters: use parentheses to clarify intent.',
    0.87,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/3737139/reference-guide-what-does-this-symbol-mean-in-php-php-syntax'
);
