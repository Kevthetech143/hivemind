-- Community contributions batch 1 (approved from queue)
-- 5 entries from pending_contributions

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'Claude Code 2 minute timeout bash commands',
    'general',
    'MEDIUM',
    '[
        {
            "solution": "Add timeout environment variables to ~/.claude/settings.json",
            "percentage": 85,
            "command": "echo ''{\"env\": {\"BASH_DEFAULT_TIMEOUT_MS\": \"1800000\", \"BASH_MAX_TIMEOUT_MS\": \"7200000\"}}'' > ~/.claude/settings.json",
            "note": "Extends timeout to 30-120 minutes. Restart Claude Code after editing."
        }
    ]'::jsonb,
    'Backup existing settings.json first, validate JSON syntax after editing',
    'Commands run longer than 2 minutes without timeout, test incrementally with increasing durations',
    'Using non-existent env vars (COMMAND_TIMEOUT_MS, PROCESS_TIMEOUT_MS, SHELL_TIMEOUT_MS, EXECUTION_TIMEOUT_MS - these don''t work). Only BASH_DEFAULT_TIMEOUT_MS and BASH_MAX_TIMEOUT_MS are valid.',
    0.85,
    'sonnet-4',
    NOW(),
    'community-contribution'
),
(
    'Windows accept edits on permission system failing v1.0.103',
    'windows',
    'HIGH',
    '[
        {
            "solution": "Rollback to v1.0.102 or update to v1.0.105+",
            "percentage": 95,
            "command": "/config (disable auto-update) then npm install -g @anthropic-ai/claude-code@1.0.102",
            "note": "v1.0.103 has Windows path handling bug. v1.0.105+ has permanent fix."
        }
    ]'::jsonb,
    'npm installed, access to terminal',
    'Accept edits mode works properly on Windows, no path-related errors',
    'Not disabling auto-update before rollback causes immediate re-update to broken version',
    0.95,
    'sonnet-4',
    NOW(),
    'community-contribution'
),
(
    'Claude using personal account instead of organization account',
    'authentication',
    'MEDIUM',
    '[
        {
            "solution": "Logout and re-authenticate to switch accounts",
            "percentage": 90,
            "command": "claude /logout",
            "note": "Then re-authenticate when prompted to select correct organization"
        }
    ]'::jsonb,
    'Have access to organization account, know which organization to use',
    'Correct organization shown in usage stats, API calls charged to right account',
    'API console (console.anthropic.com) organizations are separate - may need admin to re-invite you there',
    0.90,
    'sonnet-4',
    NOW(),
    'community-contribution'
),
(
    'MCP timeout error when using browser or long-running tools',
    'mcp-troubleshooting',
    'HIGH',
    '[
        {
            "solution": "Set MCP_TIMEOUT environment variable",
            "percentage": 90,
            "command": "MCP_TIMEOUT=30000 claude",
            "note": "Value in milliseconds. 30000 = 30 seconds, 1200000 = 20 minutes. Default increased to 30s in newer versions."
        }
    ]'::jsonb,
    'Using Claude Code as MCP client launching other servers',
    'MCP tools complete without timeout errors, long operations finish successfully',
    'Using too short timeout values for complex operations like browser automation or database queries',
    0.90,
    'sonnet-4',
    NOW(),
    'community-contribution'
),
(
    'Claude Code interactive mode freezes on Windows after initial setup',
    'windows',
    'HIGH',
    '[
        {
            "solution": "Allow auto-update to complete and kill lingering processes",
            "percentage": 85,
            "command": "taskkill /F /IM bun.exe && taskkill /F /IM claude.exe",
            "note": "Auto-update to 1.0.105 includes cleanup. Check Task Manager for stuck processes."
        },
        {
            "solution": "Use non-interactive mode as temporary workaround",
            "percentage": 70,
            "command": "claude -p \"your prompt here\"",
            "note": "Works but eliminates file uploads and multi-turn conversations"
        }
    ]'::jsonb,
    'Windows system, administrative access to kill processes',
    'Interactive mode responds to input, no freeze after setup, cursor visible and responsive',
    'Following PATH advice from diagnostics (adding .local\\bin) may configure broken installation. Ensure only one installation method active (npm OR native, not both).',
    0.85,
    'sonnet-4',
    NOW(),
    'community-contribution'
);
