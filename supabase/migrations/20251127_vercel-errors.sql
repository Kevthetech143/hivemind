INSERT INTO knowledge_entries (query, category, hit_frequency, solutions, prerequisites, success_indicators, common_pitfalls, success_rate, claude_version, last_verified, source_url, contributor_email) VALUES
('npm run build exited with 1', 'deployment', 'HIGH', '[{"solution": "Set CI=false in Vercel Build & Development Settings", "percentage": 85}, {"solution": "Override Build command to CI='''' npm run build", "percentage": 92}]'::jsonb, 'npm, React/Next.js', 'Build completes without exit code 1', 'Not setting CI environment variable, ignoring warnings', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/66840942/vercel-deployment-error-command-npm-run-build-exited-with-1', 'admin:1764223836'),
('504 GATEWAY_TIMEOUT FUNCTION_INVOCATION_TIMEOUT', 'performance', 'CRITICAL', '[{"solution": "Upgrade from Hobby plan (5s limit) to Pro (15s) or Enterprise (30s)", "percentage": 95}, {"solution": "Optimize serverless function logic to reduce execution time", "percentage": 78}, {"solution": "Use Edge Functions instead (30s stream limit)", "percentage": 65}]'::jsonb, 'Vercel serverless deployment', 'Function executes and responds within timeout', 'Using blocking I/O, not optimizing database queries', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/68276674/vercel-serverless-function-has-timed-out-error', 'admin:1764223836'),
('Vercel 504 error on POST request with fetch', 'performance', 'HIGH', '[{"solution": "Reduce number of sequential fetch requests in route", "percentage": 88}, {"solution": "Cache results from first fetch to use in second fetch", "percentage": 82}, {"solution": "Move logic to external background job service", "percentage": 75}]'::jsonb, 'Next.js API routes, fetch API', 'POST request completes within timeout', 'Making multiple sequential HTTP requests', 0.85, 'haiku', NOW(), 'https://stackoverflow.com/questions/68771480/nextjs-vercel-504-error-function-invocation-timeout', 'admin:1764223836'),
('Serverless function invocation timeout getServerSideProps', 'performance', 'CRITICAL', '[{"solution": "Check getServerSideProps execution time and reduce it", "percentage": 90}, {"solution": "Move expensive operations to build time with getStaticProps", "percentage": 85}, {"solution": "Use client-side rendering for slow data fetches", "percentage": 80}]'::jsonb, 'Next.js, getServerSideProps', 'Page loads within timeout limit', 'Running expensive operations in getServerSideProps at request time', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/69493602/vercel-serverless-function-invocation-timeout', 'admin:1764223836'),
('Vercel function invocation failed error', 'runtime', 'HIGH', '[{"solution": "Check Vercel Functions logs tab in real-time for stack trace", "percentage": 92}, {"solution": "Set up Log Drain for persistent logging", "percentage": 88}, {"solution": "Check for errors in API routes or getServerSideProps", "percentage": 85}]'::jsonb, 'Next.js, Vercel dashboard', 'Error no longer appears in Functions logs', 'Not checking Function logs for actual error details', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/67031624/how-to-debug-or-handle-vercel-function-invocation-failed-error', 'admin:1764223836'),
('Vercel edge functions 404 error in production', 'deployment', 'MEDIUM', '[{"solution": "Update middleware path matching and rewrite logic", "percentage": 86}, {"solution": "Check _middleware.js for correct path patterns", "percentage": 84}, {"solution": "Verify edge function file location and naming", "percentage": 80}]'::jsonb, 'Next.js edge functions, i18n middleware', 'Edge function responds with 200 instead of 404', 'Incorrect pathname matching in middleware rewrite rules', 0.82, 'haiku', NOW(), 'https://stackoverflow.com/questions/69917971/vercel-edge-functions-works-locally-and-give-404-on-production-when-trying-to-wo', 'admin:1764223836'),
('404 not found on static site deployment', 'routing', 'HIGH', '[{"solution": "Add vercel.json with rewrites route for SPA", "percentage": 94}, {"solution": "Configure Routes in vercel.json to point to index.html", "percentage": 92}, {"solution": "Set framework preset in project settings", "percentage": 88}]'::jsonb, 'HTML/CSS/JS static site, vercel.json', 'Site loads without 404 errors', 'Missing vercel.json rewrite configuration', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/78585281/how-do-i-fix-a-404-error-in-vercel-github', 'admin:1764223836'),
('404 NextJS deployment no serverless functions', 'routing', 'MEDIUM', '[{"solution": "Check framework preset is set to Next.js in project settings", "percentage": 90}, {"solution": "Verify Build command is npm run build", "percentage": 88}, {"solution": "Ensure output directory is .next", "percentage": 85}]'::jsonb, 'Next.js 12+', 'Pages load and return 200 status', 'Framework preset defaults to none without warning', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/73093055/404-not-found-vercel-deploying-nextjs', 'admin:1764223836'),
('NEXT_PUBLIC environment variable undefined in production', 'configuration', 'CRITICAL', '[{"solution": "Ensure variable name starts with NEXT_PUBLIC_ prefix", "percentage": 96}, {"solution": "Add variable to Vercel dashboard Environment Variables", "percentage": 95}, {"solution": "Redeploy after adding environment variable", "percentage": 90}]'::jsonb, 'Next.js, Vercel dashboard', 'console.log shows correct variable value', 'Missing NEXT_PUBLIC_ prefix or not redeploying', 0.93, 'haiku', NOW(), 'https://stackoverflow.com/questions/65383169/vercel-next-js-environment-variable-not-working', 'admin:1764223836'),
('Environment variable not found during build Turborepo Prisma', 'configuration', 'HIGH', '[{"solution": "Add DATABASE_URL to turbo.json globalPassThroughEnv", "percentage": 88}, {"solution": "Use globalEnv for cache invalidation on var change", "percentage": 85}, {"solution": "Add env to specific task if only needed at build time", "percentage": 80}]'::jsonb, 'Turborepo, Prisma, Vercel', 'Build completes with DATABASE_URL available', 'Not configuring Turborepo env variable handling', 0.86, 'haiku', NOW(), 'https://stackoverflow.com/questions/79014099/env-variable-is-not-set-during-build-on-vercel', 'admin:1764223836'),
('Increase maxDuration timeout on serverless functions', 'configuration', 'HIGH', '[{"solution": "Use export const maxDuration = 300 in App Router route.ts", "percentage": 92}, {"solution": "Use export const config with maxDuration in Pages Router", "percentage": 90}, {"solution": "Set in vercel.json functions config for App Router", "percentage": 88}]'::jsonb, 'Next.js 13+, Vercel Pro plan', 'Function executes without timeout errors', 'Mixing Pages and App Router config syntax', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/77503770/how-to-increase-timeout-limit-on-vercel-serverless-functions', 'admin:1764223836'),
('FUNCTION_INVOCATION_TIMEOUT Flask SMTP email error', 'performance', 'MEDIUM', '[{"solution": "Use asynchronous email sending instead of blocking SMTP", "percentage": 82}, {"solution": "Queue email jobs to background worker service", "percentage": 85}, {"solution": "Use SendGrid or similar email API instead of SMTP", "percentage": 88}]'::jsonb, 'Flask, Python, Vercel', 'Email sends without timeout', 'Blocking SMTP connection exceeds 10s limit', 0.80, 'haiku', NOW(), 'https://stackoverflow.com/questions/78704095/vercel-error-function-invocation-timeout-when-making-post-request-from-flask-a', 'admin:1764223836'),
('TypeScript errors from node_modules in Vercel', 'build', 'MEDIUM', '[{"solution": "Add overrides in package.json to match vercel/node TypeScript version", "percentage": 84}, {"solution": "Exclude node_modules in tsconfig.json", "percentage": 80}, {"solution": "Reinstall packages after updating overrides", "percentage": 88}]'::jsonb, 'TypeScript, Turborepo, vercel/node', 'Build completes without type errors', 'Version mismatch between ts-node and root TypeScript', 0.81, 'haiku', NOW(), 'https://stackoverflow.com/questions/79715044/typescript-errors-from-node-modules-in-vercel-clis-logs', 'admin:1764223836'),
('Build failed exit code 1 vague error', 'build', 'MEDIUM', '[{"solution": "Add ignoreDuringBuilds: true to next.config.js", "percentage": 75}, {"solution": "Check local linting: npm run lint", "percentage": 88}, {"solution": "Fix ESLint errors (especially linebreak-style)", "percentage": 90}]'::jsonb, 'Next.js, ESLint', 'Build completes successfully', 'ESLint misconfiguration with linebreak-style on Windows', 0.83, 'haiku', NOW(), 'https://stackoverflow.com/questions/69153850/vague-error-in-vercel-deployment-exit-with-code-1', 'admin:1764223836'),
('Prisma DATABASE_URL env variable not found', 'configuration', 'CRITICAL', '[{"solution": "Disconnect and reconnect Postgres DB in Vercel Storage", "percentage": 92}, {"solution": "Use .env instead of .env.local", "percentage": 85}, {"solution": "Ensure POSTGRES_URL_NON_POOLING is set in Vercel dashboard", "percentage": 88}]'::jsonb, 'Prisma, Next.js, Vercel Postgres', 'prisma generate succeeds, schema validates', 'Cached env variables from previous connection', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/76319261/vercel-cant-find-database-env-variables', 'admin:1764223836'),
('SolidJS adapter 404 error on Vercel', 'deployment', 'MEDIUM', '[{"solution": "Use solid adapter vercel in vite.config.ts", "percentage": 90}, {"solution": "Install solid-start-vercel package", "percentage": 88}, {"solution": "Set ENABLE_VC_BUILD=1 environment variable", "percentage": 85}]'::jsonb, 'SolidJS, SolidStart, Vercel', 'Pages load without 404 errors', 'Not configuring SolidStart Vercel adapter correctly', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/76219797/404-not-found-error-on-solidjs-project-deployed-to-vercel', 'admin:1764223836'),
('Express server 404 on Vercel', 'routing', 'HIGH', '[{"solution": "Create /api/index.js with routes (Vercel requires /api folder)", "percentage": 95}, {"solution": "Update vercel.json routes to point to /api", "percentage": 92}, {"solution": "Move index.js into api/ directory", "percentage": 90}]'::jsonb, 'Express.js, Node.js, Vercel', 'API routes respond with 200/201 status', 'Placing server file outside /api directory', 0.92, 'haiku', NOW(), 'https://stackoverflow.com/questions/72584745/having-problem-deploying-express-server-on-vercel-404-page-not-found', 'admin:1764223836'),
('.env file not found build error', 'configuration', 'HIGH', '[{"solution": "Add environment variables to Vercel dashboard instead of .env files", "percentage": 94}, {"solution": "Do not push .env files to repository", "percentage": 96}, {"solution": "Use env-cmd only with files tracked in git", "percentage": 80}]'::jsonb, '.gitignore, environment variables', 'Build succeeds without env-cmd errors', 'Removing .env files from git but still referencing them in build', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/76872298/vercel-deployment-env-not-found', 'admin:1764223836'),
('Invalid/Missing MONGODB_URI environment variable', 'configuration', 'CRITICAL', '[{"solution": "Add MONGODB_URI to Vercel Environment Variables in dashboard", "percentage": 96}, {"solution": "Ensure connection string includes all credentials", "percentage": 94}, {"solution": "Check MongoDB IP whitelist allows Vercel IPs (0.0.0.0/0)", "percentage": 90}]'::jsonb, 'MongoDB Atlas, Next.js', 'Build completes, getServerSideProps connects to MongoDB', 'IP whitelist restricted to local machine, missing env var', 0.93, 'haiku', NOW(), 'https://stackoverflow.com/questions/74819941/i-get-an-error-when-trying-to-deploy-my-app-to-vercel-what-does-it-mean-by-inv', 'admin:1764223836'),
('Client-side 404 fetching serverless function', 'routing', 'MEDIUM', '[{"solution": "Verify /api/form path matches function file location", "percentage": 88}, {"solution": "Check browser Network tab for actual response", "percentage": 90}, {"solution": "Ensure serverless function is in /api directory", "percentage": 87}]'::jsonb, 'Vercel serverless functions, fetch API', 'Fetch request returns 200 and function response', 'Incorrect path in fetch URL vs actual function structure', 0.86, 'haiku', NOW(), 'https://stackoverflow.com/questions/77783175/client-side-404-error-while-fetching-vercel-serverless-function', 'admin:1764223836'),
('MongoDB IP whitelist blocks Vercel deployments', 'configuration', 'HIGH', '[{"solution": "Add 0.0.0.0/0 to MongoDB Atlas Network Access (Vercel uses dynamic IPs)", "percentage": 98}, {"solution": "Use environment variable pooling connection string", "percentage": 92}, {"solution": "Create MongoDB user with network access from anywhere", "percentage": 95}]'::jsonb, 'MongoDB Atlas, Vercel, Next.js', 'Connection succeeds, queries return data', 'Restricting MongoDB to local IP, not allowing Vercel IPs', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/67456980/getting-a-504-502-error-on-api-requests-in-nextjs-deployed-on-vercel', 'admin:1764223836'),
('Postcss package name typo 404 not found', 'build', 'LOW', '[{"solution": "Check package.json for typo: postcss-pseudo-className-any-link vs postcss-pseudo-class-any-link", "percentage": 98}, {"solution": "Remove misspelled package and install correct one", "percentage": 97}]'::jsonb, 'npm, package.json', 'npm install succeeds, no 404 errors from registry', 'Typo in package name with className vs class', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/70375283/i-am-getting-errors-when-deploying-to-vercel-can-anyone-help-me-with-the-my-iss', 'admin:1764223836');
