-- Express.js Errors Mining - 35 entries
-- Generated for clauderepo knowledge base

INSERT INTO knowledge_entries (query, category, hit_frequency, solutions, prerequisites, success_indicators, common_pitfalls, success_rate, claude_version, last_verified, source_url, contributor_email) VALUES
('Error: app.router property removed in Express 4', 'express', 'HIGH', '[{"solution": "Use express.Router() instead of app.router - removed in Express 4.x", "percentage": 95}, {"solution": "Check Express.js upgrade guide for migration steps", "percentage": 85}]'::jsonb, 'Express 4.x or higher', 'Router initialized without app.router references', 'Forgetting to use express.Router() for modular routes, continuing to use legacy app.router', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/15684130/express-js-error-handling', 'admin:1764222501'),
('Cannot read property length of undefined in Express', 'express', 'HIGH', '[{"solution": "Check if array exists before accessing: if (arr && arr.length)", "percentage": 95}, {"solution": "Use optional chaining: arr?.length", "percentage": 90}]'::jsonb, 'JavaScript ES6+', 'No TypeError thrown', 'Not handling null vs undefined', 0.92, 'haiku', NOW(), 'https://stackoverflow.com/questions/9228582/how-to-handle-errors-in-node-js-using-express', 'admin:1764222501'),
('ECONNREFUSED: connect ECONNREFUSED 127.0.0.1:8081', 'express', 'CRITICAL', '[{"solution": "Ensure Express server is running before client connection", "percentage": 98}, {"solution": "Check server listens on correct port and hostname", "percentage": 95}, {"solution": "Verify firewall not blocking the port", "percentage": 85}]'::jsonb, 'Express server must be started', 'Connection established without ECONNREFUSED', 'Forgetting app.listen(), wrong port, typos in hostname', 0.98, 'haiku', NOW(), 'https://stackoverflow.com/questions/19110438/econnrefused-error-while-running-express-code', 'admin:1764222501'),
('EADDRINUSE: address already in use :::8081', 'express', 'CRITICAL', '[{"solution": "Find process using port: lsof -i :8081 then kill it", "percentage": 97}, {"solution": "Use different port in app.listen()", "percentage": 90}, {"solution": "Enable SO_REUSEADDR: app.listen(port, {reuseaddr: true})", "percentage": 85}]'::jsonb, 'Port available or process killed', 'Server starts without EADDRINUSE', 'Not killing previous process, wrong port, multiple servers', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/4075287/node-express-eaddrinuse-address-already-in-use-how-can-i-stop-the-process', 'admin:1764222501'),
('TypeError: Router.use() requires a middleware function', 'express', 'HIGH', '[{"solution": "Pass function to router.use(), not object: router.use(middleware)", "percentage": 98}, {"solution": "Check imports - ensure middleware exported as function", "percentage": 95}, {"solution": "For async middleware, wrap in try-catch and call next(err)", "percentage": 88}]'::jsonb, 'Express router instance', 'Middleware loaded without TypeError', 'Passing undefined/null/non-function; typos in imports', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/27465850/typeerror-router-use-requires-middleware-function-but-got-a-object', 'admin:1764222501'),
('ERR_HTTP_HEADERS_SENT: Cannot set headers after sent', 'express', 'CRITICAL', '[{"solution": "Only call res.send() or res.json() once per request", "percentage": 97}, {"solution": "Use if-else or return: return res.json()", "percentage": 96}, {"solution": "Check middleware order - error handlers last", "percentage": 90}]'::jsonb, 'Proper response handling in middleware', 'Single response sent per request', 'Multiple res.send() calls, missing returns, wrong middleware order', 0.98, 'haiku', NOW(), 'https://stackoverflow.com/questions/55464389/problem-with-err-http-headers-sent-and-warning-a-promise', 'admin:1764222501'),
('UnhandledPromiseRejection: Promise rejected without catch', 'express', 'HIGH', '[{"solution": "Add catch handler to promises: promise.catch(err => next(err))", "percentage": 95}, {"solution": "Use async/await with try-catch blocks", "percentage": 93}, {"solution": "Wrap async route handlers with .catch(next)", "percentage": 92}]'::jsonb, 'Promise or async/await code', 'No unhandled rejections in logs', 'Forgetting .catch(), not catching async errors', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/48431815/i-get-an-unhandledpromiserejection-with-express-middleware', 'admin:1764222501'),
('TypeError: res.send() requires a string or buffer', 'express', 'MEDIUM', '[{"solution": "Use res.json() for objects: res.json({data: value})", "percentage": 98}, {"solution": "Convert to string: res.send(String(value))", "percentage": 90}, {"solution": "Ensure value is serializable JSON", "percentage": 95}]'::jsonb, 'Express response object', 'Response sent without type error', 'Sending objects with res.send(), undefined values', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/9228582/how-to-handle-errors-in-node-js-using-express', 'admin:1764222501'),
('CORS policy error: No Access-Control-Allow-Origin header', 'express', 'CRITICAL', '[{"solution": "Install cors middleware: app.use(require(cors)())", "percentage": 98}, {"solution": "Manually set headers: res.header(Access-Control-Allow-Origin, *)", "percentage": 95}, {"solution": "For specific origins: res.header(Access-Control-Allow-Origin, http://localhost:3000)", "percentage": 93}]'::jsonb, 'CORS middleware or header handling', 'Browser requests succeed without CORS errors', 'Missing CORS setup, wrong origin, case sensitivity', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/7067966/why-doesnt-adding-cors-headers-to-an-options-route-allow-browsers-to-access-my', 'admin:1764222501'),
('app.listen() TypeError: callback must be function', 'express', 'MEDIUM', '[{"solution": "Pass function to app.listen(): app.listen(3000, () => console.log(listening))", "percentage": 97}, {"solution": "Ensure port is number, not string", "percentage": 95}, {"solution": "For env port: parseInt(process.env.PORT || 3000)", "percentage": 92}]'::jsonb, 'Express app instance', 'Server listens without errors', 'Non-function callback, wrong parameter order', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/15684130/express-js-error-handling', 'admin:1764222501'),
('Cannot set headers after they are sent', 'express', 'CRITICAL', '[{"solution": "Only one response per request - use return res.send()", "percentage": 98}, {"solution": "Check for duplicate middleware sending responses", "percentage": 95}, {"solution": "Review async code for race conditions", "percentage": 88}]'::jsonb, 'Single request handler pattern', 'Responses sent once', 'Multiple res.send() calls, chain not stopping', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/59848041/nodejs-express-cors-error-headers-are-set-in-both-client-and-server', 'admin:1764222501'),
('Error: route.get() requires a callback function', 'express', 'HIGH', '[{"solution": "Provide function to route: app.get(/path, (req, res) => {})", "percentage": 98}, {"solution": "Check handler is defined and exported", "percentage": 96}, {"solution": "Ensure no typos in function names", "percentage": 95}]'::jsonb, 'Function or inline handler', 'Route handler executes on request', 'Missing callback, undefined reference, typos', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/36558909/route-get-requires-callback-functions-but-got-a-object-undefined', 'admin:1764222501'),
('TypeError: Cannot read property protocol of undefined', 'express', 'MEDIUM', '[{"solution": "Ensure req object passed: function(req, res, next)", "percentage": 98}, {"solution": "Check req.protocol after app.enable(trust proxy)", "percentage": 92}, {"solution": "Use req.get(host) if protocol not set", "percentage": 88}]'::jsonb, 'Express middleware with proper params', 'req object accessible with protocol', 'Wrong function parameters, accessing req early', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/60787474/why-is-my-error-handler-in-expressjs-not-working', 'admin:1764222501'),
('next() is not a function error in middleware', 'express', 'MEDIUM', '[{"solution": "Middleware needs 3 params: (req, res, next)", "percentage": 98}, {"solution": "Check middleware gets correct arguments", "percentage": 96}, {"solution": "Verify middleware chain order", "percentage": 92}]'::jsonb, 'Express middleware pattern', 'Middleware chain executes', 'Missing next param, wrong count, skipping middleware', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/27794750/node-js-with-express-throw-error-vs-nexterror', 'admin:1764222501'),
('Error: body-parser request size exceeds limit', 'express', 'MEDIUM', '[{"solution": "Increase limit: app.use(express.json({limit: 50mb}))", "percentage": 97}, {"solution": "Check size against 100kb default", "percentage": 95}, {"solution": "For large uploads use streaming", "percentage": 85}]'::jsonb, 'Express body-parser middleware', 'Large JSON bodies accepted', 'Exceeding default limit, not configuring', 0.93, 'haiku', NOW(), 'https://stackoverflow.com/questions/10005939/how-do-i-consume-the-json-post-data-in-an-express-application', 'admin:1764222501'),
('Cannot read property body of undefined', 'express', 'HIGH', '[{"solution": "Load body-parser: app.use(express.json())", "percentage": 98}, {"solution": "Load BEFORE route handlers", "percentage": 97}, {"solution": "Check Content-Type matches configuration", "percentage": 94}]'::jsonb, 'Express body-parser setup', 'req.body contains parsed data', 'Missing middleware, wrong order, unsupported type', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/47232187/express-json-vs-bodyparser-json', 'admin:1764222501'),
('Error handling middleware not catching errors', 'express', 'HIGH', '[{"solution": "Error handlers need 4 params: (err, req, res, next)", "percentage": 98}, {"solution": "Place AFTER all other middleware", "percentage": 97}, {"solution": "Call next(error) to pass to handler", "percentage": 96}]'::jsonb, 'Express error handler setup', 'Errors caught by middleware', 'Wrong param count, wrong position, no next()', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/72749190/how-to-handle-specific-errors-with-expressjs', 'admin:1764222501'),
('SyntaxError: Unexpected token in JSON', 'express', 'MEDIUM', '[{"solution": "Ensure API returns JSON not HTML", "percentage": 96}, {"solution": "Check Content-Type is application/json", "percentage": 95}, {"solution": "Use res.json() instead of res.send()", "percentage": 97}]'::jsonb, 'Proper JSON response', 'Valid JSON with correct headers', 'Returning HTML as JSON, wrong header', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/9228582/how-to-handle-errors-in-node-js-using-express', 'admin:1764222501'),
('TypeError: app.use requires a middleware function', 'express', 'MEDIUM', '[{"solution": "Pass function to app.use(): app.use((req, res, next) => {})", "percentage": 98}, {"solution": "Check middleware exported as function", "percentage": 96}, {"solution": "Verify imports and typos", "percentage": 95}]'::jsonb, 'Express middleware setup', 'Middleware loads successfully', 'Non-function, typos, wrong imports', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/28159194/express-passing-params-to-route-throws-typeerrorrouter-use-requires-middlewa', 'admin:1764222501'),
('Cannot POST /path 404 Not Found', 'express', 'HIGH', '[{"solution": "Define route: app.post(/path, handler)", "percentage": 98}, {"solution": "Check route path matches request URL", "percentage": 97}, {"solution": "Define route before 404 middleware", "percentage": 95}]'::jsonb, 'Express route handlers', 'POST request matches route', 'Route not defined, wrong path, typos', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/34853675/error-post-requires-callback-functions-but-got-a-object-undefined-not-work', 'admin:1764222501'),
('ReferenceError: router is not defined', 'express', 'MEDIUM', '[{"solution": "Import router: const router = require(express).Router()", "percentage": 98}, {"solution": "Use express.Router() to create", "percentage": 97}, {"solution": "Ensure router.use() uses correct variable", "percentage": 95}]'::jsonb, 'Express Router setup', 'Router instance created', 'Missing import, typo, not creating Router()', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/25579379/express-router-use-requires-callback-function-error', 'admin:1764222501'),
('TypeError: Cannot destructure property x of undefined', 'express', 'MEDIUM', '[{"solution": "Check object exists: const { x } = obj || {}", "percentage": 97}, {"solution": "Use defaults: const { x = default } = obj", "percentage": 96}, {"solution": "Validate parameters before destructuring", "percentage": 94}]'::jsonb, 'JavaScript ES6 destructuring', 'No destructuring errors', 'Not checking undefined, missing defaults', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/59407665/express-middleware-passing-variable-error-typeerror-cannot-destructure-proper', 'admin:1764222501'),
('Cannot read property use of undefined', 'express', 'MEDIUM', '[{"solution": "Initialize app: const app = express()", "percentage": 98}, {"solution": "Import correctly: const express = require(express)", "percentage": 97}, {"solution": "Check variable typos", "percentage": 95}]'::jsonb, 'Express app instance', 'app.use() method available', 'Missing import, undefined variable', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/44019285/express-error-throw-new-typeerrorrouter-use-requires-middleware-function-bu', 'admin:1764222501'),
('Error: PORT already in use - Cannot start server', 'express', 'MEDIUM', '[{"solution": "Change port: app.listen(3001)", "percentage": 95}, {"solution": "Kill existing process: pkill -f node", "percentage": 90}, {"solution": "Use dynamic port: app.listen(process.env.PORT || 3000)", "percentage": 92}]'::jsonb, 'Port management', 'Server starts on available port', 'Multiple servers on port, processes not cleaned', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/24853225/node-express-says-eaddrinuse-but-port-is-free', 'admin:1764222501'),
('throw new Error(Express requires a function)', 'express', 'MEDIUM', '[{"solution": "Import as function: express()", "percentage": 98}, {"solution": "Create instance: const app = express()", "percentage": 97}, {"solution": "Check module properly installed", "percentage": 96}]'::jsonb, 'Express module installation', 'App instance created', 'Wrong import syntax, missing parentheses', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/69408292/route-post-requires-a-callback-function-but-got-a-object-undefined-even-tho', 'admin:1764222501'),
('ORIGIN header not allowed by Access-Control-Allow-Origin', 'express', 'MEDIUM', '[{"solution": "Update CORS: cors({origin: http://localhost:3000})", "percentage": 97}, {"solution": "Allow all in dev: cors({origin: *})", "percentage": 90}, {"solution": "Set origin validation callback", "percentage": 85}]'::jsonb, 'CORS middleware config', 'Cross-origin requests accepted', 'Restrictive policy, wrong origin URL', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/69031211/cors-error-on-localhost-event-with-correct-headers', 'admin:1764222501'),
('SyntaxError: Unexpected identifier in route file', 'express', 'LOW', '[{"solution": "Check missing semicolons and syntax", "percentage": 96}, {"solution": "Validate with linter (eslint)", "percentage": 94}, {"solution": "Check braces and parentheses match", "percentage": 95}]'::jsonb, 'Valid JavaScript syntax', 'Code parses without errors', 'Missing braces, semicolons, typos', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/39870867/what-does-app-usebodyparser-json-do', 'admin:1764222501'),
('TypeError: res.json() is not a function', 'express', 'MEDIUM', '[{"solution": "Ensure res is Express response object", "percentage": 98}, {"solution": "Check middleware not overriding res", "percentage": 95}, {"solution": "Verify (req, res, next) parameters", "percentage": 96}]'::jsonb, 'Express route handler setup', 'res.json() executes', 'Wrong response object, custom middleware', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/38306569/what-does-body-parser-do-with-express', 'admin:1764222501'),
('Cannot find module express in node_modules', 'express', 'HIGH', '[{"solution": "Install express: npm install express", "percentage": 98}, {"solution": "Check package.json includes express", "percentage": 97}, {"solution": "Run npm install for dependencies", "percentage": 99}]'::jsonb, 'Node.js and npm installed', 'express module in node_modules', 'Missing npm install, corrupt modules, no package.json', 0.98, 'haiku', NOW(), 'https://stackoverflow.com/questions/39985486/how-to-use-body-parser-in-express-router', 'admin:1764222501'),
('Error: Failed to lookup view in views directory', 'express', 'MEDIUM', '[{"solution": "Set views: app.set(views, ./views)", "percentage": 97}, {"solution": "Check template file exists", "percentage": 96}, {"solution": "Set engine: app.set(view engine, ejs)", "percentage": 95}]'::jsonb, 'Template engine setup', 'View templates found', 'Wrong path, missing files, wrong engine', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/7716691/how-to-properly-handle-errors-in-express', 'admin:1764222501'),
('DeprecationWarning: res.sendfile() is deprecated', 'express', 'LOW', '[{"solution": "Use res.sendFile(): res.sendFile(path)", "percentage": 98}, {"solution": "Update to Express 4.16+", "percentage": 97}, {"solution": "Check documentation for options", "percentage": 94}]'::jsonb, 'Express 4.16+', 'No deprecation warnings', 'Using old sendfile() method', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/74935812/error-handling-in-expressjs-middlewares-next-vs-throw', 'admin:1764222501'),
('Error: _bootstrap.js Cannot find module', 'express', 'LOW', '[{"solution": "Check NODE_PATH or resolution", "percentage": 92}, {"solution": "Ensure package.json main correct", "percentage": 90}, {"solution": "Reinstall: rm -rf node_modules && npm install", "percentage": 88}]'::jsonb, 'Proper module structure', 'Modules load successfully', 'Wrong paths, corrupt node_modules', 0.9, 'haiku', NOW(), 'https://stackoverflow.com/questions/7151487/error-handling-principles-for-node-js-express-js-applications', 'admin:1764222501'),
('TypeError: Cannot convert undefined to primitive', 'express', 'MEDIUM', '[{"solution": "Check variable defined before conversion", "percentage": 97}, {"solution": "Use nullish coalescing: value ?? default", "percentage": 95}, {"solution": "Validate inputs before operations", "percentage": 93}]'::jsonb, 'Type checking and validation', 'No conversion errors', 'Using undefined in ops, missing checks', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/53711347/server-instances-jest-and-listen-eaddrinuse-3000', 'admin:1764222501'),
('socket hang up error on disconnect', 'express', 'MEDIUM', '[{"solution": "Add error handler: req.on(error, handler)", "percentage": 95}, {"solution": "Set timeout: server.setTimeout(60000)", "percentage": 90}, {"solution": "Graceful shutdown: process.on(SIGTERM, handler)", "percentage": 88}]'::jsonb, 'Socket/connection error handling', 'No unhandled socket errors', 'Not handling events, missing listeners', 0.92, 'haiku', NOW(), 'https://stackoverflow.com/questions/37120729/errors-eaddrinuse-and-econnrefused-with-script', 'admin:1764222501'),
('Error: listen EACCES permission denied for port 1024', 'express', 'MEDIUM', '[{"solution": "Use port >= 1024: app.listen(3000)", "percentage": 98}, {"solution": "Run sudo: sudo node server.js (risky)", "percentage": 50}, {"solution": "Reverse proxy port 80 to 3000", "percentage": 85}]'::jsonb, 'Port selection', 'Server on allowed port', 'Privileged ports without permission', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/76197581/error-connect-econnrefused-127-0-0-15400-at-tcpconnectwrap-afterconnect-as-on', 'admin:1764222501'),
('Error: getaddrinfo ENOTFOUND hostname', 'express', 'MEDIUM', '[{"solution": "Check hostname exists and resolves", "percentage": 97}, {"solution": "Verify DNS settings correct", "percentage": 92}, {"solution": "Test with IP instead", "percentage": 90}]'::jsonb, 'Network connectivity', 'Hostname resolves', 'Typos, DNS issues, network problems', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/42751932/nodejs-error-eaddrinuse', 'admin:1764222501'),
('Segmentation fault in native addon', 'express', 'LOW', '[{"solution": "Check addon version compatibility", "percentage": 88}, {"solution": "Rebuild: npm rebuild", "percentage": 85}, {"solution": "Update Node.js", "percentage": 80}]'::jsonb, 'Native addon debugging', 'No segmentation faults', 'Version mismatches, outdated modules', 0.82, 'haiku', NOW(), 'https://stackoverflow.com/questions/9544479/how-do-i-catch-node-js-express-server-errors-like-eaddrinuse', 'admin:1764222501');
