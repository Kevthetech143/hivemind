-- Add Parcel bundler troubleshooting solutions from Stack Overflow (batch 1 of 2)

INSERT INTO knowledge_entries (query, category, solutions, common_pitfalls, success_rate, hit_frequency, prerequisites, success_indicators, claude_version, last_verified, source_url, thumbs_up)
VALUES
(
  'Parcel: Importing images in TypeScript React - Cannot find module',
  'stackoverflow-parcel',
  '[{"solution": "Create declaration.d.ts file (not index.d.ts) in src/ directory with image module declarations: declare module ''*.jpg''; declare module ''*.png'';", "percentage": 95, "note": "258 votes. TypeScript prioritizes index.tsx over index.d.ts, so use different filename like declaration.d.ts or react-app-env.d.ts"}, {"solution": "Ensure tsconfig.json includes both src and declaration files in the include array, not just declaration file", "percentage": 90, "note": "Restrictive include settings prevent TypeScript language service from using declarations"}, {"solution": "Restart IDE/dev server after adding .d.ts file as some IDEs cache TypeScript state", "percentage": 85, "note": "VSCode and similar IDEs may require TypeScript language server restart"}]'::jsonb,
  'Naming declaration file index.d.ts causes TypeScript to deprioritize it. Overly restrictive tsconfig.json include settings prevent discovery. IDE caching may hide changes until restart.',
  0.95,
  'VERY_HIGH',
  'TypeScript configured in React project, ability to modify tsconfig.json',
  'TypeScript compiles without errors, img src resolves correctly, no "Cannot find module" errors in IDE',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/52759220/importing-images-in-typescript-react-cannot-find-module',
  258
),
(
  'Parcel: React-router app works in dev but 404 after Vercel deployment',
  'stackoverflow-parcel',
  '[{"solution": "Create vercel.json at project root with rewrites to redirect all non-file requests to index.html: {\"rewrites\": [{\"source\": \"/(.*)\", \"destination\": \"/\"}]}", "percentage": 95, "note": "61 votes. This single config fixes all client-side routing issues on Vercel"}, {"solution": "Use regex-based routes config: {\"routes\": [{\"src\": \"/[^.]+\", \"dest\": \"/\", \"status\": 200}]} to exclude file requests", "percentage": 90, "note": "Ensures CSS, JS, images are not rewritten to index.html"}, {"solution": "Verify package.json homepage property uses ''.'' or deployment URL, not absolute path", "percentage": 80, "note": "Incorrect homepage breaks asset resolution in production"}]'::jsonb,
  'Using broad rewrites pattern /(.*) breaks asset requests including JS bundles and CSS files. Incorrect vercel.json location (not in root) causes routing rules to not apply. Package.json homepage with absolute path conflicts with relative asset references.',
  0.95,
  'VERY_HIGH',
  'React Router with BrowserRouter configured, Vercel project setup, ability to create vercel.json',
  'Client-side routes like /recruit, /tos return 200 and display content. Assets (CSS, JS, images) load correctly. No 404 errors on navigation.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/64815012/react-router-app-works-in-dev-but-not-after-vercel-deployment',
  61
),
(
  'Parcel: import.meta error - Only allowed with module es2020/esnext/system',
  'stackoverflow-parcel',
  '[{"solution": "Restart TypeScript server in VSCode: Ctrl+Shift+P -> Restart TypeScript Server. Configuration is often correct but IDE caching prevents recognition.", "percentage": 95, "note": "53 votes. Most common cause - 51 upvotes for this solution"}, {"solution": "Set both target and module to esnext in tsconfig.json: \"target\": \"esnext\", \"module\": \"esnext\"", "percentage": 90, "note": "Compile-time setting that allows import.meta syntax"}, {"solution": "Add moduleResolution setting to tsconfig: \"moduleResolution\": \"node\" to avoid secondary import resolution errors", "percentage": 85, "note": "Sometimes required alongside target/module changes"}]'::jsonb,
  'IDE caches old TypeScript configuration state even after tsconfig.json changes. Case sensitivity matters: esnext not ESNext. Missing moduleResolution causes follow-up import errors.',
  0.95,
  'VERY_HIGH',
  'TypeScript configured, VSCode or IDE with TypeScript support, access to tsconfig.json',
  'No ts(1343) error on import.meta usage. IDE shows no red squiggles. Code compiles to JavaScript without syntax errors.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/69716191/the-import-meta-meta-property-is-only-allowed-when-the-module-option-is-e',
  53
),
(
  'Parcel: Invalid Version undefined - SemVer bug',
  'stackoverflow-parcel',
  '[{"solution": "Downgrade to parcel-bundler@1.12.3 or upgrade to parcel@next (v2) - versions with the bug have known fixes via version management", "percentage": 90, "note": "42 votes. GitHub issue #5943 tracks this. Babel SemVer parsing fails in specific versions"}, {"solution": "Upgrade to Parcel v2: npm uninstall parcel-bundler && npm install parcel@next && run with npx parcel serve index.html", "percentage": 85, "note": "v2 migration is recommended for new projects, though not all users report v2 fully resolves it"}, {"solution": "Delete yarn.lock/package-lock.json and reinstall dependencies if standard fixes dont work", "percentage": 70, "note": "Lock file corruption can perpetuate version conflicts"}]'::jsonb,
  'Version incompatibility between parcel-bundler and Babel is the root cause. Lock file corruption can hide the true issue. Cache may need clearing after version changes.',
  0.85,
  'HIGH',
  'Node.js v14.6.0+, npm or yarn, simple HTML/JS project structure',
  'parcel serve/build runs without "Invalid Version: undefined" error. Project bundling completes successfully.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/66459081/parcel-semver-bug',
  42
),
(
  'Parcel: TypeError (0, _react.useEffect) is not a function in production',
  'stackoverflow-parcel',
  '[{"solution": "Configure bundler to externalize React dependency: use --globals react=React flag or bundler equivalent to prevent React from bundled into output", "percentage": 90, "note": "30 votes. Most relevant for microbundle but applies to Parcel bundles exporting React components. Root cause: React resolution from global scope fails."}, {"solution": "Import React fully: import React from \"react\" then use React.useEffect instead of destructured imports", "percentage": 85, "note": "Workaround for when hook exports are inaccessible"}, {"solution": "Verify hook imports come from \"react\" package, not accidentally from \"react-redux\" or other packages", "percentage": 80, "note": "IDE auto-import can select wrong package"}]'::jsonb,
  'Bundler configuration may incorrectly assume React is globally available instead of from dependency. Destructured imports fail when bundler doesnt properly externalize peer dependencies. IDE auto-import can target wrong package.',
  0.90,
  'HIGH',
  'React 16.8.0+ with hooks, Parcel bundler configured, understanding of module externalization',
  'React components load without TypeError. useEffect and other hooks work in production build. Browser console shows no import errors.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/61348714/typeerror-0-react-useeffect-is-not-a-function',
  30
),
(
  'Parcel: How to use jQuery and jQuery-UI',
  'stackoverflow-parcel',
  '[{"solution": "Use require() to import jQuery and manually assign to window, then require jQuery-UI: var jquery = require(\"jquery\"); window.$ = window.jQuery = jquery; require(\"jquery-ui-dist/jquery-ui.js\");", "percentage": 95, "note": "29 votes with 53 upvotes on answer. jQuery-UI expects $ in global scope which ES6 imports dont provide."}, {"solution": "Create separate import-jquery.js file: import jquery from \"jquery\"; export default (window.$ = window.jQuery = jquery); then import before jQuery-UI", "percentage": 85, "note": "Cleaner than inline require approach for large projects"}, {"solution": "Skip jQuery-UI from npm and use CDN <script> tag instead, only import jQuery via npm", "percentage": 75, "note": "Avoids module bundler complexity"}]'::jsonb,
  'Parcel/bundlers dont automatically expose global variables. jQuery-UI expects $ on window object but ES6 imports create isolated scope. Direct import attempts fail with "missing module" errors.',
  0.95,
  'HIGH',
  'jQuery and jQuery-UI installed via npm, basic CommonJS/ES6 module knowledge',
  'jQuery functions available as $(). jQuery-UI plugins work without errors. No "missing module" or TypeError on $.ui calls.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/47968529/how-do-i-use-jquery-and-jquery-ui-with-parcel-bundler',
  29
),
(
  'Parcel: Error Expected content key to exist',
  'stackoverflow-parcel',
  '[{"solution": "Delete .parcel-cache folder and rebuild: rm -rf .parcel-cache && parcel build", "percentage": 95, "note": "25 votes with 78 upvotes on solution. Corrupted cache causes content key mismatch errors."}, {"solution": "Automate cache clearing in package.json: \"start\": \"rm -rf .parcel-cache && parcel\" and \"build\": \"rm -rf .parcel-cache && parcel build\"", "percentage": 90, "note": "Prevents recurrence during development watch mode"}, {"solution": "Windows users: Use PowerShell: Remove-Item -Recurse -Force .parcel-cache", "percentage": 85, "note": "rm command unavailable on Windows cmd"}]'::jsonb,
  'Parcel cache corruption is the root cause but remains unresolved by maintainers. Manual deletion only temporary - issue recurs on next watch. No permanent fix available in core.',
  0.90,
  'HIGH',
  'Parcel v2.9.3+, Node.js environment, ability to run terminal commands',
  'Error does not reappear after cache deletion. Build completes successfully. .parcel-cache regenerated without errors.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/77166144/error-expected-content-key-de1e4a02ec63c4eb-to-exist',
  25
),
(
  'Parcel: How to add images in React',
  'stackoverflow-parcel',
  '[{"solution": "Import image as module: import image from ''path/to/image.png''; then use <img src={image} />", "percentage": 95, "note": "23 votes. Standard Parcel v1 approach that handles asset bundling."}, {"solution": "For Parcel 2+, use url: prefix: import image from ''url:path/to/image.png''", "percentage": 90, "note": "v2 requires explicit url: prefix for image imports"}, {"solution": "Use URL constructor: const logo = new URL(''./images/landscape.jpg'', import.meta.url).href; then <img src={logo} />", "percentage": 85, "note": "Modern approach compatible with both v1 and v2"}]'::jsonb,
  'Static string paths like <img src=\"image.png\" /> don''t trigger asset processing. Version-specific syntax varies - pre-v2.10 vs v2.10+. Static folder approach bypasses Parcel''s benefits.',
  0.95,
  'VERY_HIGH',
  'React project, Parcel bundler (v1 or v2), understanding of ES6 imports',
  'Images display correctly in both dev and production builds. Asset paths resolve in browser. No 404 errors on image requests.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/52841765/how-to-add-image-in-react-by-using-parcel',
  23
),
(
  'Parcel: tree.render is not a function - SVG minification error',
  'stackoverflow-parcel',
  '[{"solution": "Create .htmlnanorc config file in project root with minifySvg disabled: {\"minifySvg\": false}", "percentage": 95, "note": "21 votes with 26 upvotes on solution. SVG minification via htmlnano is root cause."}, {"solution": "Use .htmlnanorc.js with CommonJS instead of JSON if needed: module.exports = {minifySvg: false}", "percentage": 85, "note": "Alternative config format for complex setups"}, {"solution": "Run with --no-optimize flag: parcel build --no-optimize index.html to skip all optimizations", "percentage": 75, "note": "Skips all minification but slower option"}]'::jsonb,
  'SVG minification in htmlnano is the culprit, not Parcel itself. Developers often look for Parcel config instead of htmlnano. Deprecated --no-minify flag no longer works in newer versions.',
  0.95,
  'HIGH',
  'Parcel v1.12.3+, HTML with embedded SVG elements, ability to create .htmlnanorc file',
  'Build completes without tree.render error. SVG elements display correctly in output HTML. minifySvg: false in config confirmed.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/67087634/parcel-js-tree-render-is-not-a-function',
  21
),
(
  'Parcel: Babel 7 Duplicate plugin/preset detected error',
  'stackoverflow-parcel',
  '[{"solution": "Remove @babel/plugin-transform-regenerator from .babelrc plugins array - it''s already included in @babel/preset-env which Parcel applies by default", "percentage": 95, "note": "18 votes. Parcel auto-applies preset-env, so explicit plugin inclusion creates duplicate."}, {"solution": "Review which plugins are contained in your preset: @babel/preset-env includes many plugins including regenerator", "percentage": 85, "note": "Understanding preset contents prevents accidental duplication"}, {"solution": "Migrate Babel 6 configs to Babel 7 by removing plugins now included in presets", "percentage": 80, "note": "Common when upgrading projects"}]'::jsonb,
  'Developers migrating from Babel 6 don''t realize plugins moved into presets. Multiple config sources (bundler + .babelrc) can create duplicates. Unknown preset contents lead to accidental plugin duplication.',
  0.95,
  'HIGH',
  'Babel 7.x, Parcel bundler, .babelrc configuration file, understanding of presets vs plugins',
  'Build completes without duplicate plugin error. Babel transpilation works correctly. No warnings about plugin duplication.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/52798987/babel-7-fails-with-single-plugin-saying-duplicate-plugin-preset-detected',
  18
),
(
  'Parcel: No entries found error on server run',
  'stackoverflow-parcel',
  '[{"solution": "Use HTML file as entry point, not JavaScript: parcel index.html (not parcel index.js)", "percentage": 95, "note": "17 votes with 19 upvotes on solution. Most common mistake - wrong file type."}, {"solution": "Run command from project root directory: ensure index.html exists in current working directory", "percentage": 90, "note": "Subdirectories or wrong paths cause file not found"}, {"solution": "Use correct path separator for your OS: forward slashes on Unix, backslashes on Windows: parcel src/index.html vs parcel src\\index.html", "percentage": 85, "note": "Windows users often forget backslash syntax"}]'::jsonb,
  'Running parcel index.js instead of index.html is the #1 mistake. Running from wrong directory means index.html isn''t found. Cache issues rarely cause this - usually just wrong entry point.',
  0.95,
  'VERY_HIGH',
  'Parcel bundler installed, HTML entry point file created, terminal access',
  'parcel serve/build command starts without No entries found error. Dev server runs and serves page at localhost:1234.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/55948356/how-to-fix-no-entries-found-on-server-run-in-parcel-js',
  17
),
(
  'Parcel: --public-url option usage and purpose',
  'stackoverflow-parcel',
  '[{"solution": "Set --public-url to specify base path for assets: default is / (absolute paths like <script src=\"/dist.js\">). Use --public-url ./ for relative paths like <script src=\"dist.js\">", "percentage": 95, "note": "15 votes with 36 upvotes on answer. Critical for non-root deployments like GitHub Pages."}, {"solution": "For GitHub Pages, use --public-url ./project-name/ to match the deployment path structure", "percentage": 90, "note": "Fails if paths don''t match actual deployment URL"}, {"solution": "Option works identically in serve/watch/build modes - only controls how asset URLs are generated in HTML", "percentage": 85, "note": "No mode-specific behavior despite different flags"}]'::jsonb,
  'Cache may need clearing after changing --public-url. Forgetting to match deployment path structure causes 404s. Confusing default / behavior with relative paths.',
  0.95,
  'MEDIUM',
  'Parcel bundler, knowledge of deployment paths, ability to pass CLI flags',
  'Assets load correctly from deployment path. No 404 errors on CSS, JS, or image files. Both relative and absolute paths work as intended.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/61282379/parcel-js-use-of-public-url-option',
  15
),
(
  'Parcel: How to wipe dist directory before build',
  'stackoverflow-parcel',
  '[{"solution": "Use rimraf for cross-platform compatibility: npm install --save-dev rimraf, then in package.json: \"build\": \"rimraf dist && parcel build src/index.html\"", "percentage": 95, "note": "15 votes. rimraf works on Windows/Mac/Linux unlike rm -rf which only works on Unix."}, {"solution": "Use npm prebuild hook: create \"prebuild\" script: \"rm -rf dist\" to auto-run before build", "percentage": 90, "note": "Leverages npm lifecycle hooks for automatic cleanup"}, {"solution": "Install parcel-plugin-nuke-dist package, but note it''s incompatible with Parcel v2", "percentage": 70, "note": "Was popular in v1 but not updated for v2"}]'::jsonb,
  'rm -rf command fails on Windows systems - must use rimraf or alternative. parcel-plugin-nuke-dist no longer maintained for v2. Directory path errors if dist has custom name.',
  0.90,
  'MEDIUM',
  'Node.js and npm, Parcel bundler project, ability to modify package.json scripts',
  'dist/ directory cleared before each build. Build output generated fresh. No stale files from previous builds in output.',
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/56506191/how-to-wipe-dist-directory-before-a-build-with-parcel',
  15
);
