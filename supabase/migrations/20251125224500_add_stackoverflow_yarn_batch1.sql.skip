-- Add Stack Overflow Yarn package manager solutions batch 1

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'Yarn install command error No such file or directory: install',
    'stackoverflow-yarn',
    'HIGH',
    '[
        {"solution": "Remove conflicting cmdtest package: sudo apt remove cmdtest && sudo apt remove yarn", "percentage": 95, "note": "Ubuntu ships yarn as a scenario testing tool from cmdtest suite, not JavaScript package manager"},
        {"solution": "Add official Yarn repository: curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add - && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | sudo tee /etc/apt/sources.list.d/yarn.list", "percentage": 90, "command": "sudo apt-get update && sudo apt-get install yarn -y"},
        {"solution": "Verify installation: yarn --version should show version number like v1.3.2", "percentage": 85, "command": "yarn --version"}
    ]'::jsonb,
    'Ubuntu/Debian system, sudo access, internet connection',
    'yarn install v[version] message appears, packages resolve without errors',
    'Default Ubuntu yarn package is cmdtest not JavaScript package manager. Must remove conflicting installation first. Close and reopen terminal after installation.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/46013544/yarn-install-command-error-no-such-file-or-directory-install'
),
(
    'How to clear cache in Yarn',
    'stackoverflow-yarn',
    'HIGH',
    '[
        {"solution": "Clear entire cache: yarn cache clean", "percentage": 95, "note": "Removes all cached packages from Yarn cache directory"},
        {"solution": "Clear specific package cache: yarn cache clean [package-name]", "percentage": 90, "command": "yarn cache clean react"},
        {"solution": "View cache location: yarn cache dir", "percentage": 85, "command": "yarn cache dir"},
        {"solution": "List all cached packages (Yarn v1 only): yarn cache list", "percentage": 75, "note": "Not available in Yarn v2+"}
    ]'::jsonb,
    'Yarn package manager installed, Run from user account that uses Yarn',
    'Command executes without errors, Cache directory is emptied, Subsequent yarn install rebuilds cache from remote repositories',
    'Plug and Play mode: clearing cache breaks applications. Cache location varies by OS: ~/.yarn-cache/ (legacy), ~/Library/Caches/Yarn/v6 (macOS), ~/.config/yarn/ (Linux). Old ~/.yarn-cache/ directories may persist.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/39991508/how-to-clear-cache-in-yarn'
),
(
    'The engine node is incompatible with this module when using Yarn',
    'stackoverflow-yarn',
    'HIGH',
    '[
        {"solution": "Update Node.js to required version using Homebrew: brew upgrade node", "percentage": 92, "note": "Recommended permanent solution - matches package requirements"},
        {"solution": "Use nvm to install correct Node version: nvm install 16.16.0 && nvm use 16.16.0", "percentage": 90, "command": "nvm list && nvm use [version]"},
        {"solution": "Quick workaround (not recommended): yarn install --ignore-engines", "percentage": 60, "note": "Masks compatibility issues, packages may fail at runtime"},
        {"solution": "Ubuntu: Remove outdated nodejs and install from NodeSource: sudo apt-get purge --auto-remove nodejs && curl -fsSL https://deb.nodesource.com/setup_16.x | sudo -E bash - && sudo apt-get install -y nodejs", "percentage": 85, "command": "node --version"}
    ]'::jsonb,
    'Node.js version management tool installed (nvm or Homebrew), Current Node.js version below package requirements',
    'yarn install completes without engine-related errors, Package functionality works correctly, Project .nvmrc file reflects correct Node version',
    'Ignoring engines masks real compatibility problems - packages compiled for older Node versions may fail. Simply updating package.json engines field without updating Node.js does not solve the underlying issue. Mixing yarn and npm can cause unexpected behavior.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/56617209/the-engine-node-is-incompatible-with-this-module'
),
(
    'What is the closest to npm ci in yarn',
    'stackoverflow-yarn',
    'HIGH',
    '[
        {"solution": "For Yarn 1.x use: yarn install --frozen-lockfile", "percentage": 92, "note": "Prevents lockfile generation and fails if updates are needed"},
        {"solution": "For Yarn 2+ use: yarn install --immutable --immutable-cache --check-cache", "percentage": 90, "command": "yarn install --immutable"},
        {"solution": "For complete cleanliness, remove node_modules first: rm -rf node_modules && yarn install --frozen-lockfile", "percentage": 85, "note": "Ensures clean install like npm ci"},
        {"solution": "Windows equivalent: rd /s /q node_modules && yarn install --frozen-lockfile", "percentage": 80, "command": "rd /s /q node_modules"}
    ]'::jsonb,
    'Valid yarn.lock file committed to repository, Node.js and Yarn installed, yarn.lock present in project',
    'Installation completes without modifying lockfiles, All dependencies resolve from existing lock entries, CI pipelines fail if version ranges require updates',
    '--frozen-lockfile alone may leave invalid transitive dependencies - must clean node_modules first. Yarn 2+ may rewrite package.json unlike npm ci''s strictly frozen behavior. Different Yarn versions use different flags.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/58482655/what-is-the-closest-to-npm-ci-in-yarn'
),
(
    'How to uninstall Yarn',
    'stackoverflow-yarn',
    'MEDIUM',
    '[
        {"solution": "macOS with Homebrew: brew uninstall yarn", "percentage": 90, "note": "Most common installation method on macOS"},
        {"solution": "macOS with npm: npm uninstall -g yarn", "percentage": 85, "command": "npm uninstall -g yarn"},
        {"solution": "Ubuntu/Linux: sudo apt-get remove yarn && sudo apt-get purge yarn", "percentage": 90, "command": "sudo apt-get remove yarn"},
        {"solution": "CentOS: yum remove yarn", "percentage": 80, "command": "yum remove yarn"},
        {"solution": "Windows with Chocolatey: choco uninstall yarn", "percentage": 85, "command": "choco uninstall yarn"},
        {"solution": "If using Corepack: corepack disable yarn", "percentage": 75, "note": "For modern Node.js versions with Corepack"}
    ]'::jsonb,
    'Identify installation method first using: which yarn (macOS/Linux) or where yarn (Windows), Appropriate package manager for your OS',
    'which yarn returns yarn not found, yarn --version produces command not found error, No yarn binaries in expected directories like /usr/local/bin/yarn',
    'npm uninstall -g yarn reports up to date but doesn''t remove anything. Yarn may persist in multiple locations simultaneously. Old yarn versions cached in ~/.yarn or ~/.config/yarn. Symlinks may remain in /usr/local/bin/yarn and /usr/local/bin/yarnpkg.',
    0.86,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/42334978/how-do-i-uninstall-yarn'
),
(
    'How do I add shared dependencies to a monorepo using Yarn workspaces',
    'stackoverflow-yarn',
    'MEDIUM',
    '[
        {"solution": "Use Syncpack tool to synchronize dependency versions across workspaces: install syncpack, configure it to match versions across packages", "percentage": 92, "note": "Recommended as the least harmful way to enable automatic sharing"},
        {"solution": "Use peer dependencies method: declare shared dependencies as peerDependencies with wildcard versions in individual workspaces while root package.json contains actual versions", "percentage": 80, "note": "Inconsistent results, not universally reliable"},
        {"solution": "Yarn v2 built-in script sharing capabilities for monorepo management", "percentage": 75, "note": "Requires Yarn 2 or later, different setup than Yarn 1"}
    ]'::jsonb,
    'Yarn workspace setup already configured in package.json, Understanding of monorepo structure, Yarn 1 (classic) or Yarn 2+ depending on approach',
    'Dependencies automatically resolve from shared node_modules location, Version consistency maintained across workspaces, Reduced duplication in dependency management, Successful yarn install without warnings',
    'Adding dependencies to root package.json triggers Yarn warnings. Manually maintaining identical versions across n workspaces becomes cumbersome. Peer dependencies approach is inconsistent. Yarn 1 is not optimized for monorepos - consider Yarn 2+ for better monorepo support.',
    0.82,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/67621600/how-do-i-add-shared-dependencies-to-a-monorepo-using-yarn-workspaces'
),
(
    'How to upgrade yarn version using terminal',
    'stackoverflow-yarn',
    'MEDIUM',
    '[
        {"solution": "Using npm (recommended by official docs): npm install --global yarn", "percentage": 92, "command": "npm install --global yarn"},
        {"solution": "macOS with Homebrew: brew upgrade yarn", "percentage": 90, "command": "brew upgrade yarn"},
        {"solution": "Using Yarn''s built-in command (cross-platform): yarn set version stable", "percentage": 85, "command": "yarn set version stable", "note": "Works across all operating systems but project-level only"},
        {"solution": "Specify exact version: yarn set version 1.22.10", "percentage": 80, "command": "yarn set version [version-number]"},
        {"solution": "Linux: curl --compressed -o- -L https://yarnpkg.com/install.sh | bash", "percentage": 85, "command": "curl --compressed -o- -L https://yarnpkg.com/install.sh | bash"},
        {"solution": "Windows with Chocolatey: choco upgrade yarn", "percentage": 80, "command": "choco upgrade yarn"}
    ]'::jsonb,
    'Node.js and npm installed, Appropriate permissions for global package install, Terminal access',
    'yarn --version returns new version number, Restart terminal to see changes, Package manager commands work with updated version',
    'yarn policies set-version only updates within a project, not globally. Outdated symlinks may prevent updates from taking effect. Installation method affects which upgrade command succeeds. Must close and reopen terminal after installation to see changes.',
    0.87,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/49689174/yarn-how-to-upgrade-yarn-version-using-terminal'
),
(
    'Remove package-lock.json warning with yarn install',
    'stackoverflow-yarn',
    'MEDIUM',
    '[
        {"solution": "Delete package-lock.json: rm package-lock.json", "percentage": 95, "note": "npm creates this file, conflicts with yarn.lock"},
        {"solution": "Remove node_modules folder: rm -rf node_modules", "percentage": 90, "command": "rm -rf node_modules"},
        {"solution": "Reinstall with Yarn only: yarn install", "percentage": 95, "command": "yarn install"},
        {"solution": "For monorepos, find all conflicting lock files: find . -name \"package-lock.json\" -delete", "percentage": 85, "command": "find . -name package-lock.json -delete"},
        {"solution": "Commit consistently: use only Yarn going forward, not both package managers", "percentage": 90, "note": "Prevents future conflicts in project"}
    ]'::jsonb,
    'Node.js and npm installed, Yarn installed globally or locally, Project with node_modules and conflicting lock files',
    'Warning message disappears when running yarn install, yarn.lock file is created/updated without conflicts, Dependencies install without errors, No package manager conflicts in future installations',
    'Switching managers mid-project creates resolution inconsistencies. Nested package conflicts in monorepos: parent directories may contain stray package-lock.json files. Incomplete cleanup of lock files causes continued issues. Mixing package managers in same project causes version drift.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/55624786/how-to-solve-package-json-found-to-clear-this-warning-remove-package-lock'
),
(
    'How to install package from github repo in Yarn',
    'stackoverflow-yarn',
    'MEDIUM',
    '[
        {"solution": "Yarn 1.x HTTPS format: yarn add fancybox@https://github.com/fancyapps/fancybox", "percentage": 90, "command": "yarn add package-name@https://github.com/user/repo"},
        {"solution": "Yarn 1.x with branch/tag/commit: yarn add fancybox@https://github.com/fancyapps/fancybox#3.0", "percentage": 88, "command": "yarn add package@https://github.com/user/repo#branch-name"},
        {"solution": "Yarn 2+ requires package name prefix: yarn add ''package-name@https://github.com/user/repo''", "percentage": 85, "command": "yarn add ''package-name@https://github.com/user/repo''"},
        {"solution": "SSH with private repos: yarn add ssh://git@github.com/owner/package#tag", "percentage": 80, "command": "yarn add ssh://git@github.com/user/repo#tag", "note": "SSH keys must be configured"},
        {"solution": "Shorthand format: yarn add github_user/repository_name#commit_hash", "percentage": 75, "command": "yarn add user/repo#hash"}
    ]'::jsonb,
    'Yarn package manager installed, Git repository access or SSH keys configured for private repos, Repository contains package.json with valid entry point',
    'Package successfully installs in node_modules, Package appears in package.json dependencies or yarn.lock, Build/dist files are accessible',
    'Repository must contain built/compiled files (dist folder) or define proper entry points. Yarn 2+ requires package name prefix before URL. SSH syntax differs from traditional Git SSH format. Private repos need proper authentication setup. Repository without package.json cannot be installed.',
    0.84,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/43411864/how-to-install-package-from-github-repo-in-yarn'
),
(
    'Yarn: How to upgrade yarn version using terminal',
    'stackoverflow-yarn',
    'MEDIUM',
    '[
        {"solution": "Method 1 - Using npm (official recommendation): npm upgrade --global yarn", "percentage": 92, "command": "npm upgrade --global yarn", "note": "Works cross-platform, npm install method"},
        {"solution": "Method 2 - Yarn self-update: yarn set version stable", "percentage": 85, "command": "yarn set version stable", "note": "Works in projects with package.json"},
        {"solution": "Method 3 - Specific version: yarn policies set-version", "percentage": 80, "command": "yarn policies set-version [version]"},
        {"solution": "Verify upgrade: yarn --version", "percentage": 95, "command": "yarn --version", "note": "Close and reopen terminal first"}
    ]'::jsonb,
    'Yarn already installed, Node.js 12+, Terminal access with appropriate permissions',
    'yarn --version displays new version number, All yarn commands work properly, yarn install executes without warnings',
    'Outdated symlinks prevent updates from taking effect. yarn policies set-version is project-level only, not global. Must restart terminal/shell to recognize upgrade. Installation method determines which upgrade strategy works.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/49689174/yarn-how-to-upgrade-yarn-version-using-terminal'
);
