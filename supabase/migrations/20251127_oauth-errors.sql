INSERT INTO knowledge_entries (query, category, hit_frequency, solutions, prerequisites, success_indicators, common_pitfalls, success_rate, claude_version, last_verified, source_url, contributor_email) VALUES
('invalid_grant error in OAuth token exchange', 'authentication', 'CRITICAL', '[{"solution": "Check if user has revoked access to your application - users can revoke at any time", "percentage": 85}, {"solution": "Verify server clock is synchronized with NTP - time skew causes invalid_grant", "percentage": 90}, {"solution": "Confirm refresh token hasn''t expired - refresh tokens expire after 6 months of inactivity", "percentage": 88}, {"solution": "Verify redirect_uri in token request matches authorization request exactly", "percentage": 92}]'::jsonb, 'OAuth 2.0 client credentials, authorization code', 'Access token successfully obtained', 'Assuming error is always about expired token without checking revocation status, ignoring server time synchronization', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/10576386/invalid-grant-trying-to-get-oauth-token-from-google', 'admin:1764225102'),
('redirect_uri_mismatch OAuth error', 'authentication', 'CRITICAL', '[{"solution": "Ensure redirect_uri registered in console matches exactly - check for http vs https, www vs non-www, trailing slashes", "percentage": 95}, {"solution": "Wait a few minutes after updating redirect URIs in console - changes can take time to propagate", "percentage": 80}, {"solution": "Verify URI includes full path, not just domain - e.g., https://example.com/path/to/oauth/url", "percentage": 93}]'::jsonb, 'OAuth app registered in Google/Azure console', 'Authorization flow completes and returns code', 'Forgetting to include full path in redirect URI, not accounting for trailing slashes, mixing http and https', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/11485271/google-oauth-2-authorization-error-redirect-uri-mismatch', 'admin:1764225102'),
('invalid_request OAuth error in Google', 'authentication', 'HIGH', '[{"solution": "Use http://localhost:1/ instead of urn:ietf:wg:oauth:2.0:oob for headless machines", "percentage": 75}, {"solution": "Ensure application complies with Google''s OAuth 2.0 security policies - Google now requires localhost/loopback redirects", "percentage": 88}, {"solution": "Switch to OAuth for devices flow for headless or limited-input devices if available", "percentage": 70}]'::jsonb, 'Google OAuth 2.0 client registration', 'Authorization request succeeds without error page', 'Using deprecated oob flow without considering modern alternatives, not understanding policy changes', 0.78, 'haiku', NOW(), 'https://stackoverflow.com/questions/71318804/google-oauth-2-0-failing-with-error-400-invalid-request-for-some-client-id-but', 'admin:1764225102'),
('unauthorized_client vs access_denied OAuth', 'authentication', 'MEDIUM', '[{"solution": "unauthorized_client means client is not authorized for requested scope/grant type - fix client configuration", "percentage": 85}, {"solution": "access_denied means resource owner or authorization server denied - user rejected consent or server blocked", "percentage": 90}, {"solution": "For access_denied, check if client scope permissions are allowed for the resource being accessed", "percentage": 82}]'::jsonb, 'OAuth 2.0 understanding of error distinctions', 'Correct error handling based on error type', 'Treating unauthorized_client and access_denied as interchangeable, not checking client configuration', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/38029677/whats-the-difference-between-unauthorized-client-and-access-denied', 'admin:1764225102'),
('invalid_scope OAuth error', 'authentication', 'HIGH', '[{"solution": "Scope parameter must be space-delimited, not comma-delimited - e.g., ''read write trust'' not ''read,write,trust''", "percentage": 92}, {"solution": "Verify requested scopes are actually supported by the OAuth provider - Google Photos API doesn''t support device flow scopes", "percentage": 85}, {"solution": "Check scope names match exactly what provider defines - typos in scope names cause invalid_scope", "percentage": 90}]'::jsonb, 'OAuth provider documentation on supported scopes', 'Access token successfully issued with requested scope', 'Using comma-delimiters instead of spaces, requesting unsupported scopes, scope name typos', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/38216570/getting-invalid-scope-when-requesting-for-oauth2-access-token', 'admin:1764225102'),
('invalid_client_id in OAuth requests', 'authentication', 'CRITICAL', '[{"solution": "Remove extra whitespace at beginning/end of client_id - copying from Google console can include invisible spaces", "percentage": 88}, {"solution": "Verify client_id matches exactly what provider issued - ensure no accidental modifications", "percentage": 93}, {"solution": "Check if using correct client_id for the app type - OAuth app credentials differ from API key", "percentage": 86}]'::jsonb, 'OAuth client credentials from provider console', 'OAuth request accepted with valid_client response', 'Extra spaces in credentials when copying from console, using wrong client_id for app type', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/17166848/invalid-client-in-google-oauth2', 'admin:1764225102'),
('unsupported_grant_type OAuth error', 'authentication', 'MEDIUM', '[{"solution": "Verify grant_type value matches OAuth provider''s supported types - authorization_code, implicit, client_credentials, etc.", "percentage": 90}, {"solution": "Ensure client configuration allows the requested grant type - not all clients are configured for all flows", "percentage": 87}, {"solution": "Check for typos in grant_type parameter value", "percentage": 88}]'::jsonb, 'OAuth 2.0 provider supporting specific grant types', 'Token request accepted and returns access token', 'Typos in grant_type value, using unsupported grant types for client, not checking client configuration', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/29360349/getting-error-unsupported-grant-type-when-trying-to-get-a-jwt-by-calling-an', 'admin:1764225102'),
('unsupported_response_type OAuth error', 'authentication', 'MEDIUM', '[{"solution": "Enable Implicit Flow in Azure AD app manifest - set oauth2AllowImplicitFlow to true", "percentage": 92}, {"solution": "Ensure response_type matches OAuth flow type - use code for auth code flow, id_token/token for implicit", "percentage": 93}, {"solution": "Verify provider supports the response_type you''re requesting", "percentage": 85}]'::jsonb, 'OAuth 2.0 app registration with implicit flow support', 'Authorization request succeeds and returns expected response', 'Not enabling implicit flow in manifest, mixing response types for wrong flow', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/48297559/unsupported-response-type-in-oauth', 'admin:1764225102'),
('oauth_state_missing_or_invalid error', 'authentication', 'MEDIUM', '[{"solution": "State parameter must be randomly generated per request and validated on callback - store in session", "percentage": 91}, {"solution": "Ensure state value from authorization request matches callback state parameter exactly", "percentage": 94}, {"solution": "Check parameter order matches OAuth 2.0 RFC spec format", "percentage": 78}]'::jsonb, 'Session management for storing state values', 'Authorization callback received with matching state parameter', 'Not generating unique state per request, not validating state on callback, assuming any state value works', 0.92, 'haiku', NOW(), 'https://stackoverflow.com/questions/74750167/the-oauth-state-was-missing-or-invalid-how-to-fix', 'admin:1764225102'),
('authorization_code expired error', 'authentication', 'HIGH', '[{"solution": "Authorization codes expire quickly - typically 10 minutes - exchange for token immediately after generation", "percentage": 96}, {"solution": "Don''t reuse the same authorization code multiple times - each code can only be used once", "percentage": 98}, {"solution": "If user takes too long to authorize, request a new authorization code", "percentage": 94}]'::jsonb, 'OAuth 2.0 authorization code flow understanding', 'Token request succeeds on first attempt', 'Delaying token exchange after receiving code, attempting to reuse same code, not understanding code expiration', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/43203055/httpbadrequest-error-description-code-has-expired-error-invalid-grant', 'admin:1764225102'),
('invalid_token_response 406 Not Acceptable', 'authentication', 'MEDIUM', '[{"solution": "Ensure client sends POST request with form-encoded parameters, not query parameters, to token endpoint", "percentage": 88}, {"solution": "Set Content-Type header to application/x-www-form-urlencoded for token requests", "percentage": 90}, {"solution": "Use BASIC authentication method for client credentials instead of POST body in some providers", "percentage": 82}]'::jsonb, 'OAuth 2.0 token endpoint HTTP request knowledge', 'Access token received successfully in response', 'Sending query parameters instead of form body to token endpoint, incorrect Content-Type header', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/61193255/an-error-occurred-while-attempting-to-retrieve-the-oauth-2-0-access-token-respon', 'admin:1764225102'),
('Azure AD consent_required error (invalid_grant)', 'authentication', 'MEDIUM', '[{"solution": "Admin must grant consent for app to access requested scopes - user alone cannot authorize", "percentage": 89}, {"solution": "Login as global admin and grant admin consent through app permissions UI", "percentage": 91}, {"solution": "Ensure application has API permissions added for the scopes being requested", "percentage": 88}]'::jsonb, 'Azure AD tenant admin access for granting consent', 'Access token successfully obtained after admin consent granted', 'Trying to authorize as regular user when admin consent required, not adding API permissions before consent', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/51441507/invalid-grant-error-with-accession-office365-outlook-oauth', 'admin:1764225102'),
('invalid_resource error in Azure AD', 'authentication', 'MEDIUM', '[{"solution": "Include resource parameter identifying the protected resource - e.g., https://graph.windows.net/ or 00000002-0000-0000-c000-000000000000", "percentage": 89}, {"solution": "Use scope parameter instead of resource in OAuth 2.0 v2.0 endpoints - resource is deprecated", "percentage": 85}, {"solution": "Verify resource identifier matches what provider expects", "percentage": 87}]'::jsonb, 'Azure AD resource identifier documentation', 'Token request accepted and access token issued', 'Omitting resource parameter, using deprecated resource in v2.0 flow, incorrect resource identifier', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/25212950/stuck-between-two-errors-in-an-azure-oauth2-token-request', 'admin:1764225102'),
('invalid_id_token JWT claims error', 'authentication', 'HIGH', '[{"solution": "Verify aud (audience) claim in JWT matches your application Client ID exactly", "percentage": 93}, {"solution": "Check server time is synchronized - clock skew causes JWT validation failures", "percentage": 94}, {"solution": "Ensure ID token hasn''t expired by checking exp claim", "percentage": 91}]'::jsonb, 'JWT token validation, server time synchronization', 'ID token successfully validated and user authenticated', 'Audience claim mismatch with Client ID, server clock not synchronized, attempting to use expired tokens', 0.93, 'haiku', NOW(), 'https://stackoverflow.com/questions/14372774/salesforce-returning-unsupported-grant-type', 'admin:1764225102'),
('Salesforce OAuth unsupported_grant_type', 'authentication', 'LOW', '[{"solution": "Enable ''Allow OAuth Username-Password Flows'' in Salesforce connected app settings", "percentage": 88}, {"solution": "Ensure ''Permitted Users'' is set to ''All users may self-authorize''", "percentage": 87}, {"solution": "Set IP Relaxation to ''Relax IP restrictions'' if using restrictive IP policies", "percentage": 85}]'::jsonb, 'Salesforce connected app configuration access', 'Username-password flow succeeds and returns access token', 'Not enabling password flow in connected app, overly restrictive IP settings, wrong permitted users setting', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/34154385/getting-errorinvalid-grant-error-descriptionauthentication-failure-i', 'admin:1764225102'),
('refresh_token expired or revoked', 'authentication', 'HIGH', '[{"solution": "Refresh tokens expire after 6 months of inactivity by default in Google OAuth - request user re-authenticate", "percentage": 87}, {"solution": "When refresh token fails, save error and prompt user for new authorization", "percentage": 90}, {"solution": "Implement refresh token rotation - replace old token with new one", "percentage": 82}]'::jsonb, 'OAuth refresh token management and rotation', 'New tokens obtained through user re-authentication', 'Not handling refresh token expiration gracefully, assuming refresh tokens never expire, not implementing rotation', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/35878859/google-oauth2-error-refreshing-the-oauth2-token-message-error-invalid', 'admin:1764225102'),
('invalid_client with wrong client secret', 'authentication', 'CRITICAL', '[{"solution": "Verify client_secret matches exactly what OAuth provider issued - no extra spaces or characters", "percentage": 94}, {"solution": "Regenerate client_secret in provider console if suspected compromise or loss", "percentage": 89}, {"solution": "Ensure you''re using application client_id/secret, not API key", "percentage": 88}]'::jsonb, 'OAuth provider console with client credentials', 'Authorization request succeeds with valid credentials', 'Extra whitespace in credentials, using wrong type of credential, outdated or corrupted secret', 0.92, 'haiku', NOW(), 'https://stackoverflow.com/questions/48053764/google-oauth-token-request-returns-invalid-client-unauthorized', 'admin:1764225102'),
('OneLogin redirect_uri_mismatch error', 'authentication', 'MEDIUM', '[{"solution": "Ensure Authorized Redirect URIs in OneLogin admin panel include exact URI from your application", "percentage": 91}, {"solution": "If using subdirectory, include full path in registered URI - e.g., https://localhost:8081/login not just https://localhost:8081", "percentage": 89}, {"solution": "Check that application is correctly configured to use the registered URI", "percentage": 87}]'::jsonb, 'OneLogin admin panel access', 'OIDC authentication succeeds without redirect URI mismatch', 'Registering only domain without path, inconsistent paths between app and OneLogin config', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/58721643/error-trying-to-use-onelogin-oidc-with-springboot-error-redirect-uri-mismatch', 'admin:1764225102'),
('chrome_extension redirect_uri_mismatch', 'authentication', 'MEDIUM', '[{"solution": "Use chrome.identity.getRedirectURL() to generate correct extension redirect URI dynamically", "percentage": 90}, {"solution": "For Web App client type, register https://<extension-id>.chromiumapp.org/google as redirect URI", "percentage": 92}, {"solution": "Use chrome.identity.launchWebAuthFlow instead of window redirect for extensions", "percentage": 88}]'::jsonb, 'Chrome Extension manifest v3, chrome.identity API', 'Extension successfully authenticates with OAuth provider', 'Hardcoding redirect URI, not using chrome.identity helpers, incorrect extension ID format', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/77269398/redirect-uri-mismatch-error-for-google-auth-2-0-and-openid-connect-oauth-client', 'admin:1764225102'),
('YouTube API invalid_redirect_uri for Java client', 'authentication', 'MEDIUM', '[{"solution": "Override getRedirectUri() method in Java client to specify correct callback path", "percentage": 86}, {"solution": "Set Redirect URIs in Google Console to include full path - not just domain", "percentage": 88}, {"solution": "Ensure JavaScript Origins includes http://localhost without port for development", "percentage": 84}]'::jsonb, 'Google OAuth Java client library, Google Console', 'YouTube API calls succeed with valid authorization', 'Using default redirect URI from library without overriding, incomplete redirect URIs in console', 0.86, 'haiku', NOW(), 'https://stackoverflow.com/questions/22595174/google-oauth-the-redirect-uri-in-the-request-did-not-match-a-registered-redirec', 'admin:1764225102'),
('Slack OAuth invalid_client_id parameter', 'authentication', 'LOW', '[{"solution": "Pass client_id, scope, and redirect_uri as URL query parameters (GET), not HTTP headers", "percentage": 93}, {"solution": "Use Params tab in Postman instead of Headers for OAuth parameters", "percentage": 91}, {"solution": "Format URL as ?client_id=xxx&scope=xxx&redirect_uri=xxx", "percentage": 94}]'::jsonb, 'HTTP GET parameter handling for OAuth', 'Slack OAuth authorization succeeds without invalid_client_id error', 'Sending OAuth parameters in HTTP headers instead of URL query string, wrong Postman tab usage', 0.93, 'haiku', NOW(), 'https://stackoverflow.com/questions/52672722/slack-oauth-setup-step-1-testing-w-postman-error-invalid-client-id-paramet', 'admin:1764225102'),
('Google OAuth invalid_client missing product name', 'authentication', 'MEDIUM', '[{"solution": "Create OAuth consent screen with product name in Google Console under APIs & Services", "percentage": 89}, {"solution": "Set product name different from or same as project name - either works but name must exist", "percentage": 87}, {"solution": "Add email address to consent screen before creating client ID", "percentage": 86}]'::jsonb, 'Google API Console access for OAuth setup', 'OAuth flow succeeds without invalid_client error', 'Skipping product name configuration, not setting up OAuth consent screen properly', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/17166848/invalid-client-in-google-oauth2', 'admin:1764225102'),
('IdentityServer4 unauthorized_client redirect_uri mismatch', 'authentication', 'MEDIUM', '[{"solution": "Ensure RedirectUris in Client config matches exactly what client application sends - including protocol, port, path", "percentage": 92}, {"solution": "Verify AllowedScopes in Client includes all scopes requested in authorization request", "percentage": 90}, {"solution": "Use correct scope names from IdentityServer configuration", "percentage": 88}]'::jsonb, 'IdentityServer4 Client configuration', 'Client authentication succeeds with correct redirect and scopes', 'Scope mismatch between request and client config, port numbers not matching between config and app', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/52655664/identity-server-4-why-i-receive-unauthorized-client', 'admin:1764225102'),
('invalid_token_response 401 Unauthorized Azure AD', 'authentication', 'MEDIUM', '[{"solution": "Verify client_id and client_secret are current and valid for OAuth token endpoint", "percentage": 91}, {"solution": "Use correct token endpoint URL for Azure AD version you''re using", "percentage": 89}, {"solution": "Ensure client credentials haven''t been regenerated recently - use latest version", "percentage": 87}]'::jsonb, 'Azure AD client credentials management', 'Token request returns 200 with access_token in response', 'Expired credentials, outdated client_secret, wrong token endpoint URL', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/61193255/an-error-occurred-while-attempting-to-retrieve-the-oauth-2-0-access-token-respon', 'admin:1764225102'),
('Microsoft Graph invalid_scope error', 'authentication', 'MEDIUM', '[{"solution": "Use https://graph.microsoft.com/.default scope for client credentials flow instead of specific scopes", "percentage": 88}, {"solution": "Ensure API permissions are granted in Azure AD app registration before requesting token", "percentage": 90}, {"solution": "Verify scope format matches Microsoft documentation exactly", "percentage": 89}]'::jsonb, 'Microsoft Graph API and Azure AD scope documentation', 'Token request succeeds with valid scope', 'Using wrong scope format, missing API permissions configuration, not using .default scope for client flow', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/75445513/microsoft-oauth-2-0-authentication-failure-token-url-bad-request-error', 'admin:1764225102'),
('OAuth authentication_failure in Yandex', 'authentication', 'LOW', '[{"solution": "Verify authorization code is still valid - codes expire after 10 minutes", "percentage": 95}, {"solution": "Ensure client_id, client_secret, and redirect_uri match exactly between auth request and token request", "percentage": 93}, {"solution": "Check all request parameters are URL-encoded correctly", "percentage": 88}]'::jsonb, 'Yandex OAuth provider documentation', 'Token request succeeds and returns access_token', 'Delayed token exchange causing code expiration, mismatched parameters between requests, encoding issues', 0.93, 'haiku', NOW(), 'https://stackoverflow.com/questions/43203055/httpbadrequest-error-description-code-has-expired-error-invalid-grant', 'admin:1764225102');
