-- Add Stack Overflow Pinia (Vue State Management) Solutions Batch 1
-- Extracted from highest-voted SO questions with accepted answers
-- Category: stackoverflow-pinia

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'Why choose Pinia over Vuex for Vue 3 state management?',
    'stackoverflow-pinia',
    'HIGH',
    '[
        {"solution": "Vuex is now in maintenance mode and no longer receives new features. Pinia is the recommended choice for new Vue 3 applications", "percentage": 95, "note": "Official Vue documentation endorsement"},
        {"solution": "Pinia provides simpler API with State, Getters, and Actions (no mutations) compared to Vuex''s complex four-concept structure", "percentage": 90, "note": "Purpose-built for Vue 3 Composition API"},
        {"solution": "Pinia offers full TypeScript support, dynamic store registration, and cross-module store invocation without context parameters", "percentage": 88, "note": "Better developer experience"}
    ]'::jsonb,
    'Vue 3 project with npm/yarn installed, Understanding of Vue.js fundamentals',
    'New Pinia stores created successfully, Type definitions work without errors, Store state persists across components',
    'Do not use Vuex for new projects - it is in maintenance mode. Pinia is simpler and more intuitive for Vue 3.',
    0.92,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/71596003/why-pinia-vs-vuex-for-vue-3'
),
(
    'Vue component not updating after Pinia store state changes',
    'stackoverflow-pinia',
    'VERY_HIGH',
    '[
        {"solution": "Use storeToRefs() to extract state properties while maintaining reactivity", "percentage": 95, "command": "import { storeToRefs } from ''pinia''; const { isDark } = storeToRefs(themeStore)", "note": "Most common solution for reactivity issues"},
        {"solution": "Use computed() to create reactive references to store state", "percentage": 90, "command": "const isDark = computed(() => themeStore.isDark)", "note": "Alternative approach for single property access"},
        {"solution": "Directly access store without destructuring - this.store.isDark works, but destructuring breaks reactivity", "percentage": 85, "note": "Less common but acceptable pattern"}
    ]'::jsonb,
    'Pinia store created and properly initialized, Component with <script setup> or Options API, Understanding of Vue reactivity',
    'Component re-renders when store state changes, Template displays updated values without manual refresh',
    'Simply destructuring state properties breaks reactivity - use storeToRefs() or access store directly. Do not use regular destructuring assignment.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/71676111/vue-component-doesnt-update-after-state-changes-in-pinia-store'
),
(
    'Direct state mutation vs $patch() in Pinia - which is better?',
    'stackoverflow-pinia',
    'MEDIUM',
    '[
        {"solution": "For single property changes, direct mutation like this.count++ is acceptable and efficient", "percentage": 85, "note": "Simple and readable"},
        {"solution": "For multiple property changes, use $patch() to batch changes together", "percentage": 90, "command": "store.$patch({ count: newValue, name: newName })", "note": "More efficient for bulk updates"},
        {"solution": "For computed updates, wrap multiple operations in an action", "percentage": 88, "note": "Best for complex state mutations"}
    ]'::jsonb,
    'Pinia store with writable state, Component with store reference',
    'State updates reflected immediately in UI, No performance degradation with multiple changes',
    'Do not use $patch() for single value changes - direct mutation is fine. Use $patch() only when updating multiple properties simultaneously.',
    0.87,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/74674512/vue-js-pinia-direct-changes-to-state-and-patch-which-one-is-more-performant'
),
(
    'Pinia global state lost on page navigation in Vue 3',
    'stackoverflow-pinia',
    'HIGH',
    '[
        {"solution": "Use Vue Router''s <router-link> component instead of HTML <a> anchor tags for navigation", "percentage": 95, "command": "<router-link :to=\"''/details/'' + id\"> instead of <a :href=\"''/details/'' + id\">", "note": "Native anchors cause full page reloads"},
        {"solution": "Verify Vue Router is configured correctly and all routes use router-link", "percentage": 88, "note": "Router-link preserves SPA state"},
        {"solution": "Add state persistence to Pinia using localStorage or sessionStorage plugin if needed", "percentage": 80, "note": "Fallback for unrecoverable state loss"}
    ]'::jsonb,
    'Vue Router properly configured, Pinia store initialized, Understanding of SPA vs full page reloads',
    'State persists when navigating between routes, Cart/user data remains intact after navigation',
    'Using native anchor tags causes full page reloads which destroys Vue instance and resets all Pinia state. Always use router-link.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/76475250/vue-js-3-not-keeping-pinia-global-state'
),
(
    'How to update Pinia store state in Vue 3',
    'stackoverflow-pinia',
    'MEDIUM',
    '[
        {"solution": "Use Options API syntax to define store with explicit state object", "percentage": 92, "command": "export const useAuthStore = defineStore(''auth'', { state: () => ({ loginForm: { firstName: '''' } }) })", "note": "Ensures all properties are accessible"},
        {"solution": "Update state directly on store instance: authStore.loginForm.firstName = value", "percentage": 88, "note": "Simple direct mutation approach"},
        {"solution": "Use actions for state updates instead of direct mutations", "percentage": 90, "note": "Best practice for larger updates"}
    ]'::jsonb,
    'Pinia store created with defineStore, Component with store reference, Properties exported from store',
    'State updates appear in component UI, No undefined property errors',
    'Ensure all state properties are returned from state() function. If using Composition API, make sure properties are properly exposed.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/74920907/how-to-update-the-state-in-pinia-with-vue-3'
),
(
    'Pinia store initial data fetching on store creation',
    'stackoverflow-pinia',
    'MEDIUM',
    '[
        {"solution": "Call explicit initialization method in root component with Suspense and top-level await", "percentage": 90, "note": "Official recommended approach"},
        {"solution": "Use IIFE (Immediately Invoked Function Expression) in composable to auto-trigger data fetching when store is created", "percentage": 82, "note": "Automatic initialization pattern"},
        {"solution": "Wrap store initialization in <Suspense> component in root Vue component", "percentage": 85, "note": "Enables async setup before rendering"}
    ]'::jsonb,
    'API endpoint accessible, Pinia store created, Suspense component support in Vue 3',
    'Store state populated before component render, No undefined data in templates',
    'Pinia lacks built-in lifecycle hooks like created() - initialization must be explicit. Never rely on implicit initialization.',
    0.83,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/77427537/pinia-store-initial-data-fetching-on-store-creation'
),
(
    'Nuxt 3 useState() vs Pinia for shared state management',
    'stackoverflow-pinia',
    'MEDIUM',
    '[
        {"solution": "Use Pinia for medium to large applications - provides developer tools with action/mutation timeline for debugging", "percentage": 90, "note": "Better tooling and traceability"},
        {"solution": "Pinia offers hot module replacement, plugin ecosystem, better TypeScript support", "percentage": 88, "note": "Ecosystem and developer experience"},
        {"solution": "Use useState() only for small projects or when Pinia overhead is not justified", "percentage": 75, "note": "Simpler but less feature-rich"},
        {"solution": "useState() can replace Pinia functionally but lacks debugging/devtools capabilities", "percentage": 70, "note": "Code readability matters more than marginal performance gains"}
    ]'::jsonb,
    'Nuxt 3 project, Understanding of reactive state patterns, Developer tools knowledge',
    'Devtools show state mutations timeline, Hot reload works without state loss, Type safety maintained',
    'Do not choose useState() over Pinia based on performance alone - the differences are negligible. Consider developer experience.',
    0.86,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/72081334/nuxt-3-pinia-vs-usestate'
),
(
    'How to set up Pinia getter in Vue 3 Composition API',
    'stackoverflow-pinia',
    'MEDIUM',
    '[
        {"solution": "Remove unnecessary getState getter and directly access store properties: store.pokemons instead of store.getState.pokemons", "percentage": 92, "note": "Simplifies access pattern"},
        {"solution": "Use computed() for filtered data: computed(() => store.pokemons.filter(p => p.name.includes(state.text)))", "percentage": 90, "note": "Reactive computed properties"},
        {"solution": "In actions, directly assign array results instead of push: store.pokemons = response.data.results", "percentage": 88, "note": "Avoids nested array structure"}
    ]'::jsonb,
    'Pinia store with pokemons array, Data from API response, Computed property understanding',
    'Getter returns filtered array, No undefined errors, Filter works correctly',
    'Do not use nested getter wrappers like getState - directly access store properties. Ensure data structure consistency when assigning array results.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/71452197/how-to-set-up-pinia-getter-in-vue-3-composition-api'
),
(
    'How to set the type for state object in Pinia with TypeScript',
    'stackoverflow-pinia',
    'HIGH',
    '[
        {"solution": "Use type assertion for undefined values: previousPieceSelected: undefined as Piece | undefined", "percentage": 95, "note": "Tells TypeScript to infer union type"},
        {"solution": "Define state interface and pass as generic: defineStore<''id'', StateType, GettersType, ActionsType>()", "percentage": 92, "note": "Explicit typing approach"},
        {"solution": "Use inline type casting with angle brackets: <MyType>{} for initialized objects", "percentage": 88, "note": "Alternative syntax"}
    ]'::jsonb,
    'TypeScript enabled in project, tsconfig.json configured, Pinia store created',
    'Type inference works correctly, No TypeScript errors, IDE autocomplete works',
    'Do not initialize optional properties as undefined without type assertion - TypeScript infers type as undefined only. Always use union types.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/69833591/how-to-set-the-type-for-the-state-object-in-pinia'
),
(
    'How to properly use Pinia store with Vue3 and TypeScript',
    'stackoverflow-pinia',
    'MEDIUM',
    '[
        {"solution": "Convert all .js files to .ts files in TypeScript projects (Vue files remain .vue)", "percentage": 93, "command": "Rename store.js to store.ts", "note": "Ensures consistent TypeScript module resolution"},
        {"solution": "Update tsconfig.json with proper settings: target esnext, module esnext, strict true", "percentage": 90, "note": "Critical for Pinia TS support"},
        {"solution": "Add lang=''ts'' attribute to script tags: <script lang=''ts''> and import Vue files with extensions", "percentage": 88, "note": "Explicit language declarations"}
    ]'::jsonb,
    'Vue 3 project setup, TypeScript 4.0+, Proper tsconfig.json configuration',
    'getActivePinia error resolves, Store initializes successfully, Types work without errors',
    'Mixing .js and .ts files causes module resolution issues. Convert entire codebase to TypeScript or keep all as JavaScript.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/74031224/how-do-i-properly-use-pinia-store-on-vue3-pinia-typescript'
),
(
    'Problems with Vue 3 and Pinia getters - readonly error',
    'stackoverflow-pinia',
    'MEDIUM',
    '[
        {"solution": "Create writable computed property with getter and setter that calls an action", "percentage": 93, "command": "const myComputed = computed({ get: () => getElementsForCurrentRole.value, set: (val) => updateRole(val) })", "note": "Enables two-way binding with actions"},
        {"solution": "Use action to update store state instead of trying to write to readonly getter", "percentage": 91, "note": "Respects Pinia architecture"},
        {"solution": "For v-model bindings, pair computed getter with action dispatch in setter", "percentage": 88, "note": "Pattern for drag-and-drop and similar patterns"}
    ]'::jsonb,
    'Pinia getter defined, Action for state update exists, Component with computed property',
    'v-model binding works without errors, State updates through action, No readonly violation',
    'Pinia getters are read-only computed properties. Do not attempt direct assignment. Always create computed properties with custom setters for mutations.',
    0.92,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/73743012/problems-with-vue-js-3-and-pinia-getters'
),
(
    'How to enforce state validation on Pinia store modification',
    'stackoverflow-pinia',
    'LOW',
    '[
        {"solution": "Use computed property with custom getter/setter to validate before modifying state", "percentage": 90, "command": "Use computed with get: () => ref.value, set: (val) => { if (validate(val)) ref.value = val }", "note": "Prevents invalid assignments"},
        {"solution": "Implement schema validation with Zod library and validate in watchers", "percentage": 82, "note": "Provides feedback after mutation attempt"},
        {"solution": "Create private ref for state and expose through computed with validation logic", "percentage": 85, "note": "Hides implementation details and enforces validation"}
    ]'::jsonb,
    'Pinia store created, Validation rules defined, Composition API composables',
    'Invalid values rejected with warning, Valid values update state, No direct state bypass possible',
    'Pinia allows direct state modification which can bypass validation. Use computed setters or action validation to enforce rules.',
    0.81,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/79352751/vue-pinia-how-to-validate-state-on-modification'
),
(
    'Vue 3 Pinia parent-child relationships with SignalR real-time updates',
    'stackoverflow-pinia',
    'LOW',
    '[
        {"solution": "Store only the child ID in parent store instead of full child object, use getter to resolve from child store", "percentage": 88, "note": "Eliminates duplicate instances and duplicate listeners"},
        {"solution": "Maintain references by ID rather than object references between stores", "percentage": 85, "note": "Prevents sync issues and data duplication"},
        {"solution": "Use single SignalR listener in child store, parent accesses via computed getter", "percentage": 82, "note": "Cleaner architecture for real-time updates"}
    ]'::jsonb,
    'Two separate Pinia stores for parent and child, SignalR connection established, Parent-child ID relationship',
    'Both objects update from single SignalR listener, No duplicate data instances, Clean store architecture',
    'Do not store full objects across store boundaries - store IDs and create getters to resolve relationships. This prevents sync issues.',
    0.79,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/79553275/vue-3-pinia-state-and-architecture-best-practices-for-parent-child-relationships'
);
