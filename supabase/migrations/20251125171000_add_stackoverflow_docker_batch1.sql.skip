-- Mining Stack Overflow top voted Docker questions/answers
-- Source: https://stackoverflow.com/questions/tagged/docker?tab=votes
-- Extracted: 12 highest voted Docker Q&A pairs with accepted answers

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'How is Docker different from a virtual machine?',
    'stackoverflow-docker',
    'HIGH',
    '[
        {"solution": "Docker uses Linux Containers (LXC/runC) that share the host operating system, while VMs require separate OS instances for each machine. Containers are lightweight and start in seconds, vs minutes for VMs.", "percentage": 95, "note": "Core architectural difference"},
        {"solution": "Containers use layered filesystem (AuFS) to share common OS components, reducing storage from 1GB per VM to minimal overhead across thousands of containers", "percentage": 90, "note": "Storage efficiency advantage"},
        {"solution": "Containers provide less isolation but use fewer resources; VMs offer full isolation with guaranteed resources. Choose containers for dev/test, VMs for high-isolation requirements.", "percentage": 85, "note": "Trade-offs consideration"}
    ]'::jsonb,
    'Basic understanding of virtualization concepts',
    'Can explain the difference between container architecture and virtual machine architecture',
    'Docker is not just a lightweight VM - it shares the host kernel. VMs do not require a host OS to run multiple guests.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/16047306/'
),
(
    'From inside of a Docker container, how do I connect to localhost?',
    'stackoverflow-docker',
    'VERY_HIGH',
    '[
        {"solution": "Use the special DNS name host.docker.internal instead of localhost: docker run --add-host=host.docker.internal:host-gateway myimage. Inside container, connect to host.docker.internal:port", "percentage": 95, "note": "Native solution for Docker Desktop Mac/Windows v18.03+"},
        {"solution": "In Docker Compose, add extra_hosts configuration: extra_hosts: [\"host.docker.internal:host-gateway\"]", "percentage": 93, "command": "extra_hosts:\\n      - \"host.docker.internal:host-gateway\""},
        {"solution": "On Linux, use --network=host flag to share host network stack: docker run --network=host myimage. Then localhost refers directly to host machine.", "percentage": 90, "note": "Linux-only, full network access"},
        {"solution": "For MySQL connections, use: mysql -h host.docker.internal -u root -p instead of localhost", "percentage": 88, "command": "mysql -h host.docker.internal -u root -p"}
    ]'::jsonb,
    'Docker running with network access, Host service listening on 0.0.0.0 or accessible network address',
    'Container successfully connects to host service, Port is accessible from container, No connection timeout errors',
    'Do not use 127.0.0.1 from container - it refers to container localhost. host.docker.internal does not work on plain Docker on Linux without --add-host flag.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/24319662/'
),
(
    'What is the difference between COPY and ADD in Dockerfile?',
    'stackoverflow-docker',
    'HIGH',
    '[
        {"solution": "COPY only copies files/directories from host to container. ADD has all COPY functionality plus supports URLs and automatically extracts tar archives. Docker recommends COPY for normal file copying.", "percentage": 95, "note": "Official Docker best practice"},
        {"solution": "Use ADD only when you need to extract local tar archives: ADD rootfs.tar.xz /", "percentage": 92, "command": "ADD rootfs.tar.xz /"},
        {"solution": "Do NOT use ADD for remote files. Instead use RUN curl/wget: RUN curl -SL http://example.com/file.tar.gz | tar -xC /usr/src/", "percentage": 90, "command": "RUN curl -SL http://example.com/file.tar.gz | tar -xC /usr/src/", "note": "Creates fewer layers, reduces image size"}
    ]'::jsonb,
    'Valid Dockerfile, Source files accessible on host',
    'Image builds successfully, Files are copied/extracted to correct location, Image size is minimal (if using RUN curl)',
    'Using ADD for remote packages creates unnecessary image layers. COPY is more transparent and preferred - always use COPY unless tar extraction is needed.',
    0.94,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/24958140/'
),
(
    'Copying files from Docker container to host',
    'stackoverflow-docker',
    'VERY_HIGH',
    '[
        {"solution": "Use docker cp command: docker cp <container_id>:/path/in/container /host/path/target. Get container name/ID from docker ps", "percentage": 96, "command": "docker cp goofy_roentgen:/out_read.jpg ."},
        {"solution": "Container does not need to be running. Works with running or stopped containers and for both files and directories", "percentage": 94, "note": "No container state requirement"},
        {"solution": "For symlinks, use -L flag to follow symlinks: docker cp -L <container_id>:/path /host/path", "percentage": 88, "command": "docker cp -L <container_id>:/path /host/path"}
    ]'::jsonb,
    'Docker installed and running, Valid container ID or name (from docker ps), Access to host filesystem',
    'File appears in host directory with correct content and permissions, docker ps shows container name/ID, Command returns without error',
    'Cannot use image ID, only container ID. Container must exist (even if stopped). Use docker ps to verify container ID or name.',
    0.96,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/22049212/'
),
(
    'What is the difference between CMD and ENTRYPOINT?',
    'stackoverflow-docker',
    'HIGH',
    '[
        {"solution": "ENTRYPOINT specifies the command that always executes when container starts. CMD provides default arguments to ENTRYPOINT. CMD gets overridden if user supplies arguments at runtime.", "percentage": 95, "note": "Fundamental Dockerfile behavior"},
        {"solution": "Example: ENTRYPOINT [\"/bin/ping\"] and CMD [\"localhost\"] means docker run test pings localhost (CMD default), but docker run test google.com pings google.com (CMD replaced).", "percentage": 93, "command": "ENTRYPOINT [\"/bin/ping\"]\\nCMD [\"localhost\"]"},
        {"solution": "Using only CMD means all arguments are replaced by user input. Use ENTRYPOINT to create a fixed executable behavior with CMD for flexible defaults.", "percentage": 90, "note": "Design pattern for container reusability"}
    ]'::jsonb,
    'Basic Dockerfile knowledge, Understanding of container entry points',
    'Container starts and executes expected command, Default arguments applied when no arguments provided, User arguments override CMD correctly',
    'Do not use only CMD if you want arguments to be appended rather than replaced. ENTRYPOINT creates the executable behavior, CMD provides defaults.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/21553353/'
),
(
    'How to copy files from host to Docker container?',
    'stackoverflow-docker',
    'VERY_HIGH',
    '[
        {"solution": "Use docker cp command: docker cp foo.txt container_id:/foo.txt. Works bidirectionally (host→container and container→host)", "percentage": 96, "command": "docker cp foo.txt container_id:/foo.txt"},
        {"solution": "For directories, use: docker cp src/. container_id:/target (note the dot notation for directory contents)", "percentage": 94, "command": "docker cp src/. container_id:/target"},
        {"solution": "Alternative: Mount volume at runtime and copy within container: docker run -v /host/path:/mnt myimage, then cp /mnt/file /destination inside", "percentage": 85, "note": "Useful for persistent file sharing"},
        {"solution": "Legacy workaround for Docker <1.8: Use stdin/stdout: docker exec -i container_id sh -c ''cat > ./file.txt'' < ./file.txt", "percentage": 80, "note": "Older Docker versions only"}
    ]'::jsonb,
    'Docker v1.8 or later (for cp), Container ID (from docker ps), Source files exist on host',
    'File appears in container at target location with correct content, docker cp returns without error, Container can access copied file',
    'container_id refers to running container, not image. Files are visible immediately in running container. Symlinks are not followed by default.',
    0.94,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/22907231/'
),
(
    'How do I get console access into a Docker container?',
    'stackoverflow-docker',
    'VERY_HIGH',
    '[
        {"solution": "Use docker exec for running containers: docker exec -it <container_id> bash (or sh for Alpine). -i keeps stdin connected, -t allocates pseudo-terminal", "percentage": 96, "command": "docker exec -it <container_id> bash"},
        {"solution": "For exited containers or creating new shell: docker run --rm -it --entrypoint /bin/bash <image_name>", "percentage": 92, "command": "docker run --rm -it --entrypoint /bin/bash <image_name>"},
        {"solution": "With docker-compose: docker-compose exec <service_name> bash", "percentage": 90, "command": "docker-compose exec <service_name> bash"},
        {"solution": "Find container ID/name from docker ps. Alpine-based images use sh not bash. Some minimal images have no shell - use docker inspect instead.", "percentage": 85, "note": "Container discovery and special cases"}
    ]'::jsonb,
    'Docker running, Container must be running for docker exec (or have image for docker run), Bash or sh available in image',
    'Shell prompt appears in terminal, Can execute commands inside container, Can exit with Ctrl+D or exit command',
    'docker exec only works on running containers. docker run --entrypoint overwrites the image ENTRYPOINT. Alpine images use sh, not bash.',
    0.96,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/30172605/'
),
(
    'How to copy Docker images between hosts without repository?',
    'stackoverflow-docker',
    'MEDIUM',
    '[
        {"solution": "Save and load method: On source: docker save -o /path/file.tar image_name. Transfer file. On destination: docker load -i /path/file.tar", "percentage": 95, "command": "docker save -o /path/file.tar image_name && docker load -i /path/file.tar", "note": "Use image name with tag, not image ID"},
        {"solution": "Direct SSH transfer with compression: docker save image_name | bzip2 | ssh user@host docker load (faster for network transfer)", "percentage": 92, "command": "docker save image_name | bzip2 | ssh user@host docker load", "note": "Try gzip for high-bandwidth, xz for best compression"},
        {"solution": "With progress monitoring: docker save image_name | bzip2 | pv | ssh user@host docker load", "percentage": 88, "command": "docker save image_name | bzip2 | pv | ssh user@host docker load"},
        {"solution": "Using DOCKER_HOST SSH: docker save app:1.0 | gzip | DOCKER_HOST=ssh://user@host docker load", "percentage": 85, "command": "DOCKER_HOST=ssh://user@remotehost docker load"}
    ]'::jsonb,
    'Docker installed on both machines, SSH access to destination host, Sufficient disk space for image tar file, SSH keys configured properly',
    'Image successfully saves to tar file, SSH transfer completes without errors, docker load finishes successfully, docker images shows imported image',
    'Use image name (not ID) to preserve repository/tag info. Compressed transfer (bzip2/gzip) is much faster for network. Ensure proper SSH key setup.',
    0.92,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/23935141/'
),
(
    'How to get a Docker container IP address from host?',
    'stackoverflow-docker',
    'HIGH',
    '[
        {"solution": "Modern syntax: docker inspect -f ''{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}'' container_id (Windows: use double quotes)", "percentage": 95, "command": "docker inspect -f ''{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}'' container_id", "note": "Works for single and multiple networks"},
        {"solution": "Legacy syntax for older Docker versions: docker inspect --format ''{{ .NetworkSettings.IPAddress }}'' container_id", "percentage": 90, "command": "docker inspect --format ''{{ .NetworkSettings.IPAddress }}'' container_id"},
        {"solution": "Simple grep approach (less precise): docker inspect <container_id> | grep \"IPAddress\"", "percentage": 85, "command": "docker inspect <container_id> | grep \"IPAddress\""},
        {"solution": "Get full network info: docker inspect <container_id> and locate IP under NetworkSettings section", "percentage": 80, "note": "See all network configuration"}
    ]'::jsonb,
    'Docker installed and running, Container must be running (not just image), Valid container ID or name',
    'Command returns IP address in correct format, Container responds to ping/connection at returned IP, Container running (docker ps shows it)',
    'Container must be running - stopped containers have no IP. Host networking mode shows empty IPAddress. Windows Docker Desktop may use DockerNAT IP.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/17157721/'
),
(
    'How do I pass environment variables to Docker containers?',
    'stackoverflow-docker',
    'VERY_HIGH',
    '[
        {"solution": "Use -e flag: docker run -e VARIABLE_NAME=value image_name. For multiple: docker run -e VAR1=val1 -e VAR2=val2 image_name", "percentage": 96, "command": "docker run -e VAR1=value1 -e VAR2=value2 image_name"},
        {"solution": "Environment file method (more secure): docker run --env-file ./env.list image_name. File format: KEY=VALUE lines, no quotes needed", "percentage": 93, "command": "docker run --env-file ./env.list image_name", "note": "Credentials invisible in process lists"},
        {"solution": "Inherit from host environment: docker run -e MY_VAR=$MY_VAR image_name (first export MY_VAR in shell)", "percentage": 90, "command": "export MY_VAR=value && docker run -e MY_VAR=$MY_VAR image_name"},
        {"solution": "In Docker Compose, use environment section: environment: [\"DATABASE_URL=${DATABASE_URL}\"] or environment: - VAR=value", "percentage": 88, "command": "environment:\\n      - DATABASE_URL=${DATABASE_URL}"}
    ]'::jsonb,
    'Docker installed and running, Environment variables defined or env.list file created, Target image available',
    'Environment variables accessible inside container via env command, Application can read variables, docker inspect shows Variables section populated',
    'Place -e flags BEFORE image name, not after. Using env file is more secure than command line (credentials invisible in ps output). Quotes usually not needed in env file.',
    0.96,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/30494050/'
),
(
    'Should I use Vagrant or Docker for isolated environments?',
    'stackoverflow-docker',
    'MEDIUM',
    '[
        {"solution": "Use Docker for development/testing isolation: lightweight containers, seconds to start, share host kernel, easier deployment. Use when you need fast iteration.", "percentage": 92, "note": "Container-based isolation"},
        {"solution": "Use Vagrant (VMs) for complete OS isolation: full Linux/Windows/Mac instances, guaranteed resources, no kernel sharing. Use when you need separate OS environments.", "percentage": 90, "note": "Full virtual machine isolation"},
        {"solution": "Docker is better for microservices and cloud deployment. Vagrant better for complex multi-OS environments or when you need full system-level isolation.", "percentage": 88, "note": "Use case analysis"},
        {"solution": "Modern approach: Use Docker for local development, Vagrant for complex testing requirements. They are complementary, not mutually exclusive.", "percentage": 85, "note": "Combined approach"}
    ]'::jsonb,
    'Understanding of containerization vs virtualization, Project isolation requirements defined',
    'Development environment provisions quickly, Isolated environments do not interfere with each other, Can reproduce environment on different machines',
    'Docker is not a VM replacement for all use cases. Cannot run different OS kernels in containers. Vagrant is heavier but offers true OS-level isolation.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/16647069/'
),
(
    'How do I pass environment variables to Docker containers?',
    'stackoverflow-docker',
    'HIGH',
    '[
        {"solution": "Force clean build by disabling Docker cache: docker build --no-cache -t image_name . (rebuilds all layers)", "percentage": 94, "command": "docker build --no-cache -t image_name ."},
        {"solution": "Remove image before rebuilding: docker rmi image_name && docker build -t image_name . (forces complete rebuild)", "percentage": 92, "command": "docker rmi image_name && docker build -t image_name ."},
        {"solution": "Clear Docker build cache entirely: docker builder prune (removes all unused build cache)", "percentage": 85, "command": "docker builder prune"},
        {"solution": "Target specific layer to bypass cache: Use --cache-from flag to control which images are used as cache source", "percentage": 80, "command": "docker build --cache-from myimage -t myimage ."}
    ]'::jsonb,
    'Docker installed and running, Dockerfile exists, Sufficient disk space',
    'Image rebuilds all layers without using cache, Build output shows no cached steps, Image has latest content from Dockerfile',
    'Using --no-cache rebuilds everything and is slower. Normal builds use cache which is usually desired. Docker cache is safe for rebuilds.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/35594987/'
);
