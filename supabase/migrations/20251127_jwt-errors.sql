INSERT INTO knowledge_entries (query, category, hit_frequency, solutions, prerequisites, success_indicators, common_pitfalls, success_rate, claude_version, last_verified, source_url, contributor_email) VALUES
('JsonWebTokenError: jwt must be provided', 'authentication', 'CRITICAL', '[{"solution": "Ensure Authorization header has value of Bearer <token>", "percentage": 98}, {"solution": "Check req.body.token, req.query.token, or req.headers[x-access-token] is not null", "percentage": 95}]'::jsonb, 'Express/Node.js, jsonwebtoken library', 'Token verified successfully without error', 'Passing null/empty token to jwt.verify()', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/48476625', 'admin:1764225123'),
('TokenExpiredError: jwt expired', 'authentication', 'CRITICAL', '[{"solution": "Check token expiration time with exp claim", "percentage": 96}, {"solution": "Refresh token or request new one from auth server", "percentage": 94}]'::jsonb, 'JWT token with exp claim', 'New valid token obtained', 'Not checking token expiration before use', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/55950941', 'admin:1764225123'),
('JsonWebTokenError: invalid signature', 'authentication', 'CRITICAL', '[{"solution": "Verify secret/key matches the one used to sign token", "percentage": 97}, {"solution": "For RS256, ensure public key format includes BEGIN/END markers", "percentage": 95}]'::jsonb, 'JWT library, signing key/secret', 'Signature validation passes with correct key', 'Using wrong key for algorithm type, RSA key format errors', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/46570389', 'admin:1764225123'),
('JsonWebTokenError: jwt malformed', 'authentication', 'CRITICAL', '[{"solution": "Ensure token has exactly 3 parts separated by dots (header.payload.signature)", "percentage": 98}, {"solution": "Validate token encoding is base64url", "percentage": 92}]'::jsonb, 'Valid JWT structure', 'Token decodes successfully', 'Passing invalid base64, missing segments, corrupted token', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/51849010', 'admin:1764225123'),
('UnauthorizedError: jwt audience invalid. expected: projectapi', 'authentication', 'HIGH', '[{"solution": "Add ValidAudience or audience claim in token matching API name", "percentage": 94}, {"solution": "Ensure audience is consistent across client, server, and token issuer config", "percentage": 91}]'::jsonb, 'JWT library with aud claim validation', 'Token passes audience validation', 'Mismatched aud claim value, empty audience config', 0.92, 'haiku', NOW(), 'https://stackoverflow.com/questions/63513967', 'admin:1764225123'),
('invalid_token: The audience is invalid', 'authentication', 'HIGH', '[{"solution": "Verify ValidAudience matches aud claim in JWT", "percentage": 93}, {"solution": "Check API resource name matches audience claim", "percentage": 92}]'::jsonb, 'IdentityServer/ASP.NET Core, JWT validation', 'Request proceeds with valid audience', 'Audience mismatch in config or token', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/44909140', 'admin:1764225123'),
('Bearer error="invalid_token", error_description="The issuer is invalid"', 'authentication', 'HIGH', '[{"solution": "Set ValidIssuer in TokenValidationParameters to match iss claim", "percentage": 95}, {"solution": "Ensure issuer URL is exactly same in token and validation config", "percentage": 93}]'::jsonb, 'ASP.NET Core JWT, issuer configuration', 'Token validates with correct issuer', 'Missing ValidIssuer property, issuer URL mismatch', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/60709364', 'admin:1764225123'),
('MissingClaimException: Expected iss claim to be: mycompany', 'authentication', 'MEDIUM', '[{"solution": "Use setClaims() after setting issuer or use addClaims()", "percentage": 92}, {"solution": "Ensure setIssuer() is called last before signing", "percentage": 89}]'::jsonb, 'JJWT library, issuer claim setup', 'Issuer claim present in token', 'Overwriting issuer with setClaims(), claim order issues', 0.90, 'haiku', NOW(), 'https://stackoverflow.com/questions/54347979', 'admin:1764225123'),
('Error parsing token: Token used before issued', 'authentication', 'MEDIUM', '[{"solution": "Use UnixMilli() for milliseconds, Unix() for seconds in iat claim", "percentage": 94}, {"solution": "Add clock skew leeway for server time drift", "percentage": 88}]'::jsonb, 'JWT library with iat claim validation', 'Token accepted after iat/exp time correction', 'Milliseconds vs seconds mismatch, clock skew', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/60480824', 'admin:1764225123'),
('NotBeforeError: jwt used before valid', 'authentication', 'MEDIUM', '[{"solution": "Use 401 status code (not 403) for token not yet valid", "percentage": 89}, {"solution": "Check nbf claim time is before current time", "percentage": 87}]'::jsonb, 'JWT with nbf (not before) claim', 'Token accepted after nbf time passed', 'Incorrect HTTP status code, time synchronization', 0.88, 'haiku', NOW(), 'https://stackoverflow.com/questions/75330801', 'admin:1764225123'),
('JsonWebTokenError: invalid algorithm', 'authentication', 'MEDIUM', '[{"solution": "Specify algorithms array in verify options: algorithms: [''RS256'']", "percentage": 96}, {"solution": "For RS256, use asymmetric key with BEGIN CERTIFICATE/PUBLIC KEY headers", "percentage": 94}]'::jsonb, 'JWT library with RS256/HS256', 'Token validates with correct algorithm', 'Missing algorithms option, wrong key format for algorithm', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/47119043', 'admin:1764225123'),
('secretOrPrivateKey must be an asymmetric key when using RS256', 'authentication', 'HIGH', '[{"solution": "Use RSA private key in PEM format for signing RS256 tokens", "percentage": 96}, {"solution": "Convert string key to Key object via PKCS8EncodedKeySpec", "percentage": 93}]'::jsonb, 'Node.js/Java JWT library, RSA keys', 'RS256 token signed successfully', 'Using string instead of Key object, wrong key type', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/76358141', 'admin:1764225123'),
('InvalidAlgorithmError: Algorithm not supported', 'authentication', 'MEDIUM', '[{"solution": "Install PyJWT with crypto support: pip install pyjwt[crypto]", "percentage": 97}, {"solution": "Ensure cryptography package installed in virtual environment", "percentage": 94}]'::jsonb, 'PyJWT library, cryptography dependency', 'RS256/ES256 tokens decode successfully', 'Missing crypto dependencies, virtual environment cache', 0.96, 'haiku', NOW(), 'https://stackoverflow.com/questions/67602828', 'admin:1764225123'),
('Signed JWT rejected: Another algorithm expected', 'authentication', 'MEDIUM', '[{"solution": "Check JWT header alg matches token signing algorithm", "percentage": 92}, {"solution": "Verify JwtDecoder algorithm matches token alg claim", "percentage": 90}]'::jsonb, 'Spring Security, JWT decoder', 'Token validates with matching algorithm', 'Algorithm mismatch in header, wrong decoder config', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/56638408', 'admin:1764225123'),
('ERR_OSSL_PEM_NO_START_LINE: no start line', 'authentication', 'HIGH', '[{"solution": "Use certificate from Google OAuth .well-known/openid-configuration/jwks endpoint", "percentage": 94}, {"solution": "Replace \\n with actual newlines in PEM certificate", "percentage": 96}]'::jsonb, 'Google OAuth, Node.js JWT verification', 'OAuth token verified successfully', 'Using wrong secret key, incorrect PEM formatting', 0.95, 'haiku', NOW(), 'https://stackoverflow.com/questions/72863245', 'admin:1764225123'),
('invalid_id_token: The ID Token contains invalid claims', 'authentication', 'HIGH', '[{"solution": "Validate aud claim matches application ID/client ID", "percentage": 93}, {"solution": "Check server time is synchronized (within 5 minutes)", "percentage": 89}]'::jsonb, 'Azure AD, Spring Boot OAuth', 'ID token validates with correct claims', 'aud claim mismatch, system clock drift', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/72540925', 'admin:1764225123'),
('Token contains an invalid number of segments', 'authentication', 'MEDIUM', '[{"solution": "Verify token has exactly 3 base64url parts separated by dots", "percentage": 98}, {"solution": "Check for extra whitespace or formatting in token", "percentage": 95}]'::jsonb, 'JWT parsing library', 'Token splits into 3 valid base64url parts', 'Corrupted token transmission, whitespace in token', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/63123951', 'admin:1764225123'),
('jwt doesn''t contain iss claim', 'authentication', 'LOW', '[{"solution": "Include iss claim in token payload during creation", "percentage": 96}, {"solution": "Create custom JWT validator if iss claim optional", "percentage": 78}]'::jsonb, 'JWT token generation', 'Issuer claim present in all tokens', 'Skipping issuer during token creation', 0.87, 'haiku', NOW(), 'https://stackoverflow.com/questions/75004159', 'admin:1764225123'),
('UnauthorizedError: jwt audience invalid', 'authentication', 'HIGH', '[{"solution": "Add ApiResource with matching audience name in IdentityServer config", "percentage": 93}, {"solution": "Ensure scopes match between client and API resource", "percentage": 91}]'::jsonb, 'IdentityServer4, Express JWT', 'Token passes audience and scope validation', 'Missing API resource definition, scope mismatch', 0.92, 'haiku', NOW(), 'https://stackoverflow.com/questions/63513967', 'admin:1764225123'),
('Base64-encoded key bytes may only be specified for HMAC signatures', 'authentication', 'MEDIUM', '[{"solution": "Use PKCS8EncodedKeySpec and KeyFactory.getInstance(RSA) for RS256", "percentage": 95}, {"solution": "Convert string PEM key to Key object before passing to signWith()", "percentage": 94}]'::jsonb, 'JJWT library, RSA signatures', 'RS256 token generated without error', 'Passing string instead of Key object', 0.94, 'haiku', NOW(), 'https://stackoverflow.com/questions/70574331', 'admin:1764225123'),
('Bearer error="invalid_token", error_description="The audience is invalid"', 'authentication', 'HIGH', '[{"solution": "Match ApiName in IdentityServerAuthenticationOptions to aud claim", "percentage": 92}, {"solution": "Configure audience consistently in 4 places: client, API, IdentityServer resources, and API scopes", "percentage": 90}]'::jsonb, 'IdentityServer4, .NET Core', 'Token passes audience validation', 'Audience configuration mismatch across layers', 0.91, 'haiku', NOW(), 'https://stackoverflow.com/questions/44909140', 'admin:1764225123'),
('Failed to authenticate token: Wrong number of segments', 'authentication', 'MEDIUM', '[{"solution": "Ensure token has 3 parts: header.payload.signature", "percentage": 98}, {"solution": "Check token wasn''t truncated or corrupted during transmission", "percentage": 96}]'::jsonb, 'Express JWT, Node.js', 'Token parses correctly with 3 segments', 'Token corruption, incomplete transmission', 0.97, 'haiku', NOW(), 'https://stackoverflow.com/questions/76399791', 'admin:1764225123'),
('IDX10500: Signature validation failed. Unable to resolve SecurityKeyIdentifier', 'authentication', 'MEDIUM', '[{"solution": "Retrieve JWK from issuer .well-known/jwks endpoint", "percentage": 91}, {"solution": "Configure IssuerSigningKeyResolver to fetch keys dynamically", "percentage": 88}]'::jsonb, 'ASP.NET Core, Office 365 JWT', 'Token validates with correct signing key', 'Unable to retrieve issuer keys, missing JWKS endpoint', 0.89, 'haiku', NOW(), 'https://stackoverflow.com/questions/72911342', 'admin:1764225123');
