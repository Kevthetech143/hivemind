-- Add Stack Overflow Git top voted questions/answers batch 1
-- Extracted: 12 highest voted Git Q&A pairs from https://stackoverflow.com/questions/tagged/git?tab=votes

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES
(
    'How do I undo the most recent local commits in Git?',
    'stackoverflow-git',
    'VERY_HIGH',
    '[
        {"solution": "Use git reset HEAD~1 to move HEAD back one commit while preserving your files and modifications", "percentage": 95, "command": "git reset HEAD~1", "note": "Most common use case for undoing unpushed commits"},
        {"solution": "Use git reset --soft HEAD~1 to keep changes staged for immediate recommit", "percentage": 90, "command": "git reset --soft HEAD~1", "note": "Preserves both files and staging index"},
        {"solution": "Use git reset --hard HEAD~1 to permanently destroy both the commit and all modifications", "percentage": 85, "command": "git reset --hard HEAD~1", "note": "Irreversible - use only when certain"},
        {"solution": "If commit is already pushed, use git revert instead of reset to avoid disrupting teammates", "percentage": 80, "note": "Revert creates new commit, reset rewrites history"}
    ]'::jsonb,
    'Local unpushed commits, Git repository initialized',
    'git log shows correct number of commits, git status clean, working directory unchanged',
    'Do not use reset on published commits - it rewrites history. For pushed commits use git revert. Reflog recovers deleted commits within 90 days via git reflog and git checkout -b recovery-branch <sha>',
    0.92,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/927358/how-do-i-undo-the-most-recent-local-commits-in-git'
),
(
    'How do I delete a Git branch locally and remotely?',
    'stackoverflow-git',
    'VERY_HIGH',
    '[
        {"solution": "Delete remote branch using git push origin --delete <branch_name> or git push origin -d <branch_name> for Git 2.8.0+", "percentage": 95, "command": "git push origin -d <branch_name>", "note": "Removes branch from server"},
        {"solution": "Delete local branch using git branch -d <branch_name> for safe deletion with merge checks", "percentage": 93, "command": "git branch -d <branch_name>", "note": "Warns if unmerged changes exist"},
        {"solution": "Use git branch -D to force delete local branch without merge checks", "percentage": 85, "command": "git branch -D <branch_name>", "note": "Dangerous - use only if certain"},
        {"solution": "On other machines, sync with git fetch --all --prune or git fetch origin --prune to remove stale tracking branches", "percentage": 90, "command": "git fetch origin --prune", "note": "Cleans up remote-tracking references"}
    ]'::jsonb,
    'Git repository with local and remote branches',
    'git branch -a no longer shows the deleted branch, git branch shows updated local list',
    'Just using git branch -d origin/branch only deletes local tracking reference, not actual remote. Must use git push origin --delete. The --prune flag is essential for syncing other machines.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/2003505/how-do-i-delete-a-git-branch-locally-and-remotely'
),
(
    'What is the difference between git pull and git fetch?',
    'stackoverflow-git',
    'VERY_HIGH',
    '[
        {"solution": "git fetch retrieves updates from remote and stores them locally in remote-tracking branches (origin/main) without modifying working files", "percentage": 95, "command": "git fetch", "note": "Distributed model - local copy of remote state"},
        {"solution": "git pull performs git fetch followed by automatic merge into current branch", "percentage": 94, "command": "git pull", "note": "Combines two operations"},
        {"solution": "Use git fetch to review changes before integrating them, avoiding disruption to current work", "percentage": 90, "note": "Better for cautious developers"},
        {"solution": "git pull merges immediately without letting you inspect changes first", "percentage": 85, "note": "Faster but riskier for collaborative work"}
    ]'::jsonb,
    'Git repository with remote tracking branch setup',
    'git log shows latest remote changes, git status reflects merged state vs unmerged',
    'Confusing fetch as complete update - it only updates remote-tracking branches. Local branch unchanged. Merge happens separately with pull.',
    0.94,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/292357/what-is-the-difference-between-git-pull-and-git-fetch'
),
(
    'How can I rename a local Git branch?',
    'stackoverflow-git',
    'HIGH',
    '[
        {"solution": "Use git branch -m <newname> to rename the currently checked out branch", "percentage": 95, "command": "git branch -m <newname>", "note": "Simplest for current branch"},
        {"solution": "Use git branch -m <oldname> <newname> to rename any branch without checking it out", "percentage": 93, "command": "git branch -m feature old-name new-name", "note": "Specify both old and new names"},
        {"solution": "Use git branch -M <newname> with capital M for case-sensitivity changes on Windows or case-insensitive filesystems", "percentage": 90, "command": "git branch -M newname", "note": "Only needed for capitalization changes"},
        {"solution": "After local rename, push new branch (git push origin -u <newname>) and delete old remote (git push origin --delete <oldname>)", "percentage": 88, "command": "git push origin -u newname && git push origin --delete oldname", "note": "Required if branch was previously pushed"}
    ]'::jsonb,
    'Git repository with unpushed local branch',
    'git branch shows new branch name, git log shows correct history',
    'Renaming only works locally initially. Must push new name and delete old remote branch separately. Can create git alias: git config --global alias.rename "branch -m"',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/6591213/how-can-i-rename-a-local-git-branch'
),
(
    'How do I undo git add before commit?',
    'stackoverflow-git',
    'VERY_HIGH',
    '[
        {"solution": "Use git reset <file> to unstage a specific file from the staging area", "percentage": 96, "command": "git reset <file>", "note": "Works with modern Git (1.8.2+)"},
        {"solution": "Use git reset with no arguments to unstage all files", "percentage": 94, "command": "git reset", "note": "Unstages everything in index"},
        {"solution": "For initial repository before first commit, git rm --cached <file> prevents tracking new files", "percentage": 85, "command": "git rm --cached <file>", "note": "Alternative for new repos"},
        {"solution": "Changes remain in working directory - only removed from staging area for commit", "percentage": 93, "note": "Non-destructive operation"}
    ]'::jsonb,
    'Git repository with staged files, Git 1.8.2 or later recommended',
    'git status shows file as untracked or modified (not staged for commit), no changes lost',
    'Thinking git reset deletes files - it does not, only removes from staging. For actual file deletion use git clean. Old Git syntax required HEAD reference.',
    0.95,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/348170/how-do-i-undo-git-add-before-commit'
),
(
    'How do I force git pull to overwrite local files?',
    'stackoverflow-git',
    'HIGH',
    '[
        {"solution": "Run git fetch --all to fetch all remote updates", "percentage": 90, "command": "git fetch --all", "note": "First step - gets latest remote state"},
        {"solution": "Create backup branch before destructive operation: git branch backup-main", "percentage": 88, "command": "git branch backup-main", "note": "Safety measure - optional but recommended"},
        {"solution": "Use git reset --hard origin/main to discard all uncommitted modifications and align working directory with remote", "percentage": 92, "command": "git reset --hard origin/main", "note": "Replace main with actual branch name"},
        {"solution": "For preserving uncommitted changes: git stash, then git reset --hard origin/main, then git stash pop", "percentage": 85, "command": "git stash && git reset --hard origin/main && git stash pop", "note": "Prevents data loss"}
    ]'::jsonb,
    'Git repository with remote tracking setup, all changes committed or stashed',
    'git status clean, working directory matches remote, git log shows remote commits',
    'Uncommitted changes are permanently lost with --hard reset. No backup. Must stash first if preserving changes. Replace main with correct branch name.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/1125968/how-do-i-force-git-pull-to-overwrite-local-files'
),
(
    'How can I check out a remote Git branch?',
    'stackoverflow-git',
    'HIGH',
    '[
        {"solution": "For Git 2.23+: Run git fetch, then git switch <branch_name> to create and checkout local tracking branch", "percentage": 93, "command": "git fetch && git switch test", "note": "Modern preferred method"},
        {"solution": "With multiple remotes use git switch -c <local_branch> <remote>/<branch>", "percentage": 90, "command": "git fetch origin && git switch -c test origin/test", "note": "Explicit remote specification"},
        {"solution": "For older Git versions use git checkout -b <local_branch> <remote>/<branch>", "percentage": 88, "command": "git checkout -b test origin/test", "note": "Legacy syntax for Git < 2.23"},
        {"solution": "Remote branches are read-only copies in remotes/* namespace - must create local tracking branch", "percentage": 85, "note": "Key concept: remote branches are references only"}
    ]'::jsonb,
    'Git repository with remote setup, git fetch executed',
    'git status shows tracking branch, git log shows remote commits, can edit files in branch',
    'Forgetting git fetch first - causes error that Git cannot resolve remote branch. Remote branches must be fetched before checkout. Must use -b flag to create local tracking branch.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/1783405/how-can-i-check-out-a-remote-git-branch'
),
(
    'How do I make Git forget about a file that was tracked but is now in .gitignore?',
    'stackoverflow-git',
    'HIGH',
    '[
        {"solution": "Use git rm --cached <file> to remove file from index while keeping it in working directory", "percentage": 94, "command": "git rm --cached <file>", "note": "File persists locally but stops being tracked"},
        {"solution": "For directories use git rm -r --cached <folder> to recursively untrack", "percentage": 93, "command": "git rm -r --cached folder", "note": "Removes entire directory tree from tracking"},
        {"solution": "File removal happens on next commit - deleted from version control after commit", "percentage": 90, "note": "Non-immediate - requires commit"},
        {"solution": "For preserving file locally without deletion on other machines, use git update-index --skip-worktree instead", "percentage": 75, "command": "git update-index --skip-worktree <file>", "note": "Alternative approach for shared repos"}
    ]'::jsonb,
    'File already tracked in Git, .gitignore rule added',
    'git status shows deleted file, next commit removes from tracking, future changes ignored',
    'Adding to .gitignore does not untrack already-tracked files. File will be deleted from teammates machines when they pull. Use skip-worktree to prevent team file deletions.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/1274057/how-do-i-make-git-forget-about-a-file-that-was-tracked-but-is-now-in-gitignore'
),
(
    'How do I remove local untracked files from the current Git working tree?',
    'stackoverflow-git',
    'HIGH',
    '[
        {"solution": "Preview deletion first with git clean -n -d to show what would be deleted without executing", "percentage": 94, "command": "git clean -n -d", "note": "Always preview first - files are permanently deleted"},
        {"solution": "Execute removal with git clean -f -d where -f forces deletion and -d includes directories", "percentage": 93, "command": "git clean -f -d", "note": "Removes untracked files and empty directories"},
        {"solution": "Use git clean -i -d for interactive selection of files to remove", "percentage": 80, "command": "git clean -i -d", "note": "Manual approval for each file"},
        {"solution": "Add -x flag to include files normally ignored by .gitignore, -X removes only ignored files", "percentage": 85, "command": "git clean -f -d -x", "note": "Use with caution on ignored build artifacts"}
    ]'::jsonb,
    'Git repository with untracked files to remove',
    'git status shows only tracked files, untracked files gone, working directory clean',
    'Forgetting -f flag - Git refuses to run without it. Files permanently deleted - no recovery. Always preview with -n first. -x includes ignored files which may be needed.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/61212/how-do-i-remove-local-untracked-files-from-the-current-git-working-tree'
),
(
    'How to modify existing unpushed commit messages?',
    'stackoverflow-git',
    'HIGH',
    '[
        {"solution": "For the most recent commit use git commit --amend to open editor for message modification", "percentage": 95, "command": "git commit --amend", "note": "Simplest for latest commit"},
        {"solution": "Supply message directly with git commit --amend -m \"new message\" without editor", "percentage": 93, "command": "git commit --amend -m \"Your new message\"", "note": "Faster non-interactive approach"},
        {"solution": "For older commits use interactive rebase git rebase -i HEAD~n (n = number of commits back)", "percentage": 88, "command": "git rebase -i HEAD~3", "note": "Change pick to reword to edit message"},
        {"solution": "If already pushed, amend locally then force-push with git push <remote> <branch> --force-with-lease", "percentage": 75, "command": "git push origin main --force-with-lease", "note": "Safer than --force in shared repos"}
    ]'::jsonb,
    'Git repository with unpushed commits, no staged changes before amend',
    'git log shows new message, previous commit hash changes, commit reflects correct content',
    'Staged changes included in amendment if not committed first. Force-push rewrites history and disrupts collaborators. Use --force-with-lease for safety. Ensure no staged changes before amending.',
    0.87,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/179123/how-to-modify-existing-unpushed-commit-messages'
),
(
    'How do I revert a Git repository to a previous commit?',
    'stackoverflow-git',
    'HIGH',
    '[
        {"solution": "For temporary viewing, use git checkout <commit-sha> to detach HEAD at that commit", "percentage": 90, "command": "git checkout 0d1d7fc32", "note": "Non-destructive - read-only mode"},
        {"solution": "Create branch at past commit with git checkout -b <branch> <commit-sha> for experimental work", "percentage": 88, "command": "git checkout -b old-state 0d1d7fc32", "note": "Safe experimentation without losing history"},
        {"solution": "For unpublished commits use destructive git reset --hard <commit-sha>", "percentage": 85, "command": "git reset --hard 0d1d7fc32", "note": "Irreversible - only for private branches"},
        {"solution": "For published commits use git revert --no-commit <commit-sha>..HEAD then git commit to create new commits that undo changes", "percentage": 87, "command": "git revert --no-commit 0d1d7fc32..HEAD", "note": "Preserves complete history for shared repos"}
    ]'::jsonb,
    'Git repository with commit history, knowledge of target commit SHA',
    'git log shows correct history preserved, working directory at target commit state, git status appropriate for operation type',
    'Using reset on published commits breaks shared history. Use revert for public branches. Confusing temporary checkout with permanent revert. Hard reset loses all changes - stash first if uncertain.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/4114095/how-do-i-revert-a-git-repository-to-a-previous-commit'
),
(
    'How do I change the URI (URL) for a remote Git repository?',
    'stackoverflow-git',
    'MEDIUM',
    '[
        {"solution": "View current remotes with git remote -v to confirm before changing", "percentage": 95, "command": "git remote -v", "note": "Always verify current state first"},
        {"solution": "Update URL with git remote set-url origin <NEW_GIT_URL_HERE>", "percentage": 96, "command": "git remote set-url origin https://github.com/new/repo.git", "note": "Direct and safe approach"},
        {"solution": "Verify change with git remote -v after updating", "percentage": 93, "command": "git remote -v", "note": "Confirmation step"},
        {"solution": "Alternative: Edit .git/config file directly and modify [remote \"origin\"] section URL entry", "percentage": 75, "command": "vim .git/config", "note": "Manual approach - less reliable"}
    ]'::jsonb,
    'Git repository with existing remote, access to new repository URL',
    'git remote -v shows new URL, git push/pull works to new remote, full history preserved',
    'Concerns about losing history unfounded - local repo maintains full history regardless of remote URL. Changing remote is safe. Alternative .git/config editing is error-prone.',
    0.96,
    'sonnet-4',
    NOW(),
    'https://stackoverflow.com/questions/2432764/how-do-i-change-the-uri-url-for-a-remote-git-repository'
);
