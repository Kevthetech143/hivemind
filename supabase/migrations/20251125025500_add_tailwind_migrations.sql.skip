-- Add Tailwind CSS upgrade guide migration entries

INSERT INTO knowledge_entries (
    query, category, hit_frequency, solutions, prerequisites, success_indicators,
    common_pitfalls, success_rate, claude_version, last_verified, source_url
) VALUES (
    'Tailwind 3→4: CSS Import syntax change from @tailwind directives',
    'frontend-framework',
    'VERY_HIGH',
    '[
        {"solution": "Replace @tailwind directives with @import \"tailwindcss\" in your CSS entry point", "percentage": 95, "note": "Official recommended approach for v4 CSS-first config"},
        {"solution": "Update postcss.config.mjs to use @tailwindcss/postcss plugin instead of tailwindcss", "percentage": 90, "command": "export default { plugins: { \"@tailwindcss/postcss\": {} } };"},
        {"solution": "For Vite projects, use the official Tailwind Vite plugin instead of PostCSS", "percentage": 95, "command": "npm install -D @tailwindcss/vite && add to vite.config.ts"},
        {"solution": "Update CLI command from tailwindcss CLI to @tailwindcss/cli if using standalone CLI", "percentage": 85, "command": "npx @tailwindcss/cli -i input.css -o output.css"}
    ]'::jsonb,
    'Tailwind CSS v3 project, CSS entry point file, Node.js 20+',
    'Build completes without @tailwind directive errors, Styles properly compiled in output',
    'Do not mix old @tailwind directives with new @import syntax. Update all CSS files consistently. PostCSS v8+ required.',
    0.93,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Utility class renames - shadow, outline, ring defaults',
    'frontend-framework',
    'VERY_HIGH',
    '[
        {"solution": "Use automated upgrade tool: npx @tailwindcss/upgrade to handle class renames automatically", "percentage": 95, "note": "Safest approach - reviews all changes before applying", "command": "npx @tailwindcss/upgrade"},
        {"solution": "Manually rename: shadow-sm → shadow-xs, shadow → shadow-sm, outline-none → outline-hidden, ring (3px) → ring-3", "percentage": 85, "note": "For fine-grained control over specific changes"},
        {"solution": "Update default ring width from 3px to 1px with ring-1 or use ring-3 for old behavior", "percentage": 90, "command": "Replace ring class with ring-1 or ring-3"},
        {"solution": "Run find/replace across codebase: find . -name \"*.html\" -type f -exec sed -i \"\" \"s/shadow-sm/shadow-xs/g\" {} +", "percentage": 80, "command": "find . -name \"*.{html,tsx,jsx,vue}\" -type f -exec sed -i \"\" \"s/shadow-sm/shadow-xs/g\" {} +"}
    ]'::jsonb,
    'Tailwind CSS v3 project with HTML/JSX files, Find/replace tool or IDE with regex support',
    'No build errors from unknown utility classes, Visual inspection confirms shadow/outline/ring styling unchanged',
    'The upgrade tool modifies files in-place. Test thoroughly in new branch before merging. Not all files may be detected by automated tool.',
    0.92,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Default color changes - border, ring, and button defaults',
    'frontend-framework',
    'HIGH',
    '[
        {"solution": "Update default border color from gray-200 to currentColor - add explicit border-gray-200 where needed", "percentage": 90, "note": "currentColor inherits text color - may require explicit color specification"},
        {"solution": "Ring color changed from blue-500 to currentColor - use ring-blue-500 for old behavior", "percentage": 90, "command": "Replace ring with ring ring-blue-500 where blue ring was expected"},
        {"solution": "Button cursor changed from pointer to default - use cursor-pointer on buttons if needed", "percentage": 85, "note": "Most applications prefer default cursor for buttons"},
        {"solution": "Add color classes explicitly: border-gray-200, ring-blue-500 to preserve v3 appearance", "percentage": 88}
    ]'::jsonb,
    'Tailwind CSS v3 project with borders and rings in use',
    'Visual inspection shows borders/rings with correct colors, No console errors about undefined colors',
    'The color changes are CSS-only and won''t cause build errors - visual inspection required. Test in all themes (light/dark).',
    0.88,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Opacity utilities removed - use slash notation instead',
    'frontend-framework',
    'HIGH',
    '[
        {"solution": "Replace bg-opacity-50 syntax with slash notation: bg-black/50 for 50% opacity background", "percentage": 95, "note": "Standard modern approach supported in v4"},
        {"solution": "For text opacity: text-white/75 instead of text-white text-opacity-75", "percentage": 95, "command": "Replace text-opacity-* with /[opacity-value]"},
        {"solution": "Arbitrary opacity: use bg-[color]/[opacity] format like bg-[#ff0000]/50 for custom colors", "percentage": 90},
        {"solution": "Use IDE find/replace: Match \"(bg|text|border|ring)-(\\w+)-opacity-(\\d+)\" and replace with appropriate slash notation", "percentage": 85}
    ]'::jsonb,
    'Tailwind CSS v3 project using opacity utilities, Text editor with regex support',
    'Build succeeds without opacity utility errors, Opacity effects visible on backgrounds/text as expected',
    'Slash notation must come at end of class name. Not all utilities support opacity - check Tailwind v4 docs for your specific utility.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Flex grow/shrink utilities renamed',
    'frontend-framework',
    'MEDIUM',
    '[
        {"solution": "Replace flex-grow-* with grow-* and flex-shrink-* with shrink-* classes", "percentage": 95, "note": "Direct 1:1 mapping from v3 to v4"},
        {"solution": "Use automated upgrade tool to handle all flex renaming in one pass", "percentage": 95, "command": "npx @tailwindcss/upgrade"},
        {"solution": "Manual regex replace: sed -i \"\" \"s/flex-grow-/grow-/g\" && sed -i \"\" \"s/flex-shrink-/shrink-/g\"", "percentage": 85, "command": "find . -type f -name \"*.html\" -exec sed -i \"\" \"s/flex-grow-/grow-/g\" {} +"}
    ]'::jsonb,
    'Tailwind CSS v3 project with flexbox layouts',
    'CSS builds successfully, Flex items grow/shrink as expected in layouts',
    'The upgrade tool handles these renames automatically. Manual replacement should test growth ratios (grow-0, grow, grow-[custom]).',
    0.93,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Important modifier syntax change - move ! from start to end',
    'frontend-framework',
    'HIGH',
    '[
        {"solution": "Move important modifier to end of class: !flex !bg-red-500 becomes flex! bg-red-500!", "percentage": 95, "note": "CSS-like syntax - matches CSS !important placement"},
        {"solution": "Use find/replace to update all important modifiers: \"!\" followed by classname", "percentage": 90, "command": "sed -i \"\" \"s/![a-z-]*/&!/g\" (needs refinement)"},
        {"solution": "Automated tool handles important modifier repositioning when using npx @tailwindcss/upgrade", "percentage": 95, "command": "npx @tailwindcss/upgrade"}
    ]'::jsonb,
    'Tailwind CSS v3 project using important modifiers (!)',
    'Build completes, Important overrides still work correctly, CSS specificity respected',
    'Important modifiers at start of class will cause build errors in v4. Automated tool is most reliable. Manual editing error-prone.',
    0.90,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: CSS variable syntax in arbitrary values - use parentheses',
    'frontend-framework',
    'MEDIUM',
    '[
        {"solution": "Change bg-[--brand-color] to bg-(--brand-color) for CSS variable shorthand in v4", "percentage": 95, "note": "New syntax required for CSS variables in arbitrary values"},
        {"solution": "For custom colors with slash: bg-[--color]/50 becomes bg-(--color)/50", "percentage": 90, "command": "Replace [--variable] with (--variable) in arbitrary value expressions"},
        {"solution": "Backwards compatible: You can still use full syntax bg-[color:--brand-color]", "percentage": 85, "note": "Parentheses are shorthand, full syntax still works"}
    ]'::jsonb,
    'Tailwind CSS v3 project with CSS variables in arbitrary values, CSS variables defined in stylesheets',
    'Build succeeds with variable references, CSS variables correctly injected into styling',
    'Parentheses syntax is new to v4 - old bracket syntax will not recognize variables. Test with actual CSS variable values defined.',
    0.89,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Grid/object position arbitrary values - replace commas with underscores',
    'frontend-framework',
    'MEDIUM',
    '[
        {"solution": "Replace commas in grid columns: grid-cols-[max-content,auto] becomes grid-cols-[max-content_auto]", "percentage": 95, "note": "Commas conflicted with CSS value lists in v4 parser"},
        {"solution": "Apply to all arbitrary multi-value utilities: object-position-[right,center] to object-position-[right_center]", "percentage": 92, "command": "Find and replace comma with underscore in square bracket arbitrary values"},
        {"solution": "Use automated upgrade tool which handles this transformation", "percentage": 95, "command": "npx @tailwindcss/upgrade"}
    ]'::jsonb,
    'Tailwind CSS v3 project with grid or object positioning arbitrary values',
    'CSS parses correctly without syntax errors, Grid layouts render correctly, Object positions display as expected',
    'Only affects arbitrary values with multiple parts (inside square brackets). Standard utilities unaffected. Automated tool is safest approach.',
    0.91,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Custom utilities - replace @layer utilities with @utility directive',
    'frontend-framework',
    'MEDIUM',
    '[
        {"solution": "Replace @layer utilities { .tab-4 { tab-size: 4; } } with @utility tab-4 { tab-size: 4; }", "percentage": 95, "note": "New @utility directive syntax for v4 CSS-first config"},
        {"solution": "For multiple custom utilities, define each with separate @utility directive", "percentage": 90, "command": "@utility responsive-padding { @responsive { padding: 1rem; } }"},
        {"solution": "Component layer replaced with @component: @component card { @apply p-4 rounded-lg shadow; }", "percentage": 90, "note": "Similar pattern for @layer components"},
        {"solution": "Use @layer directive still available for complex multi-selector rules not fitting @utility", "percentage": 75, "note": "Fallback for edge cases"}
    ]'::jsonb,
    'Tailwind CSS v3 project with custom CSS layer definitions in CSS file',
    'Custom utilities compile and apply correctly, Classes render with expected styles, No CSS syntax errors',
    'New @utility directive requires explicit utility name. Old @layer syntax deprecated. Check if plugin utilities need updates.',
    0.87,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Variant stacking and order - left-to-right CSS-like syntax',
    'frontend-framework',
    'MEDIUM',
    '[
        {"solution": "Change variant order: first:*:pt-0 last:*:pb-0 becomes *:first:pt-0 *:last:pb-0 (selector then variant)", "percentage": 95, "note": "v4 uses left-to-right CSS-like application order"},
        {"solution": "For child selectors: py-4 first:*:pt-0 becomes py-4 *:first:pt-0 (asterisk moves before variant)", "percentage": 92, "command": "Apply selector variants leftmost, then pseudo-class variants"},
        {"solution": "Test responsive variants: md:hover:bg-blue-500 order remains left-to-right naturally", "percentage": 85, "note": "Responsive modifiers work same way"}
    ]'::jsonb,
    'Tailwind CSS v3 project with complex variant combinations and child selectors',
    'Variants apply styles correctly, Child element styling matches expected behavior, Build completes without warnings',
    'Variant order matters for specificity. Test complex combinations. Some v3 stacking patterns may not be supported.',
    0.85,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Configuration changes - JS config files and removed options',
    'frontend-framework',
    'HIGH',
    '[
        {"solution": "Add explicit config import at top of CSS: @config \"../../tailwind.config.js\" to load JS config in v4", "percentage": 95, "note": "v4 requires explicit config reference in CSS entry point"},
        {"solution": "Note that corePlugins, safelist, and separator options are unsupported in v4 - use CSS variables and @apply instead", "percentage": 85, "note": "Plan migration strategy for these options"},
        {"solution": "For PostCSS setup, ensure postcss.config.mjs loads Tailwind: export default { plugins: { \"@tailwindcss/postcss\": {} } };", "percentage": 90, "command": "Update postcss.config.mjs with new plugin reference"},
        {"solution": "Migrate theme() function calls to CSS variables - use getComputedStyle(el).getPropertyValue(\"--color-primary\") in JS", "percentage": 75, "note": "resolveConfig() removed - use CSS variables instead"}
    ]'::jsonb,
    'Tailwind CSS v3 project with tailwind.config.js, PostCSS configuration',
    'CSS compiles successfully with JS config loaded, Theme values accessible, No build warnings about missing options',
    'The @config directive must reference the correct path. If config uses unsupported options, must refactor. Test PostCSS plugin loading.',
    0.88,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
),
(
    'Tailwind 3→4: Preflight (base styles) updates - placeholder, buttons, dialog, hidden attribute',
    'frontend-framework',
    'MEDIUM',
    '[
        {"solution": "Placeholder text now uses 50% opacity of current color instead of gray-400 - add explicit placeholder styles if needed", "percentage": 90, "note": "Change improves color consistency with theme"},
        {"solution": "Buttons use cursor: default instead of pointer - add cursor-pointer class to interactive buttons if users expect pointer", "percentage": 85, "command": "<button class=\"cursor-pointer\"> for interactive buttons"},
        {"solution": "Dialog element no longer has margin reset - add mx-auto or explicit margin if dialog positioning changed", "percentage": 80, "command": "<dialog class=\"mx-auto\">"},
        {"solution": "hidden attribute now takes priority over display: block classes - avoid conflicting display utilities on hidden elements", "percentage": 85, "note": "Test visibility of conditionally shown/hidden elements"}
    ]'::jsonb,
    'Tailwind CSS v3 project with form placeholders, buttons, dialogs, hidden elements',
    'Visual inspection: Placeholders render correctly, Button cursors appropriate for interaction, Dialogs positioned correctly, Hidden elements remain hidden',
    'These base style changes affect all pages. Comprehensive testing required. Check all interactive elements and dialogs.',
    0.83,
    'sonnet-4',
    NOW(),
    'https://tailwindcss.com/docs/upgrade-guide'
);
