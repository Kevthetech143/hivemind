-- Add 12 highest-voted Jest Stack Overflow questions with accepted answers

INSERT INTO knowledge_entries (query, category, hit_frequency, solutions, prerequisites, success_indicators, common_pitfalls, success_rate, claude_version, last_verified, source_url, thumbs_up)
VALUES
(
  'How do I run a single test using Jest?',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "Use the --testNamePattern flag (or -t shorthand) with jest or npm test: jest -t ''test name pattern'' or npm test -- -t ''test name pattern''", "percentage": 95, "command": "jest -t ''works with nested children''", "note": "Accepts regex patterns, special characters may need escaping"},
    {"solution": "Add .only to the test in code: it.only(''test name'', () => {}) to isolate a single test", "percentage": 90, "command": "it.only(''works with nested children'', () => { expect(true).toBe(true); })", "note": "Only prevents other tests in same file from running, tests in other files still execute"},
    {"solution": "In watch mode (jest --watch), press P to filter by filename or T to filter by test name", "percentage": 85, "note": "Interactive filtering in watch mode"}
  ]'::jsonb,
  'Jest installed and configured, test file present',
  'Single test executes and passes without running other tests',
  'The -t flag accepts regex which may require escaping special characters. Using .only only isolates within that file, not across all files. For large projects, specify file path alongside -t for better performance.',
  0.95,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/42827054/how-do-i-run-a-single-test-using-jest',
  924
),
(
  'How do I test a single file using Jest?',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "Use npm test with -- separator: npm test -- bar.spec.js", "percentage": 95, "command": "npm test -- bar.spec.js", "note": "The -- signals npm to pass everything after it to Jest rather than interpreting as npm arguments"},
    {"solution": "Use npx jest with filename: npx jest bar.spec.js (requires npm >= 5.2.0)", "percentage": 90, "command": "npx jest bar.spec.js", "note": "Works without global Jest installation"},
    {"solution": "Use --testPathPattern with path regex: npx jest --testPathPattern=\"path/to/file\"", "percentage": 85, "command": "npx jest --testPathPattern=\"src/lib/myfile\"", "note": "Useful for complex path patterns"}
  ]'::jsonb,
  'Jest installed, npm or npx available, test file exists at specified path',
  'Tests from single file execute without running tests from other files',
  'Jest treats filename as regex pattern so bar.spec.js might also match foobar.spec.js. On Windows use double backslashes in paths: npm test -- src\\tests\\file.test.js',
  0.95,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/28725955/how-do-i-test-a-single-file-using-jest',
  908
),
(
  'What is the difference between it and test in Jest?',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "There is NO functional difference - test() is simply an alias for it(). Choose based on readability preference: test() follows xUnit style, it() follows RSpec style", "percentage": 100, "note": "Official Jest documentation confirms they perform identically. Test names read naturally with it: ''it should do X'' vs test: ''test that thing should do X''"}
  ]'::jsonb,
  'Jest installed, basic understanding of test syntax',
  'Tests execute identically regardless of whether using it() or test()',
  'Developers often waste time debating which to use when they are functionally identical. Choose one convention for consistency and stick with it across the project. Both work the same way in Jest.',
  1.0,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/45778192/what-is-the-difference-between-it-and-test-in-jest',
  751
),
(
  'How to test the type of a thrown exception in Jest',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "Wrap code in function passed to expect(): expect(() => { code that throws }).toThrow(TypeError)", "percentage": 95, "command": "expect(() => { throw new TypeError(''UNKNOWN ERROR''); }).toThrow(TypeError)", "note": "Function call must be wrapped in anonymous function, calling directly would execute immediately"},
    {"solution": "Use try-catch with expect.assertions() for access to error object: expect.assertions(2); try { func(); } catch (error) { expect(error).toBeInstanceOf(TypeError); }", "percentage": 90, "note": "Allows checking both type and message together"},
    {"solution": "For async functions, use .rejects.toThrow(): await expect(asyncFn()).rejects.toThrow(HttpException)", "percentage": 85, "command": "await expect(asyncFn()).rejects.toThrow(CustomError)", "note": "Async functions return rejected promises, not synchronous errors"}
  ]'::jsonb,
  'Jest installed, function that throws Error object (not string)',
  'Test passes when exception type matches expected type, fails otherwise',
  'Function call must be wrapped in anonymous function or .rejects for async. Throwing a string like throw ''error message'' will not work with toThrow(). Must throw Error objects.',
  0.95,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/46042613/how-to-test-the-type-of-a-thrown-exception-in-jest',
  592
),
(
  'Jest async callback timeout error: Timeout - Async callback was not invoked',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "Set testTimeout in jest.config.js: module.exports = { testTimeout: 30000 }", "percentage": 95, "command": "Add to jest.config.js: testTimeout: 30000", "note": "Global timeout configuration for all tests, valid for Jest 24.9+"},
    {"solution": "Call jest.setTimeout() directly in test: jest.setTimeout(30000); before async operations", "percentage": 90, "command": "jest.setTimeout(30000); await page.waitForSelector(selector);", "note": "Per-test timeout configuration"},
    {"solution": "Remember Jest has its own timeout mechanism separate from test function parameters", "percentage": 85, "note": "Must explicitly configure Jest timeout, parameter in test function signature does not work"}
  ]'::jsonb,
  'Jest installed, Puppeteer or other async operation that may exceed 5000ms default',
  'Async operations complete without timeout error, tests pass',
  'Jest has its own internal timeout mechanism separate from any timeout parameters in test functions. Default is 5000ms. Configuration alone insufficient - must explicitly set testTimeout in config file. Parameter in test signature does not affect Jest timeout.',
  0.95,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/49603939/message-async-callback-was-not-invoked-within-the-5000-ms-timeout-specified-by',
  506
),
(
  'How can I mock an ES6 module import using Jest?',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "Use jest.mock() with module factory function at top level: jest.mock(''../dependency'', () => ({ doSomething: jest.fn() }))", "percentage": 95, "command": "jest.mock(''../dependency'', () => ({ doSomething: jest.fn() }))", "note": "Must be called at module top level, not inside test function"},
    {"solution": "For default exports, include __esModule flag: jest.mock(''./esModule'', () => ({ __esModule: true, default: jest.fn() }))", "percentage": 90, "command": "jest.mock(''./esModule'', () => ({ __esModule: true, default: jest.fn(), namedExport: jest.fn() }))", "note": "Required for proper default export mocking"},
    {"solution": "After mocking, test that mock was called: expect(dependency.doSomething).toBeCalledWith(expectedValue)", "percentage": 85, "note": "Verify mock interactions in test assertions"}
  ]'::jsonb,
  'Jest installed, ES6 modules being used, module to mock is accessible',
  'Mock function records calls, expect() assertions on mock verify behavior',
  'jest.mock() must be called at top level of module before imports - placement inside test functions will not work. Jest internally reorders mock declarations before imports. Cannot be called conditionally within tests.',
  0.95,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/40465047/how-can-i-mock-an-es6-module-import-using-jest',
  503
),
(
  'Can you write async tests that expect toThrow in Jest?',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "Use .rejects matcher for async functions: await expect(failingAsyncTest()).rejects.toThrow(''error message'')", "percentage": 95, "command": "await expect(failingAsyncTest()).rejects.toThrow(''I should fail'')", "note": "Async functions throw via rejected promises, not synchronous errors"},
    {"solution": "For wrapped async functions use: await expect(async () => { await someAsyncFunction() }).rejects.toThrow()", "percentage": 90, "command": "await expect(async () => { await asyncFn() }).rejects.toThrow(CustomError)", "note": "When you need to control async function invocation"},
    {"solution": "For custom errors use .rejects.toBeInstanceOf(CustomError)", "percentage": 85, "command": "await expect(asyncFunction()).rejects.toBeInstanceOf(CustomError)", "note": "Checks error type for custom error classes"}
  ]'::jsonb,
  'Jest installed, async function that throws Error object',
  'Test passes when async function rejects with expected error type',
  'Function must throw Error objects, not strings. Async functions do not throw synchronous errors - they return rejected promises. Must use .rejects matcher, not .toThrow() alone. Without proper error type, .toThrow() fails to match.',
  0.95,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/47144187/can-you-write-async-tests-that-expect-tothrow',
  491
),
(
  'How do you test for element non-existence using Jest and react-testing-library?',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "Use queryBy* methods instead of getBy*: screen.queryByText(''submit'') returns null if not found, then expect(element).toBeNull()", "percentage": 95, "command": "const submitButton = screen.queryByText(''submit''); expect(submitButton).toBeNull()", "note": "queryBy* returns null instead of throwing when element not found"},
    {"solution": "Use queryBy* with not.toBeInTheDocument(): expect(screen.queryByText(''submit'')).not.toBeInTheDocument()", "percentage": 90, "command": "expect(screen.queryByText(''submit'')).not.toBeInTheDocument()", "note": "Requires @testing-library/jest-dom import for toBeInTheDocument matcher"},
    {"solution": "Use queryAllBy* for multiple elements: expect(screen.queryAllByText(''submit'')).toHaveLength(0)", "percentage": 85, "command": "const buttons = screen.queryAllByText(''submit''); expect(buttons).toHaveLength(0)", "note": "queryAllBy* returns empty array when no matches exist"}
  ]'::jsonb,
  'Jest installed, react-testing-library installed and imported, component mounted',
  'Assertions pass without throwing errors, element non-existence is verified',
  'Must use queryBy* not getBy* because getBy* throws error when element missing. getByText, getByTestId etc. will fail test before expect() executes. queryBy* returns null for single elements, queryAllBy* returns empty array for multiple elements.',
  0.95,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/52783144/how-do-you-test-for-the-non-existence-of-an-element-using-jest-and-react-testing',
  488
),
(
  'Jest error: Cannot use import statement outside a module',
  'stackoverflow-jest',
  'HIGH',
  '[
    {"solution": "Create babel.config.js with @babel/preset-env: module.exports = {presets: [''@babel/preset-env'']} then update jest.config.js with transform property", "percentage": 95, "command": "Create babel.config.js (not .babelrc). Update jest.config.js transform: { ''^.+\\\\.(ts|tsx)?$'': ''ts-jest'', ''^.+\\\\.(js|jsx)$'': ''babel-jest'' }", "note": "Jest does not pick up .babelrc, must use babel.config.js"},
    {"solution": "Migrate .babelrc to babel.config.js by converting JSON to module.exports", "percentage": 90, "command": "Convert .babelrc to babel.config.js format", "note": "Many users fixed issue by using babel.config.js instead of .babelrc"},
    {"solution": "Use Node experimental modules flag: NODE_OPTIONS=''--experimental-vm-modules'' jest", "percentage": 75, "command": "Add to package.json: \"test\": \"NODE_OPTIONS=''--experimental-vm-modules'' jest\"", "note": "Avoids babel-jest dependency but less stable than babel configuration"}
  ]'::jsonb,
  'Jest installed, @babel/preset-env installed, Node.js available',
  'Tests run without SyntaxError, import statements transpile correctly',
  'Jest does not automatically pick up .babelrc file - must use babel.config.js. Babel configuration required for ES6 import transpilation. Check file extensions match (.ts not .js for TypeScript). Experimental modules flag less reliable than proper Babel configuration.',
  0.90,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/58613492/how-to-resolve-cannot-use-import-statement-outside-a-module-from-jest-when-run',
  434
),
(
  'How do I set a mock date in Jest?',
  'stackoverflow-jest',
  'MEDIUM',
  '[
    {"solution": "Use Jest fake timers: jest.useFakeTimers().setSystemTime(new Date(''2020-01-01''))", "percentage": 95, "command": "jest.useFakeTimers().setSystemTime(new Date(''2020-01-01''))", "note": "Modern Jest (26+) approach, requires no external dependencies"},
    {"solution": "For Jest 27+, use: jest.useFakeTimers(); jest.setSystemTime(new Date(''2020-01-01''))", "percentage": 95, "command": "jest.useFakeTimers(); jest.setSystemTime(new Date(''2020-01-01''))", "note": "Modern timers are default in Jest 27+"},
    {"solution": "Alternative: Mock Date.now() directly: Date.now = jest.fn(() => new Date(Date.UTC(2017, 0, 1)).valueOf())", "percentage": 80, "note": "Works for Date.now() but not all date usage patterns"},
    {"solution": "Use external libraries: MockDate, timekeeper, or jest-date-mock for additional features", "percentage": 70, "note": "Adds dependency, useful if fake timers insufficient"}
  ]'::jsonb,
  'Jest installed, date-dependent code to test',
  'Mock date is set correctly, date-dependent tests pass consistently',
  'Modern Jest fake timers is preferred approach. External library solutions like MockDate or timekeeper add dependencies but may be needed for complex scenarios. Date.now() mocking alone insufficient for all date usage patterns.',
  0.90,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/29719631/how-do-i-set-a-mock-date-in-jest',
  385
),
(
  'Console.log statements output nothing at all in Jest',
  'stackoverflow-jest',
  'MEDIUM',
  '[
    {"solution": "Jest suppresses console.log by default, run with --silent=false flag: npm run test -- --silent=false", "percentage": 95, "command": "npm run test -- --silent=false", "note": "Disables silent mode to show console output"},
    {"solution": "Remove --silent or --verbose flags from package.json Jest configuration", "percentage": 90, "note": "Check package.json scripts for conflicting Jest flags"},
    {"solution": "Use alternative console methods: console.debug(), console.info(), or import { log } from ''console'' and use log()", "percentage": 75, "command": "import { log } from ''console''; log(''message'')", "note": "Workaround if console.log specifically suppressed"},
    {"solution": "In IDE (WebStorm/JetBrains), click on filename rather than test name when running tests", "percentage": 70, "note": "IDE-specific configuration issue"}
  ]'::jsonb,
  'Jest installed and configured, console output expected',
  'Console.log output appears in test results',
  'Jest suppresses console by default. Root cause varies by setup, multiple solutions may need testing. Unawaited promises may prevent logging output. Check both Jest config and IDE test runner settings.',
  0.85,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/48695717/console-log-statements-output-nothing-at-all-in-jest',
  381
),
(
  'How to use ESLint with Jest?',
  'stackoverflow-jest',
  'MEDIUM',
  '[
    {"solution": "Install eslint-plugin-jest and add to .eslintrc: \"env\": { \"jest/globals\": true }", "percentage": 95, "command": "npm install eslint-plugin-jest && add to .eslintrc: \"env\": { \"jest/globals\": true }", "note": "Automatically registers Jest globals like jest, describe, it"},
    {"solution": "Use ESLint overrides feature (4.0+) to scope Jest globals only to test files: overrides: [{ files: [''**/*.test.js''], env: { \"jest/globals\": true } }]", "percentage": 90, "command": "Add to .eslintrc: \"overrides\": [{ \"files\": [\"**/*.test.js\"], \"env\": { \"jest/globals\": true }, \"extends\": [\"plugin:jest/recommended\"] }]", "note": "Prevents Jest references in production code"},
    {"solution": "Add eslint-plugin-jest recommended configuration: extends: [''plugin:jest/recommended'']", "percentage": 85, "command": "Add to .eslintrc overrides: \"extends\": [\"plugin:jest/recommended\"]", "note": "Includes best practices for Jest testing"}
  ]'::jsonb,
  'ESLint installed and configured, eslint-plugin-jest available',
  'ESLint no longer reports undefined jest, describe, it errors, configuration scoped to test files',
  'eslint-plugin-jest must be installed as dependency. Without overrides feature, Jest globals exposed to entire codebase. Overrides feature (ESLint 4+) allows scoping Jest settings only to test files. Configuration must match test file patterns.',
  0.95,
  'sonnet-4',
  NOW(),
  'https://stackoverflow.com/questions/31629389/how-to-use-eslint-with-jest',
  379
);
